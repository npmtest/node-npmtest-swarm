<div class="coverageReportDiv">
<h1>coverage-report</h1>
<div style="background: #fff; border: 1px solid #000; margin 0; padding: 0;">


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for All files</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">All files</span></h1>
    <h2>
        
        Statements: <span class="metric">19.73% <small>(557 / 2823)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">10.76% <small>(171 / 1589)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">8.86% <small>(35 / 395)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">20.29% <small>(556 / 2740)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric">26 statements, 1 function, 30 branches</span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"></div>
</div>
<div class="body">
<div class="coverage-summary">
<table>
<thead>
<tr>
   <th data-col="file" data-fmt="html" data-html="true" class="file">File</th>
   <th data-col="pic" data-type="number" data-fmt="html" data-html="true" class="pic"></th>
   <th data-col="statements" data-type="number" data-fmt="pct" class="pct">Statements</th>
   <th data-col="statements_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="branches" data-type="number" data-fmt="pct" class="pct">Branches</th>
   <th data-col="branches_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="functions" data-type="number" data-fmt="pct" class="pct">Functions</th>
   <th data-col="functions_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="lines" data-type="number" data-fmt="pct" class="pct">Lines</th>
   <th data-col="lines_raw" data-type="number" data-fmt="html" class="abs"></th>
</tr>
</thead>
<tbody><tr>
	<td class="file high" data-value="node-npmtest-swarm/"><a href="node-npmtest-swarm/index.html">node-npmtest-swarm/</a></td>
	<td data-value="100" class="pic high"><span class="cover-fill cover-full" style="width: 100px;"></span><span class="cover-empty" style="width:0px;"></span></td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="151" class="abs high">(151&nbsp;/&nbsp;151)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="124" class="abs high">(124&nbsp;/&nbsp;124)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="27" class="abs high">(27&nbsp;/&nbsp;27)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="151" class="abs high">(151&nbsp;/&nbsp;151)</td>
	</tr>

<tr>
	<td class="file low" data-value="node-npmtest-swarm/node_modules/swarm/lib/"><a href="node-npmtest-swarm/node_modules/swarm/lib/index.html">node-npmtest-swarm/node_modules/swarm/lib/</a></td>
	<td data-value="15.19" class="pic low"><span class="cover-fill" style="width: 15px;"></span><span class="cover-empty" style="width:85px;"></span></td>
	<td data-value="15.19" class="pct low">15.19%</td>
	<td data-value="2672" class="abs low">(406&nbsp;/&nbsp;2672)</td>
	<td data-value="3.21" class="pct low">3.21%</td>
	<td data-value="1465" class="abs low">(47&nbsp;/&nbsp;1465)</td>
	<td data-value="2.17" class="pct low">2.17%</td>
	<td data-value="368" class="abs low">(8&nbsp;/&nbsp;368)</td>
	<td data-value="15.64" class="pct low">15.64%</td>
	<td data-value="2589" class="abs low">(405&nbsp;/&nbsp;2589)</td>
	</tr>

</tbody>
</table>
</div></div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header high">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/</span></h1>
    <h2>
        
        Statements: <span class="metric">100% <small>(151 / 151)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">100% <small>(124 / 124)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">100% <small>(27 / 27)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">100% <small>(151 / 151)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric">26 statements, 1 function, 30 branches</span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../index.html">All files</a> &#187; node-npmtest-swarm/</div>
</div>
<div class="body">
<div class="coverage-summary">
<table>
<thead>
<tr>
   <th data-col="file" data-fmt="html" data-html="true" class="file">File</th>
   <th data-col="pic" data-type="number" data-fmt="html" data-html="true" class="pic"></th>
   <th data-col="statements" data-type="number" data-fmt="pct" class="pct">Statements</th>
   <th data-col="statements_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="branches" data-type="number" data-fmt="pct" class="pct">Branches</th>
   <th data-col="branches_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="functions" data-type="number" data-fmt="pct" class="pct">Functions</th>
   <th data-col="functions_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="lines" data-type="number" data-fmt="pct" class="pct">Lines</th>
   <th data-col="lines_raw" data-type="number" data-fmt="html" class="abs"></th>
</tr>
</thead>
<tbody><tr>
	<td class="file high" data-value="example.js"><a href="example.js.html">example.js</a></td>
	<td data-value="100" class="pic high"><span class="cover-fill cover-full" style="width: 100px;"></span><span class="cover-empty" style="width:0px;"></span></td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="83" class="abs high">(83&nbsp;/&nbsp;83)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="73" class="abs high">(73&nbsp;/&nbsp;73)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="12" class="abs high">(12&nbsp;/&nbsp;12)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="83" class="abs high">(83&nbsp;/&nbsp;83)</td>
	</tr>

<tr>
	<td class="file high" data-value="lib.npmtest_swarm.js"><a href="lib.npmtest_swarm.js.html">lib.npmtest_swarm.js</a></td>
	<td data-value="100" class="pic high"><span class="cover-fill cover-full" style="width: 100px;"></span><span class="cover-empty" style="width:0px;"></span></td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="16" class="abs high">(16&nbsp;/&nbsp;16)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="14" class="abs high">(14&nbsp;/&nbsp;14)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="3" class="abs high">(3&nbsp;/&nbsp;3)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="16" class="abs high">(16&nbsp;/&nbsp;16)</td>
	</tr>

<tr>
	<td class="file high" data-value="test.js"><a href="test.js.html">test.js</a></td>
	<td data-value="100" class="pic high"><span class="cover-fill cover-full" style="width: 100px;"></span><span class="cover-empty" style="width:0px;"></span></td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="52" class="abs high">(52&nbsp;/&nbsp;52)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="37" class="abs high">(37&nbsp;/&nbsp;37)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="12" class="abs high">(12&nbsp;/&nbsp;12)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="52" class="abs high">(52&nbsp;/&nbsp;52)</td>
	</tr>

</tbody>
</table>
</div></div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/example.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header high">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/example.js</span></h1>
    <h2>
        
        Statements: <span class="metric">100% <small>(83 / 83)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">100% <small>(73 / 73)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">100% <small>(12 / 12)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">100% <small>(83 / 83)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric">26 statements, 1 function, 30 branches</span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/</a> &#187; example.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/*
example.js
&nbsp;
quickstart example
&nbsp;
instruction
    1. save this script as example.js
    2. run the shell command:
        $ npm install npmtest-swarm &amp;&amp; PORT=8081 node example.js
    3. play with the browser-demo on http://127.0.0.1:8081
*/
&nbsp;
&nbsp;
&nbsp;
/* istanbul instrument in package npmtest_swarm */
/*jslint
    bitwise: true,
    browser: true,
    maxerr: 8,
    maxlen: 96,
    node: true,
    nomen: true,
    regexp: true,
    stupid: true
*/
(function () {
    'use strict';
    var local;
&nbsp;
&nbsp;
&nbsp;
    // run shared js-env code - pre-init
    (function () {
        // init local
        local = {};
        // init modeJs
        local.modeJs = (function () {
            try {
                return typeof navigator.userAgent === 'string' &amp;&amp;
                    typeof document.querySelector('body') === 'object' &amp;&amp;
                    typeof XMLHttpRequest.prototype.open === 'function' &amp;&amp;
                    'browser';
            } catch (errorCaughtBrowser) {
                return module.exports &amp;&amp;
                    typeof process.versions.node === 'string' &amp;&amp;
                    typeof require('http').createServer === 'function' &amp;&amp;
                    'node';
            }
        }());
        // init global
        local.global = local.modeJs === 'browser'
            ? window
            : global;
        // init utility2_rollup
        local = local.global.utility2_rollup || (local.modeJs === 'browser'
            ? local.global.utility2_npmtest_swarm
            : global.utility2_moduleExports);
        // export local
        local.global.local = local;
    }());
    switch (local.modeJs) {
&nbsp;
&nbsp;
&nbsp;
    // post-init
    // run browser js-env code - post-init
    /* istanbul ignore next */
    case 'browser':
        local.testRunBrowser = function (event) {
            <span class="skip-if-branch" title="else path not taken" >E</span>if (!event || (event &amp;&amp;
                    event.currentTarget &amp;&amp;
                    event.currentTarget.className &amp;&amp;
                    event.currentTarget.className.includes &amp;&amp;
                    event.currentTarget.className.includes('onreset'))) {
                // reset output
                Array.from(
                    document.querySelectorAll('body &gt; .resettable')
                ).forEach(function (element) {
                    switch (element.tagName) {
<span class="branch-0 cbranch-skip" title="branch not covered" >                    case 'INPUT':</span>
                    case 'TEXTAREA':
                        element.value = '';
                        break;
<span class="branch-2 cbranch-skip" title="branch not covered" >                    default:</span>
<span class="cstat-skip" title="statement not covered" >                        element.textContent = '';</span>
                    }
                });
            }
            switch (event &amp;&amp; event.currentTarget &amp;&amp; event.currentTarget.id) {
            case 'testRunButton1':
                // show tests
                <span class="skip-if-branch" title="else path not taken" >E</span>if (document.querySelector('#testReportDiv1').style.display === 'none') {
                    document.querySelector('#testReportDiv1').style.display = 'block';
                    document.querySelector('#testRunButton1').textContent =
                        'hide internal test';
                    local.modeTest = true;
                    local.testRunDefault(local);
                // hide tests
                } else {
<span class="cstat-skip" title="statement not covered" >                    document.querySelector('#testReportDiv1').style.display = 'none';</span>
<span class="cstat-skip" title="statement not covered" >                    document.querySelector('#testRunButton1').textContent = 'run internal test';</span>
                }
                break;
            // custom-case
            default:
                break;
            }
            <span class="skip-if-branch" title="if path not taken" >I</span>if (document.querySelector('#inputTextareaEval1') &amp;&amp; (<span class="branch-1 cbranch-skip" title="branch not covered" >!event </span>|| (<span class="branch-2 cbranch-skip" title="branch not covered" >event </span>&amp;&amp;
<span class="branch-3 cbranch-skip" title="branch not covered" >                    event.currentTarget </span>&amp;&amp;
<span class="branch-4 cbranch-skip" title="branch not covered" >                    event.currentTarget.className </span>&amp;&amp;
<span class="branch-5 cbranch-skip" title="branch not covered" >                    event.currentTarget.className.includes </span>&amp;&amp;
<span class="branch-6 cbranch-skip" title="branch not covered" >                    event.currentTarget.className.includes('oneval'))</span>)) {
                // try to eval input-code
<span class="cstat-skip" title="statement not covered" >                try {</span>
                    /*jslint evil: true*/
<span class="cstat-skip" title="statement not covered" >                    eval(document.querySelector('#inputTextareaEval1').value);</span>
                } catch (errorCaught) {
<span class="cstat-skip" title="statement not covered" >                    console.error(errorCaught);</span>
                }
            }
        };
        // log stderr and stdout to #outputTextareaStdout1
        ['error', 'log'].forEach(function (key) {
            console[key + '_original'] = console[key];
            console[key] = function () {
                var element;
                console[key + '_original'].apply(console, arguments);
                element = document.querySelector('#outputTextareaStdout1');
                <span class="skip-if-branch" title="if path not taken" >I</span>if (!element) {
<span class="cstat-skip" title="statement not covered" >                    return;</span>
                }
                // append text to #outputTextareaStdout1
                element.value += Array.from(arguments).map(function (arg) {
                    return typeof arg === 'string'
                        ? arg
                        : <span class="branch-1 cbranch-skip" title="branch not covered" >JSON.stringify(arg, null, 4);</span>
                }).join(' ') + '\n';
                // scroll textarea to bottom
                element.scrollTop = element.scrollHeight;
            };
        });
        // init event-handling
        ['change', 'click', 'keyup'].forEach(function (event) {
            Array.from(document.querySelectorAll('.on' + event)).forEach(function (element) {
                element.addEventListener(event, local.testRunBrowser);
            });
        });
        // run tests
        local.testRunBrowser();
        break;
&nbsp;
&nbsp;
&nbsp;
    // run node js-env code - post-init
    /* istanbul ignore next */
    case 'node':
        // export local
        module.exports = local;
        // require modules
        local.fs = require('fs');
        local.http = require('http');
        local.url = require('url');
        // init assets
        local.assetsDict = local.assetsDict || {};
        /* jslint-ignore-begin */
        local.assetsDict['/assets.index.template.html'] = '\
&lt;!doctype html&gt;\n\
&lt;html lang="en"&gt;\n\
&lt;head&gt;\n\
&lt;meta charset="UTF-8"&gt;\n\
&lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;\n\
&lt;title&gt;{{env.npm_package_name}} (v{{env.npm_package_version}})&lt;/title&gt;\n\
&lt;style&gt;\n\
/*csslint\n\
    box-sizing: false,\n\
    universal-selector: false\n\
*/\n\
* {\n\
    box-sizing: border-box;\n\
}\n\
body {\n\
    background: #dde;\n\
    font-family: Arial, Helvetica, sans-serif;\n\
    margin: 2rem;\n\
}\n\
body &gt; * {\n\
    margin-bottom: 1rem;\n\
}\n\
.utility2FooterDiv {\n\
    margin-top: 20px;\n\
    text-align: center;\n\
}\n\
&lt;/style&gt;\n\
&lt;style&gt;\n\
/*csslint\n\
*/\n\
textarea {\n\
    font-family: monospace;\n\
    height: 10rem;\n\
    width: 100%;\n\
}\n\
textarea[readonly] {\n\
    background: #ddd;\n\
}\n\
&lt;/style&gt;\n\
&lt;/head&gt;\n\
&lt;body&gt;\n\
&lt;!-- utility2-comment\n\
&lt;div id="ajaxProgressDiv1" style="background: #d00; height: 2px; left: 0; margin: 0; padding: 0; position: fixed; top: 0; transition: background 0.5s, width 1.5s; width: 25%;"&gt;&lt;/div&gt;\n\
utility2-comment --&gt;\n\
&lt;h1&gt;\n\
&lt;!-- utility2-comment\n\
    &lt;a\n\
        {{#if env.npm_package_homepage}}\n\
        href="{{env.npm_package_homepage}}"\n\
        {{/if env.npm_package_homepage}}\n\
        target="_blank"\n\
    &gt;\n\
utility2-comment --&gt;\n\
        {{env.npm_package_name}} (v{{env.npm_package_version}})\n\
&lt;!-- utility2-comment\n\
    &lt;/a&gt;\n\
utility2-comment --&gt;\n\
&lt;/h1&gt;\n\
&lt;h3&gt;{{env.npm_package_description}}&lt;/h3&gt;\n\
&lt;!-- utility2-comment\n\
&lt;h4&gt;&lt;a download href="assets.app.js"&gt;download standalone app&lt;/a&gt;&lt;/h4&gt;\n\
&lt;button class="onclick onreset" id="testRunButton1"&gt;run internal test&lt;/button&gt;&lt;br&gt;\n\
&lt;div id="testReportDiv1" style="display: none;"&gt;&lt;/div&gt;\n\
utility2-comment --&gt;\n\
\n\
\n\
\n\
&lt;label&gt;stderr and stdout&lt;/label&gt;\n\
&lt;textarea class="resettable" id="outputTextareaStdout1" readonly&gt;&lt;/textarea&gt;\n\
&lt;!-- utility2-comment\n\
{{#if isRollup}}\n\
&lt;script src="assets.app.js"&gt;&lt;/script&gt;\n\
{{#unless isRollup}}\n\
utility2-comment --&gt;\n\
&lt;script src="assets.utility2.rollup.js"&gt;&lt;/script&gt;\n\
&lt;script src="jsonp.utility2._stateInit?callback=window.utility2._stateInit"&gt;&lt;/script&gt;\n\
&lt;script src="assets.npmtest_swarm.rollup.js"&gt;&lt;/script&gt;\n\
&lt;script src="assets.example.js"&gt;&lt;/script&gt;\n\
&lt;script src="assets.test.js"&gt;&lt;/script&gt;\n\
&lt;!-- utility2-comment\n\
{{/if isRollup}}\n\
utility2-comment --&gt;\n\
&lt;div class="utility2FooterDiv"&gt;\n\
    [ this app was created with\n\
    &lt;a href="https://github.com/kaizhu256/node-utility2" target="_blank"&gt;utility2&lt;/a&gt;\n\
    ]\n\
&lt;/div&gt;\n\
&lt;/body&gt;\n\
&lt;/html&gt;\n\
';
        /* jslint-ignore-end */
        <span class="skip-if-branch" title="if path not taken" >I</span>if (local.templateRender) {
<span class="cstat-skip" title="statement not covered" >            local.assetsDict['/'] = local.templateRender(</span>
                local.assetsDict['/assets.index.template.html'],
                {
                    env: local.objectSetDefault(local.env, {
                        npm_package_description: 'the greatest app in the world!',
                        npm_package_name: 'my-app',
                        npm_package_nameAlias: 'my_app',
                        npm_package_version: '0.0.1'
                    })
                }
            );
        } else {
            local.assetsDict['/'] = local.assetsDict['/assets.index.template.html']
                .replace((/\{\{env\.(\w+?)\}\}/g), function (match0, match1) {
                    // jslint-hack
                    String(match0);
                    switch (match1) {
                    case 'npm_package_description':
                        return 'the greatest app in the world!';
                    case 'npm_package_name':
                        return 'my-app';
<span class="branch-2 cbranch-skip" title="branch not covered" >                    case 'npm_package_nameAlias':</span>
<span class="cstat-skip" title="statement not covered" >                        return 'my_app';</span>
                    case 'npm_package_version':
                        return '0.0.1';
                    }
                });
        }
        // run the cli
        <span class="skip-if-branch" title="else path not taken" >E</span>if (local.global.utility2_rollup || module !== require.main) {
            break;
        }
<span class="cstat-skip" title="statement not covered" >        local.assetsDict['/assets.example.js'] =</span>
            local.assetsDict['/assets.example.js'] ||
            local.fs.readFileSync(__filename, 'utf8');
<span class="cstat-skip" title="statement not covered" >        local.assetsDict['/assets.npmtest_swarm.rollup.js'] =</span>
            local.assetsDict['/assets.npmtest_swarm.rollup.js'] ||
            local.fs.readFileSync(
                // buildCustomOrg-hack
                local.npmtest_swarm.__dirname +
                    '/lib.npmtest_swarm.js',
                'utf8'
            ).replace((/^#!/), '//');
<span class="cstat-skip" title="statement not covered" >        local.assetsDict['/favicon.ico'] = local.assetsDict['/favicon.ico'] || '';</span>
        // if $npm_config_timeout_exit exists,
        // then exit this process after $npm_config_timeout_exit ms
<span class="cstat-skip" title="statement not covered" >        if (Number(process.env.npm_config_timeout_exit)) {</span>
<span class="cstat-skip" title="statement not covered" >            setTimeout(process.exit, Number(process.env.npm_config_timeout_exit));</span>
        }
        // start server
<span class="cstat-skip" title="statement not covered" >        if (local.global.utility2_serverHttp1) {</span>
<span class="cstat-skip" title="statement not covered" >            break;</span>
        }
<span class="cstat-skip" title="statement not covered" >        process.env.PORT = process.env.PORT || '8081';</span>
<span class="cstat-skip" title="statement not covered" >        console.error('server starting on port ' + process.env.PORT);</span>
<span class="cstat-skip" title="statement not covered" >        local.http.createServer(<span class="fstat-skip" title="function not covered" >function (request, response) {</span></span>
<span class="cstat-skip" title="statement not covered" >            request.urlParsed = local.url.parse(request.url);</span>
<span class="cstat-skip" title="statement not covered" >            if (local.assetsDict[request.urlParsed.pathname] !== undefined) {</span>
<span class="cstat-skip" title="statement not covered" >                response.end(local.assetsDict[request.urlParsed.pathname]);</span>
<span class="cstat-skip" title="statement not covered" >                return;</span>
            }
<span class="cstat-skip" title="statement not covered" >            response.statusCode = 404;</span>
<span class="cstat-skip" title="statement not covered" >            response.end();</span>
        }).listen(process.env.PORT);
<span class="cstat-skip" title="statement not covered" >        break;</span>
    }
}());
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/lib.npmtest_swarm.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header high">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/lib.npmtest_swarm.js</span></h1>
    <h2>
        
        Statements: <span class="metric">100% <small>(16 / 16)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">100% <small>(14 / 14)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">100% <small>(3 / 3)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">100% <small>(16 / 16)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/</a> &#187; lib.npmtest_swarm.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/* istanbul instrument in package npmtest_swarm */
/*jslint
    bitwise: true,
    browser: true,
    maxerr: 8,
    maxlen: 96,
    node: true,
    nomen: true,
    regexp: true,
    stupid: true
*/
(function () {
    'use strict';
    var local;
&nbsp;
&nbsp;
&nbsp;
    // run shared js-env code - pre-init
    (function () {
        // init local
        local = {};
        // init modeJs
        local.modeJs = (function () {
            try {
                return typeof navigator.userAgent === 'string' &amp;&amp;
                    typeof document.querySelector('body') === 'object' &amp;&amp;
                    typeof XMLHttpRequest.prototype.open === 'function' &amp;&amp;
                    'browser';
            } catch (errorCaughtBrowser) {
                return module.exports &amp;&amp;
                    typeof process.versions.node === 'string' &amp;&amp;
                    typeof require('http').createServer === 'function' &amp;&amp;
                    'node';
            }
        }());
        // init global
        local.global = local.modeJs === 'browser'
            ? window
            : global;
        // init utility2_rollup
        local = local.global.utility2_rollup || local;
        // init lib
        local.local = local.npmtest_swarm = local;
        // init exports
        if (local.modeJs === 'browser') {
            local.global.utility2_npmtest_swarm = local;
        } else {
            module.exports = local;
            module.exports.__dirname = __dirname;
            module.exports.module = module;
        }
    }());
}());
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/test.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header high">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/test.js</span></h1>
    <h2>
        
        Statements: <span class="metric">100% <small>(52 / 52)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">100% <small>(37 / 37)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">100% <small>(12 / 12)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">100% <small>(52 / 52)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/</a> &#187; test.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/* istanbul instrument in package npmtest_swarm */
/*jslint
    bitwise: true,
    browser: true,
    maxerr: 8,
    maxlen: 96,
    node: true,
    nomen: true,
    regexp: true,
    stupid: true
*/
(function () {
    'use strict';
    var local;
&nbsp;
&nbsp;
&nbsp;
    // run shared js-env code - pre-init
    (function () {
        // init local
        local = {};
        // init modeJs
        local.modeJs = (function () {
            try {
                return typeof navigator.userAgent === 'string' &amp;&amp;
                    typeof document.querySelector('body') === 'object' &amp;&amp;
                    typeof XMLHttpRequest.prototype.open === 'function' &amp;&amp;
                    'browser';
            } catch (errorCaughtBrowser) {
                return module.exports &amp;&amp;
                    typeof process.versions.node === 'string' &amp;&amp;
                    typeof require('http').createServer === 'function' &amp;&amp;
                    'node';
            }
        }());
        // init global
        local.global = local.modeJs === 'browser'
            ? window
            : global;
        switch (local.modeJs) {
        // re-init local from window.local
        case 'browser':
            local = local.global.utility2.objectSetDefault(
                local.global.utility2_rollup || local.global.local,
                local.global.utility2
            );
            break;
        // re-init local from example.js
        case 'node':
            local = (local.global.utility2_rollup || require('utility2'))
                .requireExampleJsFromReadme();
            break;
        }
        // export local
        local.global.local = local;
    }());
&nbsp;
&nbsp;
&nbsp;
    // run shared js-env code - function
    (function () {
        return;
    }());
    switch (local.modeJs) {
&nbsp;
&nbsp;
&nbsp;
    // run browser js-env code - function
    case 'browser':
        break;
&nbsp;
&nbsp;
&nbsp;
    // run node js-env code - function
    case 'node':
        break;
    }
&nbsp;
&nbsp;
&nbsp;
    // run shared js-env code - post-init
    (function () {
        return;
    }());
    switch (local.modeJs) {
&nbsp;
&nbsp;
&nbsp;
    // run browser js-env code - post-init
    case 'browser':
        // run tests
        local.nop(local.modeTest &amp;&amp;
            document.querySelector('#testRunButton1') &amp;&amp;
            document.querySelector('#testRunButton1').click());
        break;
&nbsp;
&nbsp;
&nbsp;
    // run node js-env code - post-init
    /* istanbul ignore next */
    case 'node':
        local.testCase_buildApidoc_default = local.testCase_buildApidoc_default || function (
            options,
            onError
        ) {
        /*
         * this function will test buildApidoc's default handling-behavior-behavior
         */
            options = { modulePathList: module.paths };
            local.buildApidoc(options, onError);
        };
&nbsp;
        local.testCase_buildApp_default = local.testCase_buildApp_default || function (
            options,
            onError
        ) {
        /*
         * this function will test buildApp's default handling-behavior-behavior
         */
            local.testCase_buildReadme_default(options, local.onErrorThrow);
            local.testCase_buildLib_default(options, local.onErrorThrow);
            local.testCase_buildTest_default(options, local.onErrorThrow);
            local.testCase_buildCustomOrg_default(options, local.onErrorThrow);
            options = [];
            local.buildApp(options, onError);
        };
&nbsp;
        local.testCase_buildCustomOrg_default = local.testCase_buildCustomOrg_default ||
            function (options, onError) {
            /*
             * this function will test buildCustomOrg's default handling-behavior
             */
                options = {};
                local.buildCustomOrg(options, onError);
            };
&nbsp;
        local.testCase_buildLib_default = local.testCase_buildLib_default || function (
            options,
            onError
        ) {
        /*
         * this function will test buildLib's default handling-behavior
         */
            options = {};
            local.buildLib(options, onError);
        };
&nbsp;
        local.testCase_buildReadme_default = local.testCase_buildReadme_default || function (
            options,
            onError
        ) {
        /*
         * this function will test buildReadme's default handling-behavior-behavior
         */
            options = {};
            local.buildReadme(options, onError);
        };
&nbsp;
        local.testCase_buildTest_default = local.testCase_buildTest_default || function (
            options,
            onError
        ) {
        /*
         * this function will test buildTest's default handling-behavior
         */
            options = {};
            local.buildTest(options, onError);
        };
&nbsp;
        local.testCase_webpage_default = local.testCase_webpage_default || function (
            options,
            onError
        ) {
        /*
         * this function will test webpage's default handling-behavior
         */
            options = { modeCoverageMerge: true, url: local.serverLocalHost + '?modeTest=1' };
            local.browserTest(options, onError);
        };
&nbsp;
        // run test-server
        local.testRunServer(local);
        break;
    }
}());
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/</span></h1>
    <h2>
        
        Statements: <span class="metric">15.19% <small>(406 / 2672)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">3.21% <small>(47 / 1465)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">2.17% <small>(8 / 368)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">15.64% <small>(405 / 2589)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; node-npmtest-swarm/node_modules/swarm/lib/</div>
</div>
<div class="body">
<div class="coverage-summary">
<table>
<thead>
<tr>
   <th data-col="file" data-fmt="html" data-html="true" class="file">File</th>
   <th data-col="pic" data-type="number" data-fmt="html" data-html="true" class="pic"></th>
   <th data-col="statements" data-type="number" data-fmt="pct" class="pct">Statements</th>
   <th data-col="statements_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="branches" data-type="number" data-fmt="pct" class="pct">Branches</th>
   <th data-col="branches_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="functions" data-type="number" data-fmt="pct" class="pct">Functions</th>
   <th data-col="functions_raw" data-type="number" data-fmt="html" class="abs"></th>
   <th data-col="lines" data-type="number" data-fmt="pct" class="pct">Lines</th>
   <th data-col="lines_raw" data-type="number" data-fmt="html" class="abs"></th>
</tr>
</thead>
<tbody><tr>
	<td class="file low" data-value="AsyncLoopbackConnection.js"><a href="AsyncLoopbackConnection.js.html">AsyncLoopbackConnection.js</a></td>
	<td data-value="23.08" class="pic low"><span class="cover-fill" style="width: 23px;"></span><span class="cover-empty" style="width:77px;"></span></td>
	<td data-value="23.08" class="pct low">23.08%</td>
	<td data-value="39" class="abs low">(9&nbsp;/&nbsp;39)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="20" class="abs low">(0&nbsp;/&nbsp;20)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="7" class="abs low">(0&nbsp;/&nbsp;7)</td>
	<td data-value="23.08" class="pct low">23.08%</td>
	<td data-value="39" class="abs low">(9&nbsp;/&nbsp;39)</td>
	</tr>

<tr>
	<td class="file low" data-value="CollectionMethodsMixin.js"><a href="CollectionMethodsMixin.js.html">CollectionMethodsMixin.js</a></td>
	<td data-value="13.33" class="pic low"><span class="cover-fill" style="width: 13px;"></span><span class="cover-empty" style="width:87px;"></span></td>
	<td data-value="13.33" class="pct low">13.33%</td>
	<td data-value="15" class="abs low">(2&nbsp;/&nbsp;15)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="4" class="abs low">(0&nbsp;/&nbsp;4)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="5" class="abs low">(0&nbsp;/&nbsp;5)</td>
	<td data-value="13.33" class="pct low">13.33%</td>
	<td data-value="15" class="abs low">(2&nbsp;/&nbsp;15)</td>
	</tr>

<tr>
	<td class="file low" data-value="EinarosWSStream.js"><a href="EinarosWSStream.js.html">EinarosWSStream.js</a></td>
	<td data-value="21.21" class="pic low"><span class="cover-fill" style="width: 21px;"></span><span class="cover-empty" style="width:79px;"></span></td>
	<td data-value="21.21" class="pct low">21.21%</td>
	<td data-value="33" class="abs low">(7&nbsp;/&nbsp;33)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="16" class="abs low">(0&nbsp;/&nbsp;16)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="7" class="abs low">(0&nbsp;/&nbsp;7)</td>
	<td data-value="22.58" class="pct low">22.58%</td>
	<td data-value="31" class="abs low">(7&nbsp;/&nbsp;31)</td>
	</tr>

<tr>
	<td class="file low" data-value="FileStorage.js"><a href="FileStorage.js.html">FileStorage.js</a></td>
	<td data-value="15.89" class="pic low"><span class="cover-fill" style="width: 15px;"></span><span class="cover-empty" style="width:85px;"></span></td>
	<td data-value="15.89" class="pct low">15.89%</td>
	<td data-value="107" class="abs low">(17&nbsp;/&nbsp;107)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="42" class="abs low">(0&nbsp;/&nbsp;42)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="15" class="abs low">(0&nbsp;/&nbsp;15)</td>
	<td data-value="16.35" class="pct low">16.35%</td>
	<td data-value="104" class="abs low">(17&nbsp;/&nbsp;104)</td>
	</tr>

<tr>
	<td class="file low" data-value="Host.js"><a href="Host.js.html">Host.js</a></td>
	<td data-value="7.38" class="pic low"><span class="cover-fill" style="width: 7px;"></span><span class="cover-empty" style="width:93px;"></span></td>
	<td data-value="7.38" class="pct low">7.38%</td>
	<td data-value="149" class="abs low">(11&nbsp;/&nbsp;149)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="87" class="abs low">(0&nbsp;/&nbsp;87)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="22" class="abs low">(0&nbsp;/&nbsp;22)</td>
	<td data-value="7.43" class="pct low">7.43%</td>
	<td data-value="148" class="abs low">(11&nbsp;/&nbsp;148)</td>
	</tr>

<tr>
	<td class="file low" data-value="Html5Client.js"><a href="Html5Client.js.html">Html5Client.js</a></td>
	<td data-value="4" class="pic low"><span class="cover-fill" style="width: 4px;"></span><span class="cover-empty" style="width:96px;"></span></td>
	<td data-value="4" class="pct low">4%</td>
	<td data-value="25" class="abs low">(1&nbsp;/&nbsp;25)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="27" class="abs low">(0&nbsp;/&nbsp;27)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="2" class="abs low">(0&nbsp;/&nbsp;2)</td>
	<td data-value="4" class="pct low">4%</td>
	<td data-value="25" class="abs low">(1&nbsp;/&nbsp;25)</td>
	</tr>

<tr>
	<td class="file low" data-value="LamportClock.js"><a href="LamportClock.js.html">LamportClock.js</a></td>
	<td data-value="34.78" class="pic low"><span class="cover-fill" style="width: 34px;"></span><span class="cover-empty" style="width:66px;"></span></td>
	<td data-value="34.78" class="pct low">34.78%</td>
	<td data-value="23" class="abs low">(8&nbsp;/&nbsp;23)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="6" class="abs low">(0&nbsp;/&nbsp;6)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="6" class="abs low">(0&nbsp;/&nbsp;6)</td>
	<td data-value="36.36" class="pct low">36.36%</td>
	<td data-value="22" class="abs low">(8&nbsp;/&nbsp;22)</td>
	</tr>

<tr>
	<td class="file low" data-value="LevelStorage.js"><a href="LevelStorage.js.html">LevelStorage.js</a></td>
	<td data-value="15.22" class="pic low"><span class="cover-fill" style="width: 15px;"></span><span class="cover-empty" style="width:85px;"></span></td>
	<td data-value="15.22" class="pct low">15.22%</td>
	<td data-value="92" class="abs low">(14&nbsp;/&nbsp;92)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="52" class="abs low">(0&nbsp;/&nbsp;52)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="15" class="abs low">(0&nbsp;/&nbsp;15)</td>
	<td data-value="15.38" class="pct low">15.38%</td>
	<td data-value="91" class="abs low">(14&nbsp;/&nbsp;91)</td>
	</tr>

<tr>
	<td class="file low" data-value="LongSpec.js"><a href="LongSpec.js.html">LongSpec.js</a></td>
	<td data-value="10.26" class="pic low"><span class="cover-fill" style="width: 10px;"></span><span class="cover-empty" style="width:90px;"></span></td>
	<td data-value="10.26" class="pct low">10.26%</td>
	<td data-value="341" class="abs low">(35&nbsp;/&nbsp;341)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="163" class="abs low">(0&nbsp;/&nbsp;163)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="26" class="abs low">(0&nbsp;/&nbsp;26)</td>
	<td data-value="10.64" class="pct low">10.64%</td>
	<td data-value="329" class="abs low">(35&nbsp;/&nbsp;329)</td>
	</tr>

<tr>
	<td class="file low" data-value="MinutePreciseClock.js"><a href="MinutePreciseClock.js.html">MinutePreciseClock.js</a></td>
	<td data-value="18.03" class="pic low"><span class="cover-fill" style="width: 18px;"></span><span class="cover-empty" style="width:82px;"></span></td>
	<td data-value="18.03" class="pct low">18.03%</td>
	<td data-value="61" class="abs low">(11&nbsp;/&nbsp;61)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="24" class="abs low">(0&nbsp;/&nbsp;24)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="7" class="abs low">(0&nbsp;/&nbsp;7)</td>
	<td data-value="20.37" class="pct low">20.37%</td>
	<td data-value="54" class="abs low">(11&nbsp;/&nbsp;54)</td>
	</tr>

<tr>
	<td class="file low" data-value="Model.js"><a href="Model.js.html">Model.js</a></td>
	<td data-value="6.94" class="pic low"><span class="cover-fill" style="width: 6px;"></span><span class="cover-empty" style="width:94px;"></span></td>
	<td data-value="6.94" class="pct low">6.94%</td>
	<td data-value="72" class="abs low">(5&nbsp;/&nbsp;72)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="45" class="abs low">(0&nbsp;/&nbsp;45)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="13" class="abs low">(0&nbsp;/&nbsp;13)</td>
	<td data-value="6.94" class="pct low">6.94%</td>
	<td data-value="72" class="abs low">(5&nbsp;/&nbsp;72)</td>
	</tr>

<tr>
	<td class="file high" data-value="NodeServer.js"><a href="NodeServer.js.html">NodeServer.js</a></td>
	<td data-value="100" class="pic high"><span class="cover-fill cover-full" style="width: 100px;"></span><span class="cover-empty" style="width:0px;"></span></td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="17" class="abs high">(17&nbsp;/&nbsp;17)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="0" class="abs high">(0&nbsp;/&nbsp;0)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="0" class="abs high">(0&nbsp;/&nbsp;0)</td>
	<td data-value="100" class="pct high">100%</td>
	<td data-value="17" class="abs high">(17&nbsp;/&nbsp;17)</td>
	</tr>

<tr>
	<td class="file low" data-value="Pipe.js"><a href="Pipe.js.html">Pipe.js</a></td>
	<td data-value="11.49" class="pic low"><span class="cover-fill" style="width: 11px;"></span><span class="cover-empty" style="width:89px;"></span></td>
	<td data-value="11.49" class="pct low">11.49%</td>
	<td data-value="148" class="abs low">(17&nbsp;/&nbsp;148)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="86" class="abs low">(0&nbsp;/&nbsp;86)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="17" class="abs low">(0&nbsp;/&nbsp;17)</td>
	<td data-value="11.64" class="pct low">11.64%</td>
	<td data-value="146" class="abs low">(17&nbsp;/&nbsp;146)</td>
	</tr>

<tr>
	<td class="file low" data-value="PostMessageStream.js"><a href="PostMessageStream.js.html">PostMessageStream.js</a></td>
	<td data-value="8.51" class="pic low"><span class="cover-fill" style="width: 8px;"></span><span class="cover-empty" style="width:92px;"></span></td>
	<td data-value="8.51" class="pct low">8.51%</td>
	<td data-value="94" class="abs low">(8&nbsp;/&nbsp;94)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="53" class="abs low">(0&nbsp;/&nbsp;53)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="12" class="abs low">(0&nbsp;/&nbsp;12)</td>
	<td data-value="8.51" class="pct low">8.51%</td>
	<td data-value="94" class="abs low">(8&nbsp;/&nbsp;94)</td>
	</tr>

<tr>
	<td class="file low" data-value="ProxyListener.js"><a href="ProxyListener.js.html">ProxyListener.js</a></td>
	<td data-value="20.83" class="pic low"><span class="cover-fill" style="width: 20px;"></span><span class="cover-empty" style="width:80px;"></span></td>
	<td data-value="20.83" class="pct low">20.83%</td>
	<td data-value="24" class="abs low">(5&nbsp;/&nbsp;24)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="12" class="abs low">(0&nbsp;/&nbsp;12)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="4" class="abs low">(0&nbsp;/&nbsp;4)</td>
	<td data-value="23.81" class="pct low">23.81%</td>
	<td data-value="21" class="abs low">(5&nbsp;/&nbsp;21)</td>
	</tr>

<tr>
	<td class="file low" data-value="ReactMixin.js"><a href="ReactMixin.js.html">ReactMixin.js</a></td>
	<td data-value="9.38" class="pic low"><span class="cover-fill" style="width: 9px;"></span><span class="cover-empty" style="width:91px;"></span></td>
	<td data-value="9.38" class="pct low">9.38%</td>
	<td data-value="32" class="abs low">(3&nbsp;/&nbsp;32)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="22" class="abs low">(0&nbsp;/&nbsp;22)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="4" class="abs low">(0&nbsp;/&nbsp;4)</td>
	<td data-value="9.38" class="pct low">9.38%</td>
	<td data-value="32" class="abs low">(3&nbsp;/&nbsp;32)</td>
	</tr>

<tr>
	<td class="file low" data-value="SecondPreciseClock.js"><a href="SecondPreciseClock.js.html">SecondPreciseClock.js</a></td>
	<td data-value="16.67" class="pic low"><span class="cover-fill" style="width: 16px;"></span><span class="cover-empty" style="width:84px;"></span></td>
	<td data-value="16.67" class="pct low">16.67%</td>
	<td data-value="72" class="abs low">(12&nbsp;/&nbsp;72)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="28" class="abs low">(0&nbsp;/&nbsp;28)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="8" class="abs low">(0&nbsp;/&nbsp;8)</td>
	<td data-value="18.46" class="pct low">18.46%</td>
	<td data-value="65" class="abs low">(12&nbsp;/&nbsp;65)</td>
	</tr>

<tr>
	<td class="file low" data-value="Set.js"><a href="Set.js.html">Set.js</a></td>
	<td data-value="9.86" class="pic low"><span class="cover-fill" style="width: 9px;"></span><span class="cover-empty" style="width:91px;"></span></td>
	<td data-value="9.86" class="pct low">9.86%</td>
	<td data-value="71" class="abs low">(7&nbsp;/&nbsp;71)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="26" class="abs low">(0&nbsp;/&nbsp;26)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="16" class="abs low">(0&nbsp;/&nbsp;16)</td>
	<td data-value="9.86" class="pct low">9.86%</td>
	<td data-value="71" class="abs low">(7&nbsp;/&nbsp;71)</td>
	</tr>

<tr>
	<td class="file low" data-value="SharedWebStorage.js"><a href="SharedWebStorage.js.html">SharedWebStorage.js</a></td>
	<td data-value="16.67" class="pic low"><span class="cover-fill" style="width: 16px;"></span><span class="cover-empty" style="width:84px;"></span></td>
	<td data-value="16.67" class="pct low">16.67%</td>
	<td data-value="84" class="abs low">(14&nbsp;/&nbsp;84)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="39" class="abs low">(0&nbsp;/&nbsp;39)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="9" class="abs low">(0&nbsp;/&nbsp;9)</td>
	<td data-value="17.07" class="pct low">17.07%</td>
	<td data-value="82" class="abs low">(14&nbsp;/&nbsp;82)</td>
	</tr>

<tr>
	<td class="file low" data-value="SockJSServerStream.js"><a href="SockJSServerStream.js.html">SockJSServerStream.js</a></td>
	<td data-value="17.39" class="pic low"><span class="cover-fill" style="width: 17px;"></span><span class="cover-empty" style="width:83px;"></span></td>
	<td data-value="17.39" class="pct low">17.39%</td>
	<td data-value="23" class="abs low">(4&nbsp;/&nbsp;23)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="14" class="abs low">(0&nbsp;/&nbsp;14)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="5" class="abs low">(0&nbsp;/&nbsp;5)</td>
	<td data-value="18.18" class="pct low">18.18%</td>
	<td data-value="22" class="abs low">(4&nbsp;/&nbsp;22)</td>
	</tr>

<tr>
	<td class="file low" data-value="SockJSStream.js"><a href="SockJSStream.js.html">SockJSStream.js</a></td>
	<td data-value="6.45" class="pic low"><span class="cover-fill" style="width: 6px;"></span><span class="cover-empty" style="width:94px;"></span></td>
	<td data-value="6.45" class="pct low">6.45%</td>
	<td data-value="31" class="abs low">(2&nbsp;/&nbsp;31)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="8" class="abs low">(0&nbsp;/&nbsp;8)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="7" class="abs low">(0&nbsp;/&nbsp;7)</td>
	<td data-value="6.67" class="pct low">6.67%</td>
	<td data-value="30" class="abs low">(2&nbsp;/&nbsp;30)</td>
	</tr>

<tr>
	<td class="file low" data-value="Spec.js"><a href="Spec.js.html">Spec.js</a></td>
	<td data-value="30.52" class="pic low"><span class="cover-fill" style="width: 30px;"></span><span class="cover-empty" style="width:70px;"></span></td>
	<td data-value="30.52" class="pct low">30.52%</td>
	<td data-value="154" class="abs low">(47&nbsp;/&nbsp;154)</td>
	<td data-value="7.78" class="pct low">7.78%</td>
	<td data-value="90" class="abs low">(7&nbsp;/&nbsp;90)</td>
	<td data-value="3.13" class="pct low">3.13%</td>
	<td data-value="32" class="abs low">(1&nbsp;/&nbsp;32)</td>
	<td data-value="32.19" class="pct low">32.19%</td>
	<td data-value="146" class="abs low">(47&nbsp;/&nbsp;146)</td>
	</tr>

<tr>
	<td class="file low" data-value="Storage.js"><a href="Storage.js.html">Storage.js</a></td>
	<td data-value="17.86" class="pic low"><span class="cover-fill" style="width: 17px;"></span><span class="cover-empty" style="width:83px;"></span></td>
	<td data-value="17.86" class="pct low">17.86%</td>
	<td data-value="140" class="abs low">(25&nbsp;/&nbsp;140)</td>
	<td data-value="2.17" class="pct low">2.17%</td>
	<td data-value="92" class="abs low">(2&nbsp;/&nbsp;92)</td>
	<td data-value="5.26" class="pct low">5.26%</td>
	<td data-value="19" class="abs low">(1&nbsp;/&nbsp;19)</td>
	<td data-value="18.8" class="pct low">18.8%</td>
	<td data-value="133" class="abs low">(25&nbsp;/&nbsp;133)</td>
	</tr>

<tr>
	<td class="file low" data-value="Syncable.js"><a href="Syncable.js.html">Syncable.js</a></td>
	<td data-value="22.36" class="pic low"><span class="cover-fill" style="width: 22px;"></span><span class="cover-empty" style="width:78px;"></span></td>
	<td data-value="22.36" class="pct low">22.36%</td>
	<td data-value="398" class="abs low">(89&nbsp;/&nbsp;398)</td>
	<td data-value="12.21" class="pct low">12.21%</td>
	<td data-value="303" class="abs low">(37&nbsp;/&nbsp;303)</td>
	<td data-value="12" class="pct low">12%</td>
	<td data-value="50" class="abs low">(6&nbsp;/&nbsp;50)</td>
	<td data-value="23.04" class="pct low">23.04%</td>
	<td data-value="382" class="abs low">(88&nbsp;/&nbsp;382)</td>
	</tr>

<tr>
	<td class="file low" data-value="Text.js"><a href="Text.js.html">Text.js</a></td>
	<td data-value="6.98" class="pic low"><span class="cover-fill" style="width: 6px;"></span><span class="cover-empty" style="width:94px;"></span></td>
	<td data-value="6.98" class="pct low">6.98%</td>
	<td data-value="86" class="abs low">(6&nbsp;/&nbsp;86)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="41" class="abs low">(0&nbsp;/&nbsp;41)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="7" class="abs low">(0&nbsp;/&nbsp;7)</td>
	<td data-value="6.98" class="pct low">6.98%</td>
	<td data-value="86" class="abs low">(6&nbsp;/&nbsp;86)</td>
	</tr>

<tr>
	<td class="file low" data-value="Vector.js"><a href="Vector.js.html">Vector.js</a></td>
	<td data-value="4.58" class="pic low"><span class="cover-fill" style="width: 4px;"></span><span class="cover-empty" style="width:96px;"></span></td>
	<td data-value="4.58" class="pct low">4.58%</td>
	<td data-value="131" class="abs low">(6&nbsp;/&nbsp;131)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="72" class="abs low">(0&nbsp;/&nbsp;72)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="29" class="abs low">(0&nbsp;/&nbsp;29)</td>
	<td data-value="4.62" class="pct low">4.62%</td>
	<td data-value="130" class="abs low">(6&nbsp;/&nbsp;130)</td>
	</tr>

<tr>
	<td class="file low" data-value="WebSocketStream.js"><a href="WebSocketStream.js.html">WebSocketStream.js</a></td>
	<td data-value="19.35" class="pic low"><span class="cover-fill" style="width: 19px;"></span><span class="cover-empty" style="width:81px;"></span></td>
	<td data-value="19.35" class="pct low">19.35%</td>
	<td data-value="31" class="abs low">(6&nbsp;/&nbsp;31)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="10" class="abs low">(0&nbsp;/&nbsp;10)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="8" class="abs low">(0&nbsp;/&nbsp;8)</td>
	<td data-value="20.69" class="pct low">20.69%</td>
	<td data-value="29" class="abs low">(6&nbsp;/&nbsp;29)</td>
	</tr>

<tr>
	<td class="file low" data-value="ce.js"><a href="ce.js.html">ce.js</a></td>
	<td data-value="9.6" class="pic low"><span class="cover-fill" style="width: 9px;"></span><span class="cover-empty" style="width:91px;"></span></td>
	<td data-value="9.6" class="pct low">9.6%</td>
	<td data-value="125" class="abs low">(12&nbsp;/&nbsp;125)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="70" class="abs low">(0&nbsp;/&nbsp;70)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="13" class="abs low">(0&nbsp;/&nbsp;13)</td>
	<td data-value="10.08" class="pct low">10.08%</td>
	<td data-value="119" class="abs low">(12&nbsp;/&nbsp;119)</td>
	</tr>

<tr>
	<td class="file low" data-value="env.js"><a href="env.js.html">env.js</a></td>
	<td data-value="21.05" class="pic low"><span class="cover-fill" style="width: 21px;"></span><span class="cover-empty" style="width:79px;"></span></td>
	<td data-value="21.05" class="pct low">21.05%</td>
	<td data-value="19" class="abs low">(4&nbsp;/&nbsp;19)</td>
	<td data-value="10" class="pct low">10%</td>
	<td data-value="10" class="abs low">(1&nbsp;/&nbsp;10)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="2" class="abs low">(0&nbsp;/&nbsp;2)</td>
	<td data-value="21.05" class="pct low">21.05%</td>
	<td data-value="19" class="abs low">(4&nbsp;/&nbsp;19)</td>
	</tr>

<tr>
	<td class="file low" data-value="swarm3-murmur.js"><a href="swarm3-murmur.js.html">swarm3-murmur.js</a></td>
	<td data-value="5.71" class="pic low"><span class="cover-fill" style="width: 5px;"></span><span class="cover-empty" style="width:95px;"></span></td>
	<td data-value="5.71" class="pct low">5.71%</td>
	<td data-value="35" class="abs low">(2&nbsp;/&nbsp;35)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="3" class="abs low">(0&nbsp;/&nbsp;3)</td>
	<td data-value="0" class="pct low">0%</td>
	<td data-value="1" class="abs low">(0&nbsp;/&nbsp;1)</td>
	<td data-value="5.71" class="pct low">5.71%</td>
	<td data-value="35" class="abs low">(2&nbsp;/&nbsp;35)</td>
	</tr>

</tbody>
</table>
</div></div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/AsyncLoopbackConnection.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/AsyncLoopbackConnection.js</span></h1>
    <h2>
        
        Statements: <span class="metric">23.08% <small>(9 / 39)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 20)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 7)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">23.08% <small>(9 / 39)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/node_modules/swarm/lib/</a> &#187; AsyncLoopbackConnection.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
&nbsp;
var env = require('./env');
&nbsp;
<span class="fstat-no" title="function not covered" >function AsyncLoopbackConnection(url) {</span>
<span class="cstat-no" title="statement not covered" >    var m = url.match(/loopback:(\w+)/);</span>
<span class="cstat-no" title="statement not covered" >    if (!m) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error('invalid url');</span>
    }
<span class="cstat-no" title="statement not covered" >    this.id = m[1];</span>
<span class="cstat-no" title="statement not covered" >    this.lstn = {};</span>
<span class="cstat-no" title="statement not covered" >    this.queue = [];</span>
<span class="cstat-no" title="statement not covered" >    if (this.id in AsyncLoopbackConnection.pipes) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error('duplicate');</span>
    }
<span class="cstat-no" title="statement not covered" >    AsyncLoopbackConnection.pipes[this.id] = this;</span>
<span class="cstat-no" title="statement not covered" >    var pair = this.pair();</span>
<span class="cstat-no" title="statement not covered" >    if (pair &amp;&amp; pair.queue.length) {</span>
<span class="cstat-no" title="statement not covered" >        pair.write();</span>
    }
}
AsyncLoopbackConnection.pipes = {};
&nbsp;
env.streams.loopback = AsyncLoopbackConnection;
&nbsp;
AsyncLoopbackConnection.prototype.pair = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >    var pairId = this.id.match(/./g).reverse().join('');</span>
<span class="cstat-no" title="statement not covered" >    return AsyncLoopbackConnection.pipes[pairId];</span>
};
&nbsp;
AsyncLoopbackConnection.prototype.on = <span class="fstat-no" title="function not covered" >function (evname, fn) {</span>
<span class="cstat-no" title="statement not covered" >    if (evname in this.lstn) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error('multiple listeners not supported');</span>
    }
<span class="cstat-no" title="statement not covered" >    this.lstn[evname] = fn;</span>
};
&nbsp;
AsyncLoopbackConnection.prototype.receive = <span class="fstat-no" title="function not covered" >function (string) {</span>
<span class="cstat-no" title="statement not covered" >    this.lstn.data &amp;&amp; this.lstn.data(string);</span>
};
&nbsp;
AsyncLoopbackConnection.prototype.write = <span class="fstat-no" title="function not covered" >function (obj) {</span>
<span class="cstat-no" title="statement not covered" >    var self = this;</span>
<span class="cstat-no" title="statement not covered" >    obj &amp;&amp; self.queue.push(obj.toString());</span>
<span class="cstat-no" title="statement not covered" >    setTimeout(<span class="fstat-no" title="function not covered" >function () {</span></span>
<span class="cstat-no" title="statement not covered" >        var pair = self.pair();</span>
<span class="cstat-no" title="statement not covered" >        if (!pair) {</span>
<span class="cstat-no" title="statement not covered" >            return;</span>
        }
<span class="cstat-no" title="statement not covered" >        while (self.queue.length) {</span>
<span class="cstat-no" title="statement not covered" >            pair.receive(self.queue.shift());</span>
        }
    }, 1);
};
&nbsp;
AsyncLoopbackConnection.prototype.close = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >    delete AsyncLoopbackConnection.pipes[this.id];</span>
<span class="cstat-no" title="statement not covered" >    var pair = this.pair();</span>
<span class="cstat-no" title="statement not covered" >    pair &amp;&amp; pair.close();</span>
<span class="cstat-no" title="statement not covered" >    this.lstn.close &amp;&amp; this.lstn.close();</span>
};
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/CollectionMethodsMixin.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/CollectionMethodsMixin.js</span></h1>
    <h2>
        
        Statements: <span class="metric">13.33% <small>(2 / 15)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 4)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 5)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">13.33% <small>(2 / 15)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/node_modules/swarm/lib/</a> &#187; CollectionMethodsMixin.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
&nbsp;
&nbsp;
module.exports = {
&nbsp;
    /**
     * Subscribe on collections entries' events
     * @param {function(Spec|string, Object, {deliver: function()})} callback
     * @this Set|Vector
     */
    onObjectEvent: <span class="fstat-no" title="function not covered" >function (callback) {</span>
<span class="cstat-no" title="statement not covered" >        this._proxy.owner = this;</span>
<span class="cstat-no" title="statement not covered" >        this._proxy.on(callback);</span>
    },
&nbsp;
    /**
     * Unsubscribe from collections entries' events
     * @param {function(*)} callback
     * @this Set|Vector
     */
    offObjectEvent: <span class="fstat-no" title="function not covered" >function (callback) {</span>
<span class="cstat-no" title="statement not covered" >        this._proxy.off(callback);</span>
    },
&nbsp;
    /**
     * Waits for collection to receive state from cache or uplink and then invokes passed callback
     *
     * @param {function()} callback
     * @this Set|Vector
     */
    onObjectStateReady: <span class="fstat-no" title="function not covered" >function (callback) {</span> // TODO timeout ?
<span class="cstat-no" title="statement not covered" >        var self = this;</span>
<span class="fstat-no" title="function not covered" >        function checker() {</span>
<span class="cstat-no" title="statement not covered" >            var notInitedYet = self.filter(<span class="fstat-no" title="function not covered" >function (entry) {</span></span>
<span class="cstat-no" title="statement not covered" >                return !entry._version;</span>
            });
<span class="cstat-no" title="statement not covered" >            if (!notInitedYet.length) {</span>
                // all entries are inited
<span class="cstat-no" title="statement not covered" >                callback();</span>
            } else {
                // wait for some entry not ready yet
<span class="cstat-no" title="statement not covered" >                var randomIdx = (Math.random() * (notInitedYet.length - 1)) | 0;</span>
<span class="cstat-no" title="statement not covered" >                notInitedYet[randomIdx].once('init', checker);</span>
            }
        }
<span class="cstat-no" title="statement not covered" >        if (this._version) {</span>
<span class="cstat-no" title="statement not covered" >            checker();</span>
        } else {
<span class="cstat-no" title="statement not covered" >            this.once('init', checker);</span>
        }
    }
};
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/EinarosWSStream.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/EinarosWSStream.js</span></h1>
    <h2>
        
        Statements: <span class="metric">21.21% <small>(7 / 33)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 16)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 7)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">22.58% <small>(7 / 31)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/node_modules/swarm/lib/</a> &#187; EinarosWSStream.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
&nbsp;
var env = require('./env');
var ws_lib = require('ws');
&nbsp;
<span class="fstat-no" title="function not covered" >function EinarosWSStream(ws) {</span>
<span class="cstat-no" title="statement not covered" >    var self = this,</span>
        ln = this.lstn = {},
        buf = [];
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (typeof ws === 'string') { // url passed</span>
<span class="cstat-no" title="statement not covered" >        ws = new ws_lib(ws);</span>
    }
<span class="cstat-no" title="statement not covered" >    this.ws = ws;</span>
<span class="cstat-no" title="statement not covered" >    if (ws.readyState !== 1/*WebSocket.OPEN*/) {</span>
<span class="cstat-no" title="statement not covered" >        this.buf = buf; </span>//will wait for "open"
    }
<span class="cstat-no" title="statement not covered" >    ws.on('open', <span class="fstat-no" title="function not covered" >function () {</span></span>
<span class="cstat-no" title="statement not covered" >        buf.reverse();</span>
<span class="cstat-no" title="statement not covered" >        self.buf = null;</span>
<span class="cstat-no" title="statement not covered" >        while (buf.length) {</span>
<span class="cstat-no" title="statement not covered" >            self.write(buf.pop());</span>
        }
    });
<span class="cstat-no" title="statement not covered" >    ws.on('close', <span class="fstat-no" title="function not covered" >function () {</span> <span class="cstat-no" title="statement not covered" >ln.close &amp;&amp; ln.close(); </span>});</span>
<span class="cstat-no" title="statement not covered" >    ws.on('message', <span class="fstat-no" title="function not covered" >function (msg) {</span></span>
<span class="cstat-no" title="statement not covered" >        try {</span>
<span class="cstat-no" title="statement not covered" >            ln.data &amp;&amp; ln.data(msg);</span>
        } catch (ex) {
<span class="cstat-no" title="statement not covered" >            console.error('message processing fails', ex);</span>
<span class="cstat-no" title="statement not covered" >            ln.error &amp;&amp; ln.error(ex.message);</span>
        }
    });
<span class="cstat-no" title="statement not covered" >    ws.on('error', <span class="fstat-no" title="function not covered" >function (msg) {</span> <span class="cstat-no" title="statement not covered" >ln.error &amp;&amp; ln.error(msg); </span>});</span>
}
&nbsp;
module.exports = EinarosWSStream;
&nbsp;
EinarosWSStream.prototype.on = <span class="fstat-no" title="function not covered" >function (evname, fn) {</span>
<span class="cstat-no" title="statement not covered" >    if (evname in this.lstn) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error('not supported');</span>
    }
<span class="cstat-no" title="statement not covered" >    this.lstn[evname] = fn;</span>
};
&nbsp;
EinarosWSStream.prototype.write = <span class="fstat-no" title="function not covered" >function (data) {</span>
<span class="cstat-no" title="statement not covered" >    if (this.buf) {</span>
<span class="cstat-no" title="statement not covered" >        this.buf.push(data.toString());</span>
    } else {
<span class="cstat-no" title="statement not covered" >        this.ws.send(data.toString());</span>
    }
};
&nbsp;
env.streams.ws = env.streams.wss = EinarosWSStream;
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/FileStorage.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/FileStorage.js</span></h1>
    <h2>
        
        Statements: <span class="metric">15.89% <small>(17 / 107)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 42)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 15)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">16.35% <small>(17 / 104)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/node_modules/swarm/lib/</a> &#187; FileStorage.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
var fs = require('fs');
var path = require('path');
var env = require('./env');
var Spec = require('./Spec');
var Storage = require('./Storage');
&nbsp;
/**
 * An improvised filesystem-based storage implementation.
 * Objects are saved into separate files in a hashed directory
 * tree. Ongoing operations are streamed into a log file.
 * One can go surprisingly far with this kind of an approach.
 * https://news.ycombinator.com/item?id=7872239 */
<span class="fstat-no" title="function not covered" >function FileStorage (dir) {</span>
<span class="cstat-no" title="statement not covered" >    Storage.call(this);</span>
<span class="cstat-no" title="statement not covered" >    this._host = null; </span>//will be set during Host creation
<span class="cstat-no" title="statement not covered" >    this.dir = path.resolve(dir);</span>
<span class="cstat-no" title="statement not covered" >    if (!fs.existsSync(this.dir)) {</span>
<span class="cstat-no" title="statement not covered" >        fs.mkdirSync(this.dir);</span>
    }
<span class="cstat-no" title="statement not covered" >    this._id = 'file';</span>
<span class="cstat-no" title="statement not covered" >    this.tail = {};</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    this.loadLog();</span>
<span class="cstat-no" title="statement not covered" >    this.rotateLog();</span>
}
FileStorage.prototype = new Storage();
module.exports = FileStorage;
&nbsp;
FileStorage.prototype.stateFileName = <span class="fstat-no" title="function not covered" >function (spec) {</span>
<span class="cstat-no" title="statement not covered" >    var base = path.resolve(this.dir, spec.type());</span>
<span class="cstat-no" title="statement not covered" >    var file = path.resolve(base, spec.id());</span>
<span class="cstat-no" title="statement not covered" >    return file; </span>// TODO hashing?
};
&nbsp;
FileStorage.prototype.logFileName = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >    return path.resolve(this.dir, "_log");</span>
};
&nbsp;
FileStorage.prototype.writeState = <span class="fstat-no" title="function not covered" >function (spec, state, cb) {</span>
<span class="cstat-no" title="statement not covered" >    var self = this;</span>
<span class="cstat-no" title="statement not covered" >    var ti = spec.filter('/#');</span>
<span class="cstat-no" title="statement not covered" >    var fileName = this.stateFileName(ti);</span>
<span class="cstat-no" title="statement not covered" >    var dir = path.dirname(fileName);</span>
<span class="cstat-no" title="statement not covered" >    if (!fs.existsSync(dir)) {</span>
<span class="cstat-no" title="statement not covered" >        fs.mkdirSync(dir);</span>
    }
<span class="cstat-no" title="statement not covered" >    var save = JSON.stringify(state, undefined, 2);</span>
    // dump JSON to the tmp file
<span class="cstat-no" title="statement not covered" >    delete self.tails[ti]; </span>// TODO save 'em in case write fails
<span class="cstat-no" title="statement not covered" >    fs.writeFile(fileName, save, <span class="fstat-no" title="function not covered" >function onSave(err) {</span></span>
<span class="cstat-no" title="statement not covered" >        if (err) {</span>
<span class="cstat-no" title="statement not covered" >            console.error("failed to flush state; can't trim the log", err);</span>
        }
<span class="cstat-no" title="statement not covered" >        cb(err);</span>
    });
};
&nbsp;
FileStorage.prototype.writeOp = <span class="fstat-no" title="function not covered" >function (spec, value, cb) {</span>
<span class="cstat-no" title="statement not covered" >    var self = this;</span>
<span class="cstat-no" title="statement not covered" >    var ti = spec.filter('/#');</span>
<span class="cstat-no" title="statement not covered" >    var vm = spec.filter('!.');</span>
<span class="cstat-no" title="statement not covered" >    var tail = this.tails[ti] || (this.tails[ti] = {});</span>
<span class="cstat-no" title="statement not covered" >    if (vm in tail) {</span>
<span class="cstat-no" title="statement not covered" >        console.error('op replay @storage',vm,new Error().stack);</span>
<span class="cstat-no" title="statement not covered" >        return;</span>
    }
<span class="cstat-no" title="statement not covered" >    var clone = JSON.parse(JSON.stringify(value)); </span>// FIXME performance please
<span class="cstat-no" title="statement not covered" >    tail[vm] = clone;</span>
<span class="cstat-no" title="statement not covered" >    var record = ',\n"'+spec+'":\t'+JSON.stringify(clone);</span>
<span class="cstat-no" title="statement not covered" >    this.logFile.write (record, <span class="fstat-no" title="function not covered" >function onFail(err) {</span></span>
<span class="cstat-no" title="statement not covered" >        if (err) { <span class="cstat-no" title="statement not covered" >self.close(null,err); </span>}</span>
<span class="cstat-no" title="statement not covered" >        cb(err);</span>
    });
};
&nbsp;
&nbsp;
FileStorage.prototype.readState = <span class="fstat-no" title="function not covered" >function (ti, callback) {</span>
<span class="cstat-no" title="statement not covered" >    var statefn = this.stateFileName(ti);</span>
    // read in the state
<span class="cstat-no" title="statement not covered" >    fs.readFile(statefn, <span class="fstat-no" title="function not covered" >function onRead(err, data) {</span> // FIXME fascism</span>
<span class="cstat-no" title="statement not covered" >        var state = err ? {_version: '!0'} : JSON.parse(data.toString());</span>
<span class="cstat-no" title="statement not covered" >        callback(null,state||null); </span>// important: no state is "null"
    });
};
&nbsp;
&nbsp;
FileStorage.prototype.readOps = <span class="fstat-no" title="function not covered" >function (ti, callback) {</span>
<span class="cstat-no" title="statement not covered" >    var tail = this.tails[ti];</span>
<span class="cstat-no" title="statement not covered" >    if (tail) {</span>
<span class="cstat-no" title="statement not covered" >        var unjsoned = {};</span>
<span class="cstat-no" title="statement not covered" >        for(var key in tail) {</span>
<span class="cstat-no" title="statement not covered" >            unjsoned[key] = tail[key];</span>
        }
<span class="cstat-no" title="statement not covered" >        tail = unjsoned;</span>
    }
<span class="cstat-no" title="statement not covered" >    callback(null, tail||null);</span>
};
&nbsp;
&nbsp;
FileStorage.prototype.close = <span class="fstat-no" title="function not covered" >function (callback,error) {</span>
<span class="cstat-no" title="statement not covered" >    if (error) {</span>
<span class="cstat-no" title="statement not covered" >        console.log("fatal IO error", error);</span>
    }
<span class="cstat-no" title="statement not covered" >    if (this.logFile) {</span>
<span class="cstat-no" title="statement not covered" >        this.rotateLog(true, callback);</span>
    }
};
&nbsp;
&nbsp;
FileStorage.prototype.rotateLog = <span class="fstat-no" title="function not covered" >function (noOpen, callback) {</span>
<span class="cstat-no" title="statement not covered" >    var self = this;</span>
<span class="cstat-no" title="statement not covered" >    if (this.logFile) {</span>
<span class="cstat-no" title="statement not covered" >        this.logFile.end('}', callback);</span>
<span class="cstat-no" title="statement not covered" >        this.logFile = null;</span>
<span class="cstat-no" title="statement not covered" >        callback = undefined;</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (!noOpen) {</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (fs.existsSync(this.logFileName())) {</span>
<span class="cstat-no" title="statement not covered" >            fs.rename(this.logFileName(),this.logFileName()+'.bak');</span>
        }
<span class="cstat-no" title="statement not covered" >        this.logFile = fs.createWriteStream(this.logFileName()); </span>// TODO file swap
<span class="cstat-no" title="statement not covered" >        this.logFile.on('error', <span class="fstat-no" title="function not covered" >function (err) {</span></span>
<span class="cstat-no" title="statement not covered" >            self.close(null,err);</span>
        });
&nbsp;
<span class="cstat-no" title="statement not covered" >        var json = JSON.stringify(this.tails, undefined, 2);</span>
<span class="cstat-no" title="statement not covered" >        json = '{"":\n' + json; </span>// open-ended JSON
&nbsp;
<span class="cstat-no" title="statement not covered" >        this.logFile.write (json, <span class="fstat-no" title="function not covered" >function onFail(err) {</span></span>
<span class="cstat-no" title="statement not covered" >            if (err) { <span class="cstat-no" title="statement not covered" >self.close(null,err); </span>}</span>
        });
&nbsp;
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (callback) {</span>
<span class="cstat-no" title="statement not covered" >        callback();</span>
    }
&nbsp;
};
&nbsp;
FileStorage.prototype.loadLog = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >    if ( !fs.existsSync(this.logFileName()) ) {</span>
<span class="cstat-no" title="statement not covered" >        return;</span>
    }
<span class="cstat-no" title="statement not covered" >    var json = fs.readFileSync(this.logFileName(), {encoding:"utf8"});</span>
<span class="cstat-no" title="statement not covered" >    if (!json) { <span class="cstat-no" title="statement not covered" >return; </span>}</span>
<span class="cstat-no" title="statement not covered" >    var log;</span>
<span class="cstat-no" title="statement not covered" >    try {</span>
<span class="cstat-no" title="statement not covered" >        log = JSON.parse(json);</span>
    } catch (ex) {
        // open-ended JSON
<span class="cstat-no" title="statement not covered" >        log = JSON.parse(json + '}');</span>
    }
<span class="cstat-no" title="statement not covered" >    this.tails = log[''];</span>
<span class="cstat-no" title="statement not covered" >    delete log[''];</span>
<span class="cstat-no" title="statement not covered" >    for(var s in log) {</span>
<span class="cstat-no" title="statement not covered" >        var spec = new Spec(s);</span>
<span class="cstat-no" title="statement not covered" >        if (spec.pattern()==='/#!.') {</span>
<span class="cstat-no" title="statement not covered" >            var ti = spec.filter('/#');</span>
<span class="cstat-no" title="statement not covered" >            var vm = spec.filter('!.');</span>
<span class="cstat-no" title="statement not covered" >            var tail = this.tails[ti] || (this.tails[ti] = {});</span>
<span class="cstat-no" title="statement not covered" >            tail[vm]  = log[spec];</span>
        }
    }
};
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/Host.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/Host.js</span></h1>
    <h2>
        
        Statements: <span class="metric">7.38% <small>(11 / 149)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 87)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 22)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">7.43% <small>(11 / 148)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/node_modules/swarm/lib/</a> &#187; Host.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
&nbsp;
var env = require('./env');
var Spec = require('./Spec');
var Syncable = require('./Syncable');
var Pipe = require('./Pipe');
var SecondPreciseClock = require('./SecondPreciseClock');
&nbsp;
/**
 * Host is (normally) a singleton object registering/coordinating
 * all the local Swarm objects, connecting them to appropriate
 * external uplinks, maintaining clocks, etc.
 * Host itself is not fully synchronized like a Model but still
 * does some event gossiping with peer Hosts.
 * @constructor
 */
<span class="fstat-no" title="function not covered" >function Host(id, ms, storage) {</span>
<span class="cstat-no" title="statement not covered" >    this.objects = {};</span>
<span class="cstat-no" title="statement not covered" >    this.sources = {};</span>
<span class="cstat-no" title="statement not covered" >    this.storage = storage;</span>
<span class="cstat-no" title="statement not covered" >    this._host = this; </span>// :)
<span class="cstat-no" title="statement not covered" >    this._lstn = [','];</span>
<span class="cstat-no" title="statement not covered" >    this._id = id;</span>
<span class="cstat-no" title="statement not covered" >    this._server = /^swarm~.*/.test(id);</span>
<span class="cstat-no" title="statement not covered" >    var clock_fn = env.clockType || SecondPreciseClock;</span>
<span class="cstat-no" title="statement not covered" >    this.clock = new clock_fn(this._id, ms||0);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (this.storage) {</span>
<span class="cstat-no" title="statement not covered" >        this.sources[this._id] = this.storage;</span>
<span class="cstat-no" title="statement not covered" >        this.storage._host = this;</span>
    }
<span class="cstat-no" title="statement not covered" >    delete this.objects[this.spec()];</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (!env.multihost) {</span>
<span class="cstat-no" title="statement not covered" >        if (env.localhost) {</span>
<span class="cstat-no" title="statement not covered" >            throw new Error('use multihost mode');</span>
        }
<span class="cstat-no" title="statement not covered" >        env.localhost = this;</span>
    }
}
&nbsp;
Host.MAX_INT = 9007199254740992;
Host.MAX_SYNC_TIME = 60 * 60000; // 1 hour (milliseconds)
Host.HASH_POINTS = 3;
&nbsp;
Host.hashDistance = <span class="fstat-no" title="function not covered" >function hashDistance(peer, obj) {</span>
<span class="cstat-no" title="statement not covered" >    if ((obj).constructor !== Number) {</span>
<span class="cstat-no" title="statement not covered" >        if (obj._id) {</span>
<span class="cstat-no" title="statement not covered" >            obj = obj._id;</span>
        }
<span class="cstat-no" title="statement not covered" >        obj = env.hashfn(obj);</span>
    }
<span class="cstat-no" title="statement not covered" >    if (peer._id) {</span>
<span class="cstat-no" title="statement not covered" >        peer = peer._id;</span>
    }
<span class="cstat-no" title="statement not covered" >    var dist = 4294967295;</span>
<span class="cstat-no" title="statement not covered" >    for (var i = 0; i &lt; Host.HASH_POINTS; i++) {</span>
<span class="cstat-no" title="statement not covered" >        var hash = env.hashfn(peer._id + ':' + i);</span>
<span class="cstat-no" title="statement not covered" >        dist = Math.min(dist, hash ^ obj);</span>
    }
<span class="cstat-no" title="statement not covered" >    return dist;</span>
};
&nbsp;
module.exports = Syncable.extend(Host, {
&nbsp;
    deliver: <span class="fstat-no" title="function not covered" >function (spec, val, repl) {</span>
<span class="cstat-no" title="statement not covered" >        if (spec.type() !== 'Host') {</span>
<span class="cstat-no" title="statement not covered" >            var typeid = spec.filter('/#');</span>
<span class="cstat-no" title="statement not covered" >            var obj = this.get(typeid);</span>
<span class="cstat-no" title="statement not covered" >            if (obj) {</span>
                // TODO seeTimestamp()
<span class="cstat-no" title="statement not covered" >                obj.deliver(spec, val, repl);</span>
            }
        } else {
<span class="cstat-no" title="statement not covered" >            this._super.deliver.apply(this, arguments);</span>
        }
    },
&nbsp;
    init: <span class="fstat-no" title="function not covered" >function (spec, val, repl) {</span>
&nbsp;
    },
&nbsp;
    get: <span class="fstat-no" title="function not covered" >function (spec, callback) {</span>
<span class="cstat-no" title="statement not covered" >        if (spec &amp;&amp; spec.constructor === Function &amp;&amp; spec.prototype._type) {</span>
<span class="cstat-no" title="statement not covered" >            spec = '/' + spec.prototype._type;</span>
        }
<span class="cstat-no" title="statement not covered" >        spec = new Spec(spec);</span>
<span class="cstat-no" title="statement not covered" >        var typeid = spec.filter('/#');</span>
<span class="cstat-no" title="statement not covered" >        if (!typeid.has('/')) {</span>
<span class="cstat-no" title="statement not covered" >            throw new Error('invalid spec');</span>
        }
<span class="cstat-no" title="statement not covered" >        var o = typeid.has('#') &amp;&amp; this.objects[typeid];</span>
<span class="cstat-no" title="statement not covered" >        if (!o) {</span>
<span class="cstat-no" title="statement not covered" >            var t = Syncable.types[spec.type()];</span>
<span class="cstat-no" title="statement not covered" >            if (!t) {</span>
<span class="cstat-no" title="statement not covered" >                throw new Error('type unknown: ' + spec);</span>
            }
<span class="cstat-no" title="statement not covered" >            o = new t(typeid, undefined, this);</span>
<span class="cstat-no" title="statement not covered" >            if (typeof(callback) === 'function') {</span>
<span class="cstat-no" title="statement not covered" >                o.on('.init', callback);</span>
            }
        }
<span class="cstat-no" title="statement not covered" >        return o;</span>
    },
&nbsp;
    addSource: <span class="fstat-no" title="function not covered" >function hostAddPeer(spec, peer) {</span>
        //FIXME when their time is off so tell them so
        // if (false) { this.clockOffset; }
<span class="cstat-no" title="statement not covered" >        var old = this.sources[peer._id];</span>
<span class="cstat-no" title="statement not covered" >        if (old) {</span>
<span class="cstat-no" title="statement not covered" >            old.deliver(this.newEventSpec('off'), '', this);</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        this.sources[peer._id] = peer;</span>
<span class="cstat-no" title="statement not covered" >        if (spec.op() === 'on') {</span>
<span class="cstat-no" title="statement not covered" >            peer.deliver(this.newEventSpec('reon'), this.clock.ms(), this);</span>
        }
<span class="cstat-no" title="statement not covered" >        for (var sp in this.objects) {</span>
<span class="cstat-no" title="statement not covered" >            this.objects[sp].checkUplink();</span>
        }
    },
&nbsp;
    neutrals: {
        /**
         * Host forwards on() calls to local objects to support some
         * shortcut notations, like
         *          host.on('/Mouse',callback)
         *          host.on('/Mouse.init',callback)
         *          host.on('/Mouse#Mickey',callback)
         *          host.on('/Mouse#Mickey.init',callback)
         *          host.on('/Mouse#Mickey!baseVersion',repl)
         *          host.on('/Mouse#Mickey!base.x',trackfn)
         * The target object may not exist beforehand.
         * Note that the specifier is actually the second 3sig parameter
         * (value). The 1st (spec) reflects this /Host.on invocation only.
         */
        on: <span class="fstat-no" title="function not covered" >function hostOn(spec, filter, lstn) {</span>
<span class="cstat-no" title="statement not covered" >            if (!filter) {</span>
                // the subscriber needs "all the events"
<span class="cstat-no" title="statement not covered" >                return this.addSource(spec, lstn);</span>
            }
&nbsp;
<span class="cstat-no" title="statement not covered" >            if (filter.constructor === Function &amp;&amp; filter.id) {</span>
<span class="cstat-no" title="statement not covered" >                filter = new Spec(filter.id, '/');</span>
            } else <span class="cstat-no" title="statement not covered" >if (filter.constructor === String) {</span>
<span class="cstat-no" title="statement not covered" >                filter = new Spec(filter, '.');</span>
            }
            // either suscribe to this Host or to some other object
<span class="cstat-no" title="statement not covered" >            if (!filter.has('/') || filter.type() === 'Host') {</span>
<span class="cstat-no" title="statement not covered" >                this._super._neutrals.on.call(this, spec, filter, lstn);</span>
            } else {
<span class="cstat-no" title="statement not covered" >                var objSpec = new Spec(filter);</span>
<span class="cstat-no" title="statement not covered" >                if (!objSpec.has('#')) {</span>
<span class="cstat-no" title="statement not covered" >                    throw new Error('no id to listen');</span>
                }
<span class="cstat-no" title="statement not covered" >                objSpec = objSpec.set('.on').set(spec.version(), '!');</span>
<span class="cstat-no" title="statement not covered" >                this.deliver(objSpec, filter, lstn);</span>
            }
        },
&nbsp;
        reon: <span class="fstat-no" title="function not covered" >function hostReOn(spec, ms, host) {</span>
<span class="cstat-no" title="statement not covered" >            if (spec.type() !== 'Host') {</span>
<span class="cstat-no" title="statement not covered" >                throw new Error('Host.reon(/NotHost.reon)');</span>
            }
<span class="cstat-no" title="statement not covered" >            this.clock.adjustTime(ms);</span>
<span class="cstat-no" title="statement not covered" >            this.addSource(spec, host);</span>
        },
&nbsp;
        off: <span class="fstat-no" title="function not covered" >function (spec, nothing, peer) {</span>
<span class="cstat-no" title="statement not covered" >            peer.deliver(peer.spec().add(this.time(), '!').add('.reoff'), '', this);</span>
<span class="cstat-no" title="statement not covered" >            this.removeSource(spec, peer);</span>
        },
&nbsp;
        reoff: <span class="fstat-no" title="function not covered" >function hostReOff(spec, nothing, peer) {</span>
<span class="cstat-no" title="statement not covered" >            this.removeSource(spec, peer);</span>
        }
&nbsp;
    }, // neutrals
&nbsp;
    removeSource: <span class="fstat-no" title="function not covered" >function (spec, peer) {</span>
<span class="cstat-no" title="statement not covered" >        if (spec.type() !== 'Host') {</span>
<span class="cstat-no" title="statement not covered" >            throw new Error('Host.removeSource(/NoHost)');</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (this.sources[peer._id] !== peer) {</span>
<span class="cstat-no" title="statement not covered" >            console.error('peer unknown', peer._id); </span>//throw new Error
<span class="cstat-no" title="statement not covered" >            return;</span>
        }
<span class="cstat-no" title="statement not covered" >        delete this.sources[peer._id];</span>
<span class="cstat-no" title="statement not covered" >        for (var sp in this.objects) {</span>
<span class="cstat-no" title="statement not covered" >            var obj = this.objects[sp];</span>
<span class="cstat-no" title="statement not covered" >            if (obj.getListenerIndex(peer, true) &gt; -1) {</span>
<span class="cstat-no" title="statement not covered" >                obj.off(sp, '', peer);</span>
<span class="cstat-no" title="statement not covered" >                obj.checkUplink(sp);</span>
            }
        }
    },
&nbsp;
&nbsp;
    /**
     * Returns an unique Lamport timestamp on every invocation.
     * Swarm employs 30bit integer Unix-like timestamps starting epoch at
     * 1 Jan 2010. Timestamps are encoded as 5-char base64 tokens; in case
     * several events are generated by the same process at the same second
     * then sequence number is added so a timestamp may be more than 5
     * chars. The id of the Host (+user~session) is appended to the ts.
     */
    time: <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >        var ts = this.clock.issueTimestamp();</span>
<span class="cstat-no" title="statement not covered" >        this._version = ts;</span>
<span class="cstat-no" title="statement not covered" >        return ts;</span>
    },
&nbsp;
    /**
     * Returns an array of sources (caches,storages,uplinks,peers)
     * a given replica should be subscribed to. This default
     * implementation uses a simple consistent hashing scheme.
     * Note that a client may be connected to many servers
     * (peers), so the uplink selection logic is shared.
     * @param {Spec} spec some object specifier
     * @returns {Array} array of currently available uplinks for specified object
     */
    getSources: <span class="fstat-no" title="function not covered" >function (spec) {</span>
<span class="cstat-no" title="statement not covered" >        var self = this,</span>
            uplinks = [],
            mindist = 4294967295,
            rePeer = /^swarm~/, // peers, not clients
            target = env.hashfn(spec),
            closestPeer = null;
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (rePeer.test(this._id)) {</span>
<span class="cstat-no" title="statement not covered" >            mindist = Host.hashDistance(this._id, target);</span>
<span class="cstat-no" title="statement not covered" >            closestPeer = this.storage;</span>
        } else {
<span class="cstat-no" title="statement not covered" >            uplinks.push(self.storage); </span>// client-side cache
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        for (var id in this.sources) {</span>
<span class="cstat-no" title="statement not covered" >            if (!rePeer.test(id)) {</span>
<span class="cstat-no" title="statement not covered" >                continue;</span>
            }
<span class="cstat-no" title="statement not covered" >            var dist = Host.hashDistance(id, target);</span>
<span class="cstat-no" title="statement not covered" >            if (dist &lt; mindist) {</span>
<span class="cstat-no" title="statement not covered" >                closestPeer = this.sources[id];</span>
<span class="cstat-no" title="statement not covered" >                mindist = dist;</span>
            }
        }
<span class="cstat-no" title="statement not covered" >        if (closestPeer) {</span>
<span class="cstat-no" title="statement not covered" >            uplinks.push(closestPeer);</span>
        }
<span class="cstat-no" title="statement not covered" >        return uplinks;</span>
    },
&nbsp;
    isUplinked: <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >        for (var id in this.sources) {</span>
<span class="cstat-no" title="statement not covered" >            if (/^swarm~.*/.test(id)) {</span>
<span class="cstat-no" title="statement not covered" >                return true;</span>
            }
        }
<span class="cstat-no" title="statement not covered" >        return false;</span>
    },
&nbsp;
    isServer: <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >        return this._server;</span>
    },
&nbsp;
    register: <span class="fstat-no" title="function not covered" >function (obj) {</span>
<span class="cstat-no" title="statement not covered" >        var spec = obj.spec();</span>
<span class="cstat-no" title="statement not covered" >        if (spec in this.objects) {</span>
<span class="cstat-no" title="statement not covered" >            return this.objects[spec];</span>
        }
<span class="cstat-no" title="statement not covered" >        this.objects[spec] = obj;</span>
<span class="cstat-no" title="statement not covered" >        return obj;</span>
    },
&nbsp;
    unregister: <span class="fstat-no" title="function not covered" >function (obj) {</span>
<span class="cstat-no" title="statement not covered" >        var spec = obj.spec();</span>
        // TODO unsubscribe from the uplink - swarm-scale gc
<span class="cstat-no" title="statement not covered" >        if (spec in this.objects) {</span>
<span class="cstat-no" title="statement not covered" >            delete this.objects[spec];</span>
        }
    },
&nbsp;
    // waits for handshake from stream
    accept: <span class="fstat-no" title="function not covered" >function (stream_or_url, pipe_env) {</span>
<span class="cstat-no" title="statement not covered" >        new Pipe(this, stream_or_url, pipe_env);</span>
    },
&nbsp;
    // initiate handshake with peer
    connect: <span class="fstat-no" title="function not covered" >function (stream_or_url, pipe_env) {</span>
<span class="cstat-no" title="statement not covered" >        var pipe = new Pipe(this, stream_or_url, pipe_env);</span>
<span class="cstat-no" title="statement not covered" >        pipe.deliver(new Spec('/Host#'+this._id+'!0.on'), '', this); </span>//this.newEventSpec
<span class="cstat-no" title="statement not covered" >        return pipe;</span>
    },
&nbsp;
    disconnect: <span class="fstat-no" title="function not covered" >function (id) {</span>
<span class="cstat-no" title="statement not covered" >        for (var peer_id in this.sources) {</span>
<span class="cstat-no" title="statement not covered" >            if (id &amp;&amp; peer_id != id) {</span>
<span class="cstat-no" title="statement not covered" >                continue;</span>
            }
<span class="cstat-no" title="statement not covered" >            if (peer_id === this._id) {</span>
                // storage
<span class="cstat-no" title="statement not covered" >                continue;</span>
            }
<span class="cstat-no" title="statement not covered" >            var peer = this.sources[peer_id];</span>
            // normally, .off is sent by a downlink
<span class="cstat-no" title="statement not covered" >            peer.deliver(peer.spec().add(this.time(), '!').add('.off'));</span>
        }
    },
&nbsp;
    close: <span class="fstat-no" title="function not covered" >function (cb) {</span>
<span class="cstat-no" title="statement not covered" >        for(var id in this.sources) {</span>
<span class="cstat-no" title="statement not covered" >            if (id===this._id) {<span class="cstat-no" title="statement not covered" >continue;}</span></span>
<span class="cstat-no" title="statement not covered" >            this.disconnect(id);</span>
        }
<span class="cstat-no" title="statement not covered" >        if (this.storage) {</span>
<span class="cstat-no" title="statement not covered" >            this.storage.close(cb);</span>
        } else <span class="cstat-no" title="statement not covered" >if (cb) {</span>
<span class="cstat-no" title="statement not covered" >            cb();</span>
        }
    },
&nbsp;
    checkUplink: <span class="fstat-no" title="function not covered" >function (spec) {</span>
        //  TBD Host event relay + PEX
    }
&nbsp;
});
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/Html5Client.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/Html5Client.js</span></h1>
    <h2>
        
        Statements: <span class="metric">4% <small>(1 / 25)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 27)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 2)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">4% <small>(1 / 25)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/node_modules/swarm/lib/</a> &#187; Html5Client.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
&nbsp;
var Swarm = module.exports = window.Swarm = {};
&nbsp;
<span class="cstat-no" title="statement not covered" >Swarm.env = require('./env');</span>
<span class="cstat-no" title="statement not covered" >Swarm.Spec = require('./Spec');</span>
<span class="cstat-no" title="statement not covered" >Swarm.LongSpec = require('./LongSpec');</span>
<span class="cstat-no" title="statement not covered" >Swarm.Syncable = require('./Syncable');</span>
<span class="cstat-no" title="statement not covered" >Swarm.Model = require('./Model');</span>
<span class="cstat-no" title="statement not covered" >Swarm.Set = require('./Set');</span>
<span class="cstat-no" title="statement not covered" >Swarm.Vector = require('./Vector');</span>
<span class="cstat-no" title="statement not covered" >Swarm.Host = require('./Host');</span>
<span class="cstat-no" title="statement not covered" >Swarm.Pipe = require('./Pipe');</span>
<span class="cstat-no" title="statement not covered" >Swarm.Storage = require('./Storage');</span>
<span class="cstat-no" title="statement not covered" >Swarm.SharedWebStorage = require('./SharedWebStorage');</span>
<span class="cstat-no" title="statement not covered" >Swarm.LevelStorage = require('./LevelStorage');</span>
<span class="cstat-no" title="statement not covered" >Swarm.WebSocketStream = require('./WebSocketStream');</span>
<span class="cstat-no" title="statement not covered" >Swarm.ReactMixin = require('./ReactMixin');</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >Swarm.get = <span class="fstat-no" title="function not covered" >function (spec) {</span></span>
<span class="cstat-no" title="statement not covered" >    return Swarm.env.localhost.get(spec);</span>
};
&nbsp;
<span class="cstat-no" title="statement not covered" >var env = Swarm.env;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >if (env.isWebKit || env.isGecko) {</span>
<span class="cstat-no" title="statement not covered" >    env.log = <span class="fstat-no" title="function not covered" >function css_log(spec, value, replica, host) {</span></span>
<span class="cstat-no" title="statement not covered" >        if (!host &amp;&amp; replica &amp;&amp; replica._host) {</span>
<span class="cstat-no" title="statement not covered" >            host = replica._host;</span>
        }
<span class="cstat-no" title="statement not covered" >        if (value &amp;&amp; value.constructor.name === 'Spec') {</span>
<span class="cstat-no" title="statement not covered" >            value = value.toString();</span>
        }
<span class="cstat-no" title="statement not covered" >        console.log(</span>
                "%c%s  %c%s  %c%O  %c%s @%c%s",
                "color: #888",
                env.multihost ? host &amp;&amp; host._id : '',
                "color: #024; font-style: italic",
                spec.toString(),
                "font-style: normal; color: #042",
                value,
                "color: #88a",
                (replica &amp;&amp; ((replica.spec &amp;&amp; replica.spec().toString()) || replica._id)) ||
                (replica ? 'no id' : 'undef'),
                "color: #ccd",
                replica &amp;&amp; replica._host &amp;&amp; replica._host._id
                //replica&amp;&amp;replica.spec&amp;&amp;(replica.spec()+
                //    (this._host===replica._host?'':' @'+replica._host._id)
        );
    };
}
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/LamportClock.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/LamportClock.js</span></h1>
    <h2>
        
        Statements: <span class="metric">34.78% <small>(8 / 23)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 6)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 6)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">36.36% <small>(8 / 22)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/node_modules/swarm/lib/</a> &#187; LamportClock.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
&nbsp;
var Spec = require('./Spec');
&nbsp;
/** Pure logical-time Lamport clocks. */
var LamportClock = <span class="fstat-no" title="function not covered" >function (processId, initTime) {</span>
<span class="cstat-no" title="statement not covered" >    if (!Spec.reTok.test(processId)) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error('invalid process id: '+processId);</span>
    }
<span class="cstat-no" title="statement not covered" >    this.id = processId;</span>
    // sometimes we assume our local clock has some offset
<span class="cstat-no" title="statement not covered" >    this.seq = 0;</span>
};
&nbsp;
LamportClock.prototype.adjustTime = <span class="fstat-no" title="function not covered" >function () {</span>
};
&nbsp;
LamportClock.prototype.issueTimestamp = <span class="fstat-no" title="function not covered" >function time () {</span>
<span class="cstat-no" title="statement not covered" >    var base = Spec.int2base(this.seq++, 5);</span>
<span class="cstat-no" title="statement not covered" >    return base + '+' + this.id;</span>
};
&nbsp;
LamportClock.prototype.parseTimestamp = <span class="fstat-no" title="function not covered" >function parse (ts) {</span>
<span class="cstat-no" title="statement not covered" >    var m = ts.match(Spec.reTokExt);</span>
<span class="cstat-no" title="statement not covered" >    if (!m) {<span class="cstat-no" title="statement not covered" >throw new Error('malformed timestamp: '+ts);}</span></span>
<span class="cstat-no" title="statement not covered" >    return {</span>
        seq: Spec.base2int(m[1]),
        process: m[2]
    };
};
&nbsp;
/** Lamport partial order  imperfect semi-logical*/
LamportClock.prototype.checkTimestamp = <span class="fstat-no" title="function not covered" >function see (ts) {</span>
<span class="cstat-no" title="statement not covered" >    var parsed = this.parseTimestamp(ts);</span>
<span class="cstat-no" title="statement not covered" >    if (parsed.seq &gt;= this.seq) {</span>
<span class="cstat-no" title="statement not covered" >        this.seq = parsed.seq + 1;</span>
    }
<span class="cstat-no" title="statement not covered" >    return true;</span>
};
&nbsp;
LamportClock.prototype.time2date = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >    return undefined;</span>
};
&nbsp;
module.exports = LamportClock;
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/LevelStorage.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/LevelStorage.js</span></h1>
    <h2>
        
        Statements: <span class="metric">15.22% <small>(14 / 92)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 52)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 15)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">15.38% <small>(14 / 91)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/node_modules/swarm/lib/</a> &#187; LevelStorage.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
var env = require('./env');
var Spec = require('./Spec');
var Storage = require('./Storage');
&nbsp;
/** LevelDB is a perfect local storage: string-indexed, alphanumerically
  * sorted, stores JSON with minimal overhead. Last but not least, has
  * the same interface as IndexedDB. */
<span class="fstat-no" title="function not covered" >function LevelStorage (id, options, callback) {</span>
<span class="cstat-no" title="statement not covered" >    Storage.call(this);</span>
<span class="cstat-no" title="statement not covered" >    this.options = options;</span>
<span class="cstat-no" title="statement not covered" >    this._host = null; </span>// will be set by the Host
<span class="cstat-no" title="statement not covered" >    this.db = options.db;</span>
<span class="cstat-no" title="statement not covered" >    this._id = id;</span>
<span class="cstat-no" title="statement not covered" >    this.filename = null;</span>
<span class="cstat-no" title="statement not covered" >    if (this.db.constructor===Function) {</span>
<span class="cstat-no" title="statement not covered" >        this.db = this.db(options.path||id);</span>
    }
<span class="cstat-no" title="statement not covered" >    this.logtails = {};</span>
}
LevelStorage.prototype = new Storage();
module.exports = LevelStorage;
LevelStorage.prototype.isRoot = env.isServer;
&nbsp;
LevelStorage.prototype.open = <span class="fstat-no" title="function not covered" >function (callback) {</span>
<span class="cstat-no" title="statement not covered" >    this.db.open(this.options.dbOptions||{}, callback);</span>
};
&nbsp;
LevelStorage.prototype.writeState = <span class="fstat-no" title="function not covered" >function (spec, state, cb) {</span>
<span class="cstat-no" title="statement not covered" >    console.log('&gt;STATE',state);</span>
<span class="cstat-no" title="statement not covered" >    var self = this;</span>
<span class="cstat-no" title="statement not covered" >    var ti = spec.filter('/#');</span>
    //var save = JSON.stringify(state, undefined, 2);
<span class="cstat-no" title="statement not covered" >    if (!self.db) {</span>
<span class="cstat-no" title="statement not covered" >        console.warn('the storage is not open', this._host&amp;&amp;this._host._id);</span>
<span class="cstat-no" title="statement not covered" >        return;</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    var json = JSON.stringify(state);</span>
<span class="cstat-no" title="statement not covered" >    var cleanup = [], key;</span>
<span class="cstat-no" title="statement not covered" >    if (ti in this.logtails) {</span>
<span class="cstat-no" title="statement not covered" >        while (key = this.logtails[ti].pop()) {</span>
<span class="cstat-no" title="statement not covered" >            cleanup.push({</span>
                key: key,
                type: 'del'
            });
        }
<span class="cstat-no" title="statement not covered" >        delete this.logtails[ti];</span>
    }
<span class="cstat-no" title="statement not covered" >    console.log('&gt;FLUSH',json,cleanup.length);</span>
<span class="cstat-no" title="statement not covered" >    self.db.put(ti, json, <span class="fstat-no" title="function not covered" >function onSave(err) {</span></span>
<span class="cstat-no" title="statement not covered" >        if (!err &amp;&amp; cleanup.length &amp;&amp; self.db) {</span>
<span class="cstat-no" title="statement not covered" >            console.log('&gt;CLEAN',cleanup);</span>
<span class="cstat-no" title="statement not covered" >            self.db.batch(cleanup, <span class="fstat-no" title="function not covered" >function(err){</span></span>
<span class="cstat-no" title="statement not covered" >                err &amp;&amp; console.error('log trimming failed',err);</span>
            });
        }
<span class="cstat-no" title="statement not covered" >        err &amp;&amp; console.error("state write error", err);</span>
<span class="cstat-no" title="statement not covered" >        cb(err);</span>
    });
&nbsp;
};
&nbsp;
LevelStorage.prototype.writeOp = <span class="fstat-no" title="function not covered" >function (spec, value, cb) {</span>
<span class="cstat-no" title="statement not covered" >    var json = JSON.stringify(value);</span>
<span class="cstat-no" title="statement not covered" >    var ti = spec.filter('/#');</span>
<span class="cstat-no" title="statement not covered" >    if (!this.logtails[ti]) {</span>
<span class="cstat-no" title="statement not covered" >        this.logtails[ti] = [];</span>
    }
<span class="cstat-no" title="statement not covered" >    this.logtails[ti].push(spec);</span>
<span class="cstat-no" title="statement not covered" >    console.log('&gt;OP',spec.toString(),json);</span>
<span class="cstat-no" title="statement not covered" >    this.db.put(spec.toString(), json, <span class="fstat-no" title="function not covered" >function (err){</span></span>
<span class="cstat-no" title="statement not covered" >        err &amp;&amp; console.error('op write error',err);</span>
<span class="cstat-no" title="statement not covered" >        cb(err);</span>
    });
};
&nbsp;
&nbsp;
LevelStorage.prototype.readState = <span class="fstat-no" title="function not covered" >function (ti, callback) {</span>
<span class="cstat-no" title="statement not covered" >    var self = this;</span>
<span class="cstat-no" title="statement not covered" >    ti = ti.toString();</span>
<span class="cstat-no" title="statement not covered" >    this.db.get(ti, {asBuffer:false}, <span class="fstat-no" title="function not covered" >function(err,value){</span></span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        var notFound = err &amp;&amp; /^NotFound/.test(err.message);</span>
<span class="cstat-no" title="statement not covered" >        if (err &amp;&amp; !notFound) { <span class="cstat-no" title="statement not covered" >return callback(err); </span>}</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        if ((err &amp;&amp; notFound) || !value) {</span>
<span class="cstat-no" title="statement not covered" >            err = null;</span>
<span class="cstat-no" title="statement not covered" >            value = {_version: '!0'};</span>
        } else {
<span class="cstat-no" title="statement not covered" >            value = JSON.parse(value);</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        console.log('&lt;STATE',self._host &amp;&amp; self._host._id,value);</span>
<span class="cstat-no" title="statement not covered" >        callback(err, value);</span>
    });
};
&nbsp;
&nbsp;
LevelStorage.prototype.readOps = <span class="fstat-no" title="function not covered" >function (ti, callback) {</span>
<span class="cstat-no" title="statement not covered" >    var self = this;</span>
<span class="cstat-no" title="statement not covered" >    var tail = {}, log = [];</span>
<span class="cstat-no" title="statement not covered" >    var i = this.db.iterator({</span>
        gt: ti+' ',
        lt: ti+'0'
    });
<span class="cstat-no" title="statement not covered" >    i.next(<span class="fstat-no" title="function not covered" >function recv(err,key,value){</span></span>
<span class="cstat-no" title="statement not covered" >        if (err) {</span>
<span class="cstat-no" title="statement not covered" >            callback(err);</span>
<span class="cstat-no" title="statement not covered" >            i.end(<span class="fstat-no" title="function not covered" >function(err){</span>});</span>
        } else <span class="cstat-no" title="statement not covered" >if (key) {</span>
<span class="cstat-no" title="statement not covered" >            var spec = new Spec(key);</span>
<span class="cstat-no" title="statement not covered" >            var vo = spec.filter('!.');</span>
<span class="cstat-no" title="statement not covered" >            tail[vo] = JSON.parse(value.toString());</span>
<span class="cstat-no" title="statement not covered" >            log.push(vo);</span>
<span class="cstat-no" title="statement not covered" >            i.next(recv);</span>
        } else {
<span class="cstat-no" title="statement not covered" >            console.log('&lt;TAIL',self._host &amp;&amp; self._host._id,tail);</span>
<span class="cstat-no" title="statement not covered" >            self.logtails[ti] = ti in self.logtails ?</span>
                self.logtails[ti].concat(log) : log;
<span class="cstat-no" title="statement not covered" >            callback(null, tail);</span>
<span class="cstat-no" title="statement not covered" >            i.end(<span class="fstat-no" title="function not covered" >function(err){</span></span>
<span class="cstat-no" title="statement not covered" >                err &amp;&amp; console.error("can't close an iter",err);</span>
            });
        }
    });
};
&nbsp;
LevelStorage.prototype.off = <span class="fstat-no" title="function not covered" >function (spec,val,src) {</span>
<span class="cstat-no" title="statement not covered" >    var ti = spec.filter('/#');</span>
<span class="cstat-no" title="statement not covered" >    delete this.logtails[ti];</span>
<span class="cstat-no" title="statement not covered" >    Storage.prototype.off.call(this,spec,val,src);</span>
};
&nbsp;
LevelStorage.prototype.close = <span class="fstat-no" title="function not covered" >function (callback,error) {</span> // FIXME
<span class="cstat-no" title="statement not covered" >    if (error) {</span>
<span class="cstat-no" title="statement not covered" >        console.log("fatal IO error", error);</span>
    }
<span class="cstat-no" title="statement not covered" >    if (this.db) {</span>
<span class="cstat-no" title="statement not covered" >        this.db.close(callback);</span>
<span class="cstat-no" title="statement not covered" >        this.db = null;</span>
    } else {
<span class="cstat-no" title="statement not covered" >        callback(); </span>// closed already
    }
};
&nbsp;
/*
process.on('uncaughtException', function(err) {
    CLOSE ALL DATABASES
});
*/
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/LongSpec.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/LongSpec.js</span></h1>
    <h2>
        
        Statements: <span class="metric">10.26% <small>(35 / 341)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 163)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 26)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">10.64% <small>(35 / 329)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/node_modules/swarm/lib/</a> &#187; LongSpec.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
&nbsp;
var Spec = require('./Spec');
&nbsp;
/**LongSpec is a Long Specifier, i.e. a string of quant+id tokens that may be
 * indeed very (many megabytes) long.  Ids are compressed using
 * dynamic dictionaries (codebooks) or "unicode numbers" (base-32768
 * encoding utilizing Unicode symbols as quasi-binary).  Unicode
 * numbers are particularly handy for encoding timestamps.  LongSpecs
 * may be assigned shared codebooks (2nd parameter); a codebook is an
 * object containing encode/decode tables and some stats, e.g.
 * {en:{'/Type':'/T'}, de:{'/T':'/Type'}}. It is OK to pass an empty object as
 * a codebook; it gets initialized automatically).  */
var LongSpec = <span class="fstat-no" title="function not covered" >function (spec, codeBook) {</span>
<span class="cstat-no" title="statement not covered" >    var cb = this.codeBook = codeBook || {en:{},de:{}};</span>
<span class="cstat-no" title="statement not covered" >    if (!cb.en) { <span class="cstat-no" title="statement not covered" >cb.en = {}; </span>}</span>
<span class="cstat-no" title="statement not covered" >    if (!cb.de) { // revert en to make de</span>
<span class="cstat-no" title="statement not covered" >        cb.de = {};</span>
<span class="cstat-no" title="statement not covered" >        for(var tok in cb.en) {</span>
<span class="cstat-no" title="statement not covered" >            cb.de[cb.en[tok]] = tok;</span>
        }
    }
<span class="cstat-no" title="statement not covered" >    if (!cb.lastCodes) {</span>
<span class="cstat-no" title="statement not covered" >        cb.lastCodes = {'/':0x30,'#':0x30,'!':0x30,'.':0x30,'+':0x30};</span>
    }
    // For a larger document, a single LongSpec may be some megabytes long.
    // As we don't want to rewrite those megabytes on every keypress, we
    // divide data into chunks.
<span class="cstat-no" title="statement not covered" >    this.chunks = [];</span>
<span class="cstat-no" title="statement not covered" >    this.chunkLengths = [];</span>
<span class="cstat-no" title="statement not covered" >    if (spec) {</span>
<span class="cstat-no" title="statement not covered" >        this.append(spec);</span>
    }
};
&nbsp;
LongSpec.reQTokEn = /([/#\!\.\+])([0-\u802f]+)/g;
LongSpec.reQTok = new RegExp('([/#\\.!\\*\\+])(=)'.replace(/=/g, Spec.rT), 'g');
LongSpec.rTEn = '[0-\\u802f]+';
LongSpec.reQTokExtEn = new RegExp
    ('([/#\\.!\\*])((=)(?:\\+(=))?)'.replace(/=/g, LongSpec.rTEn), 'g');
&nbsp;
/** Well, for many-MB LongSpecs this may take some time. */
LongSpec.prototype.toString = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >    var ret = [];</span>
<span class="cstat-no" title="statement not covered" >    for(var i = this.iterator(); !i.end(); i.next()){</span>
<span class="cstat-no" title="statement not covered" >        ret.push(i.decode());</span>
    }
<span class="cstat-no" title="statement not covered" >    return ret.join('');</span>
};
&nbsp;
LongSpec.prototype.length = <span class="fstat-no" title="function not covered" >function () {</span> // TODO .length ?
<span class="cstat-no" title="statement not covered" >    var len = 0;</span>
<span class="cstat-no" title="statement not covered" >    for(var i=0; i&lt;this.chunks.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >        len += this.chunkLengths[i];</span>
    }
<span class="cstat-no" title="statement not covered" >    return len;</span>
};
&nbsp;
LongSpec.prototype.charLength = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >    var len = 0;</span>
<span class="cstat-no" title="statement not covered" >    for(var i=0; i&lt;this.chunks.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >        len += this.chunks[i].length;</span>
    }
<span class="cstat-no" title="statement not covered" >    return len;</span>
};
&nbsp;
//   T O K E N  C O M P R E S S I O N
&nbsp;
LongSpec.prototype.allocateCode = <span class="fstat-no" title="function not covered" >function (tok) {</span>
<span class="cstat-no" title="statement not covered" >    var quant = tok.charAt(0);</span>
    //if (Spec.quants.indexOf(quant)===-1) {throw new Error('invalid token');}
<span class="cstat-no" title="statement not covered" >    var en, cb = this.codeBook, lc = cb.lastCodes;</span>
<span class="cstat-no" title="statement not covered" >    if (lc[quant]&lt;'z'.charCodeAt(0)) { // pick a nice letter</span>
<span class="cstat-no" title="statement not covered" >        for(var i=1; !en &amp;&amp; i&lt;tok.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >            var x = tok.charAt(i), e = quant+x;</span>
<span class="cstat-no" title="statement not covered" >            if (!cb.de[e]) {  <span class="cstat-no" title="statement not covered" >en = e; </span> }</span>
        }
    }
<span class="cstat-no" title="statement not covered" >    while (!en &amp;&amp; lc[quant]&lt;0x802f) {</span>
<span class="cstat-no" title="statement not covered" >        var y = String.fromCharCode(lc[quant]++);</span>
<span class="cstat-no" title="statement not covered" >        var mayUse = quant + y;</span>
<span class="cstat-no" title="statement not covered" >        if ( ! cb.en[mayUse] ) {  <span class="cstat-no" title="statement not covered" >en = mayUse; </span> }</span>
    }
<span class="cstat-no" title="statement not covered" >    if (!en) {</span>
<span class="cstat-no" title="statement not covered" >        if (tok.length&lt;=3) {</span>
<span class="cstat-no" title="statement not covered" >            throw new Error("out of codes");</span>
        }
<span class="cstat-no" title="statement not covered" >        en = tok;</span>
    }
<span class="cstat-no" title="statement not covered" >    cb.en[tok] = en;</span>
<span class="cstat-no" title="statement not covered" >    cb.de[en] = tok;</span>
<span class="cstat-no" title="statement not covered" >    return en;</span>
};
&nbsp;
//  F O R M A T  C O N V E R S I O N
&nbsp;
&nbsp;
/** Always 2-char base2^15 coding for an int (0...2^30-1) */
LongSpec.int2uni = <span class="fstat-no" title="function not covered" >function (i) {</span>
<span class="cstat-no" title="statement not covered" >    if (i&lt;0 || i&gt;0x7fffffff) { <span class="cstat-no" title="statement not covered" >throw new Error('int is out of range'); </span>}</span>
<span class="cstat-no" title="statement not covered" >    return String.fromCharCode( 0x30+(i&gt;&gt;15), 0x30+(i&amp;0x7fff) );</span>
};
&nbsp;
LongSpec.uni2int = <span class="fstat-no" title="function not covered" >function (uni) {</span>
<span class="cstat-no" title="statement not covered" >    if (!/^[0-\u802f]{2}$/.test(uni)) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error('invalid unicode number') ;</span>
    }
<span class="cstat-no" title="statement not covered" >    return ((uni.charCodeAt(0)-0x30)&lt;&lt;15) | (uni.charCodeAt(1)-0x30);</span>
};
&nbsp;
//  I T E R A T O R S
&nbsp;
/*  Unfortunately, LongSpec cannot be made a simple array because tokens are
    not fixed-width in the general case. Some tokens are dictionary-encoded
    into two-symbol segments, e.g. ".on" --&gt; ".o". Other tokens may need 6
    symbols to encode, e.g. "!timstse+author~ssn" -&gt; "!tss+a".
    Also, iterators opportuniatically use sequential compression. Namely,
    tokens that differ by +1 are collapsed into quant-only sequences:
    "!abc+s!abd+s" -&gt; "!abc+s!"
    So, locating and iterating becomes less-than-trivial. Raw string offsets
    better not be exposed in the external interface; hence, we need iterators.
&nbsp;
    {
        offset:5,       // char offset in the string (chunk)
        index:1,        // index of the entry (token)
        en: "!",        // the actual matched token (encoded)
        chunk:0,        // index of the chunk
        de: "!timst00+author~ssn", // decoded token
        seqstart: "!ts0+a", // first token of the sequence (encoded)
        seqoffset: 3    // offset in the sequence
    }
*/
LongSpec.Iterator = <span class="fstat-no" title="function not covered" >function Iterator (owner, index) {</span>
<span class="cstat-no" title="statement not covered" >    this.owner = owner; </span>        // our LongSpec
    /*this.chunk = 0;             // the chunk we are in
    this.index = -1;            // token index (position "before the 1st token")
    this.chunkIndex = -1;       // token index within the chunk
    this.prevFull = undefined;  // previous full (non-collapsed) token
    //  seqStart IS the previous match or prev match is trivial
    this.prevCollapsed = 0;
    this.match = null;
    //this.next();*/
<span class="cstat-no" title="statement not covered" >    this.skip2chunk(0);</span>
<span class="cstat-no" title="statement not covered" >    if (index) {</span>
<span class="cstat-no" title="statement not covered" >        if (index.constructor===LongSpec.Iterator) {</span>
<span class="cstat-no" title="statement not covered" >            index = index.index;</span>
        }
<span class="cstat-no" title="statement not covered" >        this.skip(index);</span>
    }
};
&nbsp;
&nbsp;
// also matches collapsed quant-only tokens
LongSpec.Iterator.reTok = new RegExp
    ('([/#\\.!\\*])((=)(?:\\+(=))?)?'.replace(/=/g, LongSpec.rTEn), 'g');
&nbsp;
&nbsp;
/* The method converts a (relatively) verbose Base64 specifier into an
 * internal compressed format.  Compressed tokens are also
 * variable-length; the length of the token depends on the encoding
 * method used.
 * 1 unicode symbol: dictionary-encoded (up to 2^15 entries for each quant),
 * 2 symbols: simple timestamp base-2^15 encoded,
 * 3 symbols: timestamp+seq base-2^15,
 * 4 symbols: long-number base-2^15,
 * 5 symbols and more: unencoded original (fallback).
 * As long as two sequential unicoded entries differ by +1 in the body
 * of the token (quant and extension being the same), we use sequential
 * compression. The token is collapsed (only the quant is left).
 * */
LongSpec.Iterator.prototype.encode = <span class="fstat-no" title="function not covered" >function encode (de) {</span>
<span class="cstat-no" title="statement not covered" >    var re = Spec.reQTokExt;</span>
<span class="cstat-no" title="statement not covered" >    re.lastIndex = 0;</span>
<span class="cstat-no" title="statement not covered" >    var m=re.exec(de); </span>// this one is de
<span class="cstat-no" title="statement not covered" >    if (!m || m[0].length!==de.length) {<span class="cstat-no" title="statement not covered" >throw new Error('malformed token: '+de);}</span></span>
<span class="cstat-no" title="statement not covered" >    var tok=m[0], quant=m[1], body=m[3], ext=m[4];</span>
<span class="cstat-no" title="statement not covered" >    var pm = this.prevFull; </span>// this one is en
<span class="cstat-no" title="statement not covered" >    var prevTok, prevQuant, prevBody, prevExt;</span>
<span class="cstat-no" title="statement not covered" >    var enBody, enExt;</span>
<span class="cstat-no" title="statement not covered" >    if (pm) {</span>
<span class="cstat-no" title="statement not covered" >        prevTok=pm[0], prevQuant=pm[1], prevBody=pm[3], prevExt=pm[4]?'+'+pm[4]:undefined;</span>
    }
<span class="cstat-no" title="statement not covered" >    if (ext) {</span>
<span class="cstat-no" title="statement not covered" >        enExt = this.owner.codeBook.en['+'+ext] || this.owner.allocateCode('+'+ext);</span>
    }
<span class="cstat-no" title="statement not covered" >    var maySeq = pm &amp;&amp; quant===prevQuant &amp;&amp; enExt===prevExt;</span>
<span class="cstat-no" title="statement not covered" >    var haveSeq=false, seqBody = '';</span>
<span class="cstat-no" title="statement not covered" >    var int1, int2, uni1, uni2;</span>
    //var expected = head + (counter===-1?'':Spec.int2base(counter+inc,1)) + tail;
<span class="cstat-no" title="statement not covered" >    if ( body.length&lt;=4 ||          // TODO make it a switch</span>
         (quant in LongSpec.quants2code) ||
         (tok in this.owner.codeBook.en) ) {  // 1 symbol by the codebook
&nbsp;
<span class="cstat-no" title="statement not covered" >        enBody = this.owner.codeBook.en[quant+body] ||</span>
                 this.owner.allocateCode(quant+body);
<span class="cstat-no" title="statement not covered" >        enBody = enBody.substr(1); </span>// FIXME separate codebooks 4 quants
<span class="cstat-no" title="statement not covered" >        if (maySeq) {// seq coding for dictionary-coded</span>
<span class="cstat-no" title="statement not covered" >            seqBody = enBody;</span>
        }
    } else <span class="cstat-no" title="statement not covered" >if (body.length===5) { // 2-symbol base-2^15</span>
<span class="cstat-no" title="statement not covered" >        var int = Spec.base2int(body);</span>
<span class="cstat-no" title="statement not covered" >        enBody = LongSpec.int2uni(int);</span>
<span class="cstat-no" title="statement not covered" >        if (maySeq &amp;&amp; prevBody.length===2) {</span>
<span class="cstat-no" title="statement not covered" >            seqBody = LongSpec.int2uni(int-this.prevCollapsed-1);</span>
        }
    } else <span class="cstat-no" title="statement not covered" >if (body.length===7) { // 3-symbol base-2^15</span>
<span class="cstat-no" title="statement not covered" >        int1 = Spec.base2int(body.substr(0,5));</span>
<span class="cstat-no" title="statement not covered" >        int2 = Spec.base2int(body.substr(5,2));</span>
<span class="cstat-no" title="statement not covered" >        uni1 = LongSpec.int2uni(int1);</span>
<span class="cstat-no" title="statement not covered" >        uni2 = LongSpec.int2uni(int2).charAt(1);</span>
<span class="cstat-no" title="statement not covered" >        enBody = uni1 + uni2;</span>
<span class="cstat-no" title="statement not covered" >        if (maySeq &amp;&amp; prevBody.length===3) {</span>
<span class="cstat-no" title="statement not covered" >            seqBody = uni1 + LongSpec.int2uni(int2-this.prevCollapsed-1).charAt(1);</span>
        }
    } else <span class="cstat-no" title="statement not covered" >if (body.length===10) { // 4-symbol 60-bit long number</span>
<span class="cstat-no" title="statement not covered" >        int1 = Spec.base2int(body.substr(0,5));</span>
<span class="cstat-no" title="statement not covered" >        int2 = Spec.base2int(body.substr(5,5));</span>
<span class="cstat-no" title="statement not covered" >        uni1 = LongSpec.int2uni(int1);</span>
<span class="cstat-no" title="statement not covered" >        uni2 = LongSpec.int2uni(int2);</span>
<span class="cstat-no" title="statement not covered" >        enBody = uni1 + uni2;</span>
<span class="cstat-no" title="statement not covered" >        if (maySeq &amp;&amp; prevBody.length===4) {</span>
<span class="cstat-no" title="statement not covered" >            seqBody = uni1+LongSpec.int2uni(int2-this.prevCollapsed-1);</span>
        }
    } else { // verbatim
<span class="cstat-no" title="statement not covered" >        enBody = body;</span>
<span class="cstat-no" title="statement not covered" >        seqBody = enBody;</span>
    }
<span class="cstat-no" title="statement not covered" >    haveSeq = seqBody===prevBody;</span>
<span class="cstat-no" title="statement not covered" >    return haveSeq ? quant : quant+enBody+(enExt||'');</span>
};
LongSpec.quants2code = {'/':1,'.':1};
&nbsp;
/** Decode a compressed specifier back into base64. */
LongSpec.Iterator.prototype.decode = <span class="fstat-no" title="function not covered" >function decode () {</span>
<span class="cstat-no" title="statement not covered" >    if (this.match===null) { <span class="cstat-no" title="statement not covered" >return undefined; </span>}</span>
<span class="cstat-no" title="statement not covered" >    var quant = this.match[1];</span>
<span class="cstat-no" title="statement not covered" >    var body = this.match[3];</span>
<span class="cstat-no" title="statement not covered" >    var ext = this.match[4];</span>
<span class="cstat-no" title="statement not covered" >    var pm=this.prevFull, prevTok, prevQuant, prevBody, prevExt;</span>
<span class="cstat-no" title="statement not covered" >    var int1, int2, base1, base2;</span>
<span class="cstat-no" title="statement not covered" >    var de = quant;</span>
<span class="cstat-no" title="statement not covered" >    if (pm) {</span>
<span class="cstat-no" title="statement not covered" >        prevTok=pm[0], prevQuant=pm[1], prevBody=pm[3], prevExt=pm[4];</span>
    }
<span class="cstat-no" title="statement not covered" >    if (!body) {</span>
<span class="cstat-no" title="statement not covered" >        if (prevBody.length===1) {</span>
<span class="cstat-no" title="statement not covered" >            body = prevBody;</span>
        } else {
<span class="cstat-no" title="statement not covered" >            var l_1 = prevBody.length-1;</span>
<span class="cstat-no" title="statement not covered" >            var int = prevBody.charCodeAt(l_1);</span>
<span class="cstat-no" title="statement not covered" >            body = prevBody.substr(0,l_1) + String.fromCharCode(int+this.prevCollapsed+1);</span>
        }
<span class="cstat-no" title="statement not covered" >        ext = prevExt;</span>
    }
<span class="cstat-no" title="statement not covered" >    switch (body.length) {</span>
        case 1:
<span class="cstat-no" title="statement not covered" >            de += this.owner.codeBook.de[quant+body].substr(1); </span>// TODO sep codebooks
<span class="cstat-no" title="statement not covered" >            break;</span>
        case 2:
<span class="cstat-no" title="statement not covered" >            int1 = LongSpec.uni2int(body);</span>
<span class="cstat-no" title="statement not covered" >            base1 = Spec.int2base(int1,5);</span>
<span class="cstat-no" title="statement not covered" >            de += base1;</span>
<span class="cstat-no" title="statement not covered" >            break;</span>
        case 3:
<span class="cstat-no" title="statement not covered" >            int1 = LongSpec.uni2int(body.substr(0,2));</span>
<span class="cstat-no" title="statement not covered" >            int2 = LongSpec.uni2int('0'+body.charAt(2));</span>
<span class="cstat-no" title="statement not covered" >            base1 = Spec.int2base(int1,5);</span>
<span class="cstat-no" title="statement not covered" >            base2 = Spec.int2base(int2,2);</span>
<span class="cstat-no" title="statement not covered" >            de += base1 + base2;</span>
<span class="cstat-no" title="statement not covered" >            break;</span>
        case 4:
<span class="cstat-no" title="statement not covered" >            int1 = LongSpec.uni2int(body.substr(0,2));</span>
<span class="cstat-no" title="statement not covered" >            int2 = LongSpec.uni2int(body.substr(2,2));</span>
<span class="cstat-no" title="statement not covered" >            base1 = Spec.int2base(int1,5);</span>
<span class="cstat-no" title="statement not covered" >            base2 = Spec.int2base(int2,5);</span>
<span class="cstat-no" title="statement not covered" >            de += base1 + base2;</span>
<span class="cstat-no" title="statement not covered" >            break;</span>
        default:
<span class="cstat-no" title="statement not covered" >            de += body;</span>
<span class="cstat-no" title="statement not covered" >            break;</span>
    }
<span class="cstat-no" title="statement not covered" >    if (ext) {</span>
<span class="cstat-no" title="statement not covered" >        var deExt = this.owner.codeBook.de['+'+ext];</span>
<span class="cstat-no" title="statement not covered" >        de += deExt;</span>
    }
<span class="cstat-no" title="statement not covered" >    return de;</span>
};
&nbsp;
&nbsp;
LongSpec.Iterator.prototype.next = <span class="fstat-no" title="function not covered" >function ( ) {</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (this.end()) {<span class="cstat-no" title="statement not covered" >return;}</span></span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    var re = LongSpec.Iterator.reTok;</span>
<span class="cstat-no" title="statement not covered" >    re.lastIndex = this.match ? this.match.index+this.match[0].length : 0;</span>
<span class="cstat-no" title="statement not covered" >    var chunk = this.owner.chunks[this.chunk];</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (chunk.length===re.lastIndex) {</span>
<span class="cstat-no" title="statement not covered" >        this.chunk++;</span>
<span class="cstat-no" title="statement not covered" >        this.chunkIndex = 0;</span>
<span class="cstat-no" title="statement not covered" >        if (this.match &amp;&amp; this.match[0].length&gt;0) {</span>
<span class="cstat-no" title="statement not covered" >            this.prevFull = this.match;</span>
<span class="cstat-no" title="statement not covered" >            this.prevCollapsed = 0;</span>
        } else <span class="cstat-no" title="statement not covered" >if (this.match) {</span>
<span class="cstat-no" title="statement not covered" >            this.prevCollapsed++;</span>
        } else { // empty
<span class="cstat-no" title="statement not covered" >            this.prevFull = undefined;</span>
<span class="cstat-no" title="statement not covered" >            this.prevCollapsed = 0;</span>
        }
<span class="cstat-no" title="statement not covered" >        this.match = null;</span>
<span class="cstat-no" title="statement not covered" >        this.index ++;</span>
<span class="cstat-no" title="statement not covered" >        if (this.end()) {<span class="cstat-no" title="statement not covered" >return;}</span></span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (this.match[0].length&gt;1) {</span>
<span class="cstat-no" title="statement not covered" >        this.prevFull = this.match;</span>
<span class="cstat-no" title="statement not covered" >        this.prevCollapsed = 0;</span>
    } else {
<span class="cstat-no" title="statement not covered" >        this.prevCollapsed++;</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    this.match = re.exec(chunk);</span>
<span class="cstat-no" title="statement not covered" >    this.index++;</span>
<span class="cstat-no" title="statement not covered" >    this.chunkIndex++;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    return this.match[0];</span>
};
&nbsp;
&nbsp;
LongSpec.Iterator.prototype.end = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >    return this.match===null &amp;&amp; this.chunk===this.owner.chunks.length;</span>
};
&nbsp;
&nbsp;
LongSpec.Iterator.prototype.skip = <span class="fstat-no" title="function not covered" >function ( count ) {</span>
    // TODO may implement fast-skip of seq-compressed spans
<span class="cstat-no" title="statement not covered" >    var lengths = this.owner.chunkLengths, chunks = this.owner.chunks;</span>
<span class="cstat-no" title="statement not covered" >    count = count || 1;</span>
<span class="cstat-no" title="statement not covered" >    var left = count;</span>
<span class="cstat-no" title="statement not covered" >    var leftInChunk = lengths[this.chunk]-this.chunkIndex;</span>
<span class="cstat-no" title="statement not covered" >    if ( leftInChunk &lt;= count ) { // skip chunks</span>
<span class="cstat-no" title="statement not covered" >        left -= leftInChunk; </span>// skip the current chunk
<span class="cstat-no" title="statement not covered" >        var c=this.chunk+1; </span>   // how many extra chunks to skip
<span class="cstat-no" title="statement not covered" >        while (left&gt;chunks[c] &amp;&amp; c&lt;chunks.length) {</span>
<span class="cstat-no" title="statement not covered" >            left-=chunks[++c];</span>
        }
<span class="cstat-no" title="statement not covered" >        this.skip2chunk(c);</span>
    }
<span class="cstat-no" title="statement not covered" >    if (this.chunk&lt;chunks.length) {</span>
<span class="cstat-no" title="statement not covered" >        while (left&gt;0) {</span>
<span class="cstat-no" title="statement not covered" >            this.next();</span>
<span class="cstat-no" title="statement not covered" >            left--;</span>
        }
    }
<span class="cstat-no" title="statement not covered" >    return count - left;</span>
};
&nbsp;
/** Irrespectively of the current state of the iterator moves it to the
  * first token in the chunk specified; chunk===undefined moves it to
  * the end() position (one after the last token). */
LongSpec.Iterator.prototype.skip2chunk = <span class="fstat-no" title="function not covered" >function ( chunk ) {</span>
<span class="cstat-no" title="statement not covered" >    var chunks = this.owner.chunks;</span>
<span class="cstat-no" title="statement not covered" >    if (chunk===undefined) {<span class="cstat-no" title="statement not covered" >chunk=chunks.length;}</span></span>
<span class="cstat-no" title="statement not covered" >    this.index = 0;</span>
<span class="cstat-no" title="statement not covered" >    for(var c=0; c&lt;chunk; c++) { // TODO perf pick the current value</span>
<span class="cstat-no" title="statement not covered" >        this.index += this.owner.chunkLengths[c];</span>
    }
<span class="cstat-no" title="statement not covered" >    this.chunkIndex = 0;</span>
<span class="cstat-no" title="statement not covered" >    this.chunk = chunk;</span>
<span class="cstat-no" title="statement not covered" >    var re = LongSpec.Iterator.reTok;</span>
<span class="cstat-no" title="statement not covered" >    if ( chunk &lt; chunks.length ) {</span>
<span class="cstat-no" title="statement not covered" >        re.lastIndex = 0;</span>
<span class="cstat-no" title="statement not covered" >        this.match = re.exec(chunks[this.chunk]);</span>
    } else {
<span class="cstat-no" title="statement not covered" >        this.match = null;</span>
    }
<span class="cstat-no" title="statement not covered" >    if (chunk&gt;0) { // (1) chunks must not be empty; (2) a chunk starts with a full token</span>
<span class="cstat-no" title="statement not covered" >        var prev = chunks[chunk-1];</span>
<span class="cstat-no" title="statement not covered" >        var j = 0;</span>
<span class="cstat-no" title="statement not covered" >        while (Spec.quants.indexOf(prev.charAt(prev.length-1-j)) !== -1) { <span class="cstat-no" title="statement not covered" >j++; </span>}</span>
<span class="cstat-no" title="statement not covered" >        this.prevCollapsed = j;</span>
<span class="cstat-no" title="statement not covered" >        var k = 0;</span>
<span class="cstat-no" title="statement not covered" >        while (Spec.quants.indexOf(prev.charAt(prev.length-1-j-k))===-1) { <span class="cstat-no" title="statement not covered" >k++; </span>}</span>
<span class="cstat-no" title="statement not covered" >        re.lastIndex = prev.length-1-j-k;</span>
<span class="cstat-no" title="statement not covered" >        this.prevFull = re.exec(prev);</span>
    } else {
<span class="cstat-no" title="statement not covered" >        this.prevFull = undefined;</span>
<span class="cstat-no" title="statement not covered" >        this.prevCollapsed = 0;</span>
    }
};
&nbsp;
LongSpec.Iterator.prototype.token = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >    return this.decode();</span>
};
&nbsp;
/*LongSpec.Iterator.prototype.de = function () {
    if (this.match===null) {return undefined;}
    return this.owner.decode(this.match[0],this.prevFull?this.prevFull[0]:undefined,this.prevCollapsed);
};*/
&nbsp;
/*LongSpec.Iterator.prototype.insertDe = function (de) {
    var en = this.owner.encode(de,this.prevFull?this.prevFull[0]:undefined,this.prevCollapsed);
    this.insert(en);
};*/
&nbsp;
&nbsp;
/** As sequential coding is incapsulated in LongSpec.Iterator, inserts are
  * done by Iterator as well. */
LongSpec.Iterator.prototype.insert = <span class="fstat-no" title="function not covered" >function (de) {</span> // insertBefore
&nbsp;
<span class="cstat-no" title="statement not covered" >    var insStr = this.encode(de);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    var brokenSeq = this.match &amp;&amp; this.match[0].length===1;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    var re = LongSpec.Iterator.reTok;</span>
<span class="cstat-no" title="statement not covered" >    var chunks = this.owner.chunks, lengths = this.owner.chunkLengths;</span>
<span class="cstat-no" title="statement not covered" >    if (this.chunk==chunks.length) { // end(), append</span>
<span class="cstat-no" title="statement not covered" >        if (chunks.length&gt;0) {</span>
<span class="cstat-no" title="statement not covered" >            var ind = this.chunk - 1;</span>
<span class="cstat-no" title="statement not covered" >            chunks[ind] += insStr;</span>
<span class="cstat-no" title="statement not covered" >            lengths[ind] ++;</span>
        } else {
<span class="cstat-no" title="statement not covered" >            chunks.push(insStr);</span>
<span class="cstat-no" title="statement not covered" >            lengths.push(1);</span>
<span class="cstat-no" title="statement not covered" >            this.chunk++;</span>
        }
    } else {
<span class="cstat-no" title="statement not covered" >        var chunkStr = chunks[this.chunk];</span>
<span class="cstat-no" title="statement not covered" >        var preEq = chunkStr.substr(0, this.match.index);</span>
<span class="cstat-no" title="statement not covered" >        var postEq = chunkStr.substr(this.match.index);</span>
<span class="cstat-no" title="statement not covered" >        if (brokenSeq) {</span>
<span class="cstat-no" title="statement not covered" >            var me = this.token();</span>
<span class="cstat-no" title="statement not covered" >            this.prevFull = undefined;</span>
<span class="cstat-no" title="statement not covered" >            var en = this.encode(me);</span>
<span class="cstat-no" title="statement not covered" >            chunks[this.chunk] = preEq + insStr + en + postEq.substr(1);</span>
<span class="cstat-no" title="statement not covered" >            re.lastIndex = preEq.length + insStr.length;</span>
<span class="cstat-no" title="statement not covered" >            this.match = re.exec(chunks[this.chunk]);</span>
        } else {
<span class="cstat-no" title="statement not covered" >            chunks[this.chunk] = preEq + insStr + /**/ postEq;</span>
<span class="cstat-no" title="statement not covered" >            this.match.index += insStr.length;</span>
        }
<span class="cstat-no" title="statement not covered" >        lengths[this.chunk] ++;</span>
<span class="cstat-no" title="statement not covered" >        this.chunkIndex ++;</span>
    }
<span class="cstat-no" title="statement not covered" >    this.index ++;</span>
<span class="cstat-no" title="statement not covered" >    if (insStr.length&gt;1) {</span>
<span class="cstat-no" title="statement not covered" >        re.lastIndex = 0;</span>
<span class="cstat-no" title="statement not covered" >        this.prevFull = re.exec(insStr);</span>
<span class="cstat-no" title="statement not covered" >        this.prevCollapsed = 0;</span>
    } else {
<span class="cstat-no" title="statement not covered" >        this.prevCollapsed++;</span>
    }
&nbsp;
    // may split chunks
    // may join chunks
};
&nbsp;
LongSpec.Iterator.prototype.insertBlock = <span class="fstat-no" title="function not covered" >function (de) {</span> // insertBefore
<span class="cstat-no" title="statement not covered" >    var re = Spec.reQTokExt;</span>
<span class="cstat-no" title="statement not covered" >    var toks = de.match(re).reverse(), tok;</span>
<span class="cstat-no" title="statement not covered" >    while (tok=toks.pop()) {</span>
<span class="cstat-no" title="statement not covered" >        this.insert(tok);</span>
    }
};
&nbsp;
LongSpec.Iterator.prototype.erase = <span class="fstat-no" title="function not covered" >function (count) {</span>
<span class="cstat-no" title="statement not covered" >    if (this.end()) {<span class="cstat-no" title="statement not covered" >return;}</span></span>
<span class="cstat-no" title="statement not covered" >    count = count || 1;</span>
<span class="cstat-no" title="statement not covered" >    var chunks = this.owner.chunks;</span>
<span class="cstat-no" title="statement not covered" >    var lengths = this.owner.chunkLengths;</span>
    // remember offsets
<span class="cstat-no" title="statement not covered" >    var fromChunk = this.chunk;</span>
<span class="cstat-no" title="statement not covered" >    var fromOffset = this.match.index;</span>
<span class="cstat-no" title="statement not covered" >    var fromChunkIndex = this.chunkIndex; </span>// TODO clone USE 2 iterators or i+c
&nbsp;
<span class="cstat-no" title="statement not covered" >    count = this.skip(count); </span>// checked for runaway skip()
    // the iterator now is at the first-after-erased pos
&nbsp;
<span class="cstat-no" title="statement not covered" >    var tillChunk = this.chunk;</span>
<span class="cstat-no" title="statement not covered" >    var tillOffset = this.match ? this.match.index : 0; </span>// end()
&nbsp;
<span class="cstat-no" title="statement not covered" >    var collapsed = this.match &amp;&amp; this.match[0].length===1;</span>
&nbsp;
    // splice strings, adjust indexes
<span class="cstat-no" title="statement not covered" >    if (fromChunk===tillChunk) {</span>
<span class="cstat-no" title="statement not covered" >        var chunk = chunks[this.chunk];</span>
<span class="cstat-no" title="statement not covered" >        var pre = chunk.substr(0,fromOffset);</span>
<span class="cstat-no" title="statement not covered" >        var post = chunk.substr(tillOffset);</span>
<span class="cstat-no" title="statement not covered" >        if (collapsed) { // sequence is broken now; needs expansion</span>
<span class="cstat-no" title="statement not covered" >            post = this.token() + post.substr(1);</span>
        }
<span class="cstat-no" title="statement not covered" >        chunks[this.chunk] = pre + post;</span>
<span class="cstat-no" title="statement not covered" >        lengths[this.chunk] -= count;</span>
<span class="cstat-no" title="statement not covered" >        this.chunkIndex -= count;</span>
    } else {  // FIXME refac, more tests (+wear)
<span class="cstat-no" title="statement not covered" >        if (fromOffset===0) {</span>
<span class="cstat-no" title="statement not covered" >            fromChunk--;</span>
        } else {
<span class="cstat-no" title="statement not covered" >            chunks[fromChunk] = chunks[fromChunk].substr(0,fromOffset);</span>
<span class="cstat-no" title="statement not covered" >            lengths[fromChunk] = fromChunkIndex;</span>
        }
<span class="cstat-no" title="statement not covered" >        var midChunks = tillChunk - fromChunk - 1;</span>
<span class="cstat-no" title="statement not covered" >        if (midChunks) { // wipe'em out</span>
            //for(var c=fromChunk+1; c&lt;tillChunk; c++) ;
<span class="cstat-no" title="statement not covered" >            chunks.splice(fromChunk+1,midChunks);</span>
<span class="cstat-no" title="statement not covered" >            lengths.splice(fromChunk+1,midChunks);</span>
        }
<span class="cstat-no" title="statement not covered" >        if (tillChunk&lt;chunks.length &amp;&amp; tillOffset&gt;0) {</span>
<span class="cstat-no" title="statement not covered" >            chunks[tillChunk] = chunks[tillChunk].substr(this.match.index);</span>
<span class="cstat-no" title="statement not covered" >            lengths[tillChunk] -= this.chunkIndex;</span>
<span class="cstat-no" title="statement not covered" >            this.chunkIndex = 0;</span>
        }
    }
<span class="cstat-no" title="statement not covered" >    this.index -= count;</span>
&nbsp;
};
&nbsp;
&nbsp;
LongSpec.Iterator.prototype.clone = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >    var copy = new LongSpec.Iterator(this.owner);</span>
<span class="cstat-no" title="statement not covered" >    copy.chunk = this.chunk;</span>
<span class="cstat-no" title="statement not covered" >    copy.match = this.match;</span>
<span class="cstat-no" title="statement not covered" >    copy.index = this.index;</span>
};
&nbsp;
//  L O N G S P E C  A P I
&nbsp;
LongSpec.prototype.iterator = <span class="fstat-no" title="function not covered" >function (index) {</span>
<span class="cstat-no" title="statement not covered" >    return new LongSpec.Iterator(this,index);</span>
};
&nbsp;
LongSpec.prototype.end = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >    var e = new LongSpec.Iterator(this);</span>
<span class="cstat-no" title="statement not covered" >    e.skip2chunk(this.chunks.length);</span>
<span class="cstat-no" title="statement not covered" >    return e;</span>
};
&nbsp;
/** Insert a token at a given position. */
LongSpec.prototype.insert = <span class="fstat-no" title="function not covered" >function (tok, i) {</span>
<span class="cstat-no" title="statement not covered" >    var iter = i.constructor===LongSpec.Iterator ? i : this.iterator(i);</span>
<span class="cstat-no" title="statement not covered" >    iter.insertBlock(tok);</span>
};
&nbsp;
LongSpec.prototype.tokenAt = <span class="fstat-no" title="function not covered" >function (pos) {</span>
<span class="cstat-no" title="statement not covered" >    var iter = this.iterator(pos);</span>
<span class="cstat-no" title="statement not covered" >    return iter.token();</span>
};
&nbsp;
LongSpec.prototype.indexOf = <span class="fstat-no" title="function not covered" >function (tok, startAt) {</span>
<span class="cstat-no" title="statement not covered" >    var iter = this.find(tok,startAt);</span>
<span class="cstat-no" title="statement not covered" >    return iter.end() ? -1 : iter.index;</span>
};
&nbsp;
/*LongSpec.prototype.insertAfter = function (tok, i) {
    LongSpec.reQTokExtEn.lastIndex = i;
    var m = LongSpec.reQTokExtEn.exec(this.value);
    if (m.index!==i) { throw new Error('incorrect position'); }
    var splitAt = i+m[0].length;
    this.insertBefore(tok,splitAt);
};*/
&nbsp;
LongSpec.prototype.add = <span class="fstat-no" title="function not covered" >function ls_add (spec) {</span>
<span class="cstat-no" title="statement not covered" >    var pos = this.end();</span>
<span class="cstat-no" title="statement not covered" >    pos.insertBlock(spec);</span>
};
LongSpec.prototype.append = LongSpec.prototype.add;
&nbsp;
/** The method finds the first occurence of a token, returns an
 * iterator.  While the internal format of an iterator is kind of
 * opaque, and generally is not recommended to rely on, that is
 * actually a regex match array. Note that it contains encoded tokens.
 * The second parameter is the position to start scanning from, passed
 * either as an iterator or an offset. */
LongSpec.prototype.find = <span class="fstat-no" title="function not covered" >function (tok, startIndex) {</span>
    //var en = this.encode(tok).toString(); // don't split on +
<span class="cstat-no" title="statement not covered" >    var i = this.iterator(startIndex);</span>
<span class="cstat-no" title="statement not covered" >    while (!i.end()) {</span>
<span class="cstat-no" title="statement not covered" >        if (i.token()===tok) {</span>
<span class="cstat-no" title="statement not covered" >            return i;</span>
        }
<span class="cstat-no" title="statement not covered" >        i.next();</span>
    }
<span class="cstat-no" title="statement not covered" >    return i;</span>
};
&nbsp;
module.exports = LongSpec;
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/MinutePreciseClock.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/MinutePreciseClock.js</span></h1>
    <h2>
        
        Statements: <span class="metric">18.03% <small>(11 / 61)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 24)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 7)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">20.37% <small>(11 / 54)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/node_modules/swarm/lib/</a> &#187; MinutePreciseClock.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
&nbsp;
var Spec = require('./Spec');
&nbsp;
/** It is not always necessary to have second-precise timestamps.
  * Going with minute-precise allows to fit timestamp values
  * into 30 bits (5 base64, 2 unicode chars).
  * More importantly, such timestamps increase incrementally for
  * short bursts of events (e.g. user typing). That allows
  * for sequence-coding optimizations in LongSpec.
  * In case processes generate more than 64 events a minute,
  * which is not unlikely, the optimization fails as we add
  * 12-bit seq (2 base64, 1 unicode). */
var MinutePreciseClock = <span class="fstat-no" title="function not covered" >function (processId, timeOffsetMs) {</span>
<span class="cstat-no" title="statement not covered" >    if (!Spec.reTok.test(processId)) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error('invalid process id: '+processId);</span>
    }
<span class="cstat-no" title="statement not covered" >    this.id = processId;</span>
    // sometimes we assume our local clock has some offset
<span class="cstat-no" title="statement not covered" >    this.clockOffsetMs = 0;</span>
<span class="cstat-no" title="statement not covered" >    this.lastIssuedTimestamp = '';</span>
    // although we try hard to use wall clock time, we must
    // obey Lamport logical clock rules, in particular our
    // timestamps must be greater than any other timestamps
    // previously seen
<span class="cstat-no" title="statement not covered" >    this.lastTimeSeen = 0;</span>
<span class="cstat-no" title="statement not covered" >    this.lastSeqSeen = 0;</span>
<span class="cstat-no" title="statement not covered" >    if (timeOffsetMs) {</span>
<span class="cstat-no" title="statement not covered" >        this.clockOffsetMs = timeOffsetMs;</span>
    }
};
&nbsp;
var epochDate = new Date("Wed, 01 Jan 2014 00:00:00 GMT");
MinutePreciseClock.EPOCH = epochDate.getTime();
&nbsp;
MinutePreciseClock.prototype.adjustTime = <span class="fstat-no" title="function not covered" >function (trueMs) {</span>
    // TODO use min historical offset
<span class="cstat-no" title="statement not covered" >    var localTime = new Date().getTime();</span>
<span class="cstat-no" title="statement not covered" >    var clockOffsetMs = trueMs - localTime;</span>
<span class="cstat-no" title="statement not covered" >    this.clockOffsetMs = clockOffsetMs;</span>
};
&nbsp;
MinutePreciseClock.prototype.minutes = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >    var millis = new Date().getTime();</span>
<span class="cstat-no" title="statement not covered" >    millis -= MinutePreciseClock.EPOCH;</span>
<span class="cstat-no" title="statement not covered" >    millis += this.clockOffsetMs;</span>
<span class="cstat-no" title="statement not covered" >    return (millis/60000) | 0;</span>
};
&nbsp;
MinutePreciseClock.prototype.issueTimestamp = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >    var time = this.minutes();</span>
<span class="cstat-no" title="statement not covered" >    if (this.lastTimeSeen&gt;time) { <span class="cstat-no" title="statement not covered" >time = this.lastTimeSeen; </span>}</span>
<span class="cstat-no" title="statement not covered" >    if (time&gt;this.lastTimeSeen) { <span class="cstat-no" title="statement not covered" >this.lastSeqSeen = -1; </span>}</span>
<span class="cstat-no" title="statement not covered" >    this.lastTimeSeen = time;</span>
<span class="cstat-no" title="statement not covered" >    var seq = ++this.lastSeqSeen;</span>
<span class="cstat-no" title="statement not covered" >    if (seq&gt;=(1&lt;&lt;18)) {<span class="cstat-no" title="statement not covered" >throw new Error('max event freq is 4000Hz');}</span></span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    var baseTime = Spec.int2base(time, 4), baseSeq;</span>
<span class="cstat-no" title="statement not covered" >    if (seq&lt;64) {</span>
<span class="cstat-no" title="statement not covered" >        baseSeq = Spec.int2base(seq, 1);</span>
    } else {
<span class="cstat-no" title="statement not covered" >        baseSeq = Spec.int2base(seq, 3);</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    this.lastIssuedTimestamp = baseTime + baseSeq + '+' + this.id;</span>
<span class="cstat-no" title="statement not covered" >    return this.lastIssuedTimestamp;</span>
};
&nbsp;
MinutePreciseClock.prototype.parseTimestamp = <span class="fstat-no" title="function not covered" >function parse (ts) {</span>
<span class="cstat-no" title="statement not covered" >    var m = ts.match(Spec.reTokExt);</span>
<span class="cstat-no" title="statement not covered" >    if (!m) {<span class="cstat-no" title="statement not covered" >throw new Error('malformed timestamp: '+ts);}</span></span>
<span class="cstat-no" title="statement not covered" >    var timeseq=m[1]; </span>//, process=m[2];
<span class="cstat-no" title="statement not covered" >    var time = timeseq.substr(0,4), seq = timeseq.substr(4);</span>
<span class="cstat-no" title="statement not covered" >    if (seq.length!==1 &amp;&amp; seq.length!==3) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error('malformed timestamp value: '+timeseq);</span>
    }
<span class="cstat-no" title="statement not covered" >    return {</span>
        time: Spec.base2int(time),
        seq: Spec.base2int(seq)
    };
};
&nbsp;
MinutePreciseClock.prototype.checkTimestamp = <span class="fstat-no" title="function not covered" >function see (ts) {</span>
<span class="cstat-no" title="statement not covered" >    if (ts&lt;this.lastIssuedTimestamp) { <span class="cstat-no" title="statement not covered" >return true; </span>}</span>
<span class="cstat-no" title="statement not covered" >    var parsed = this.parseTimestamp(ts);</span>
<span class="cstat-no" title="statement not covered" >    if (parsed.time&lt;this.lastTimeSeen) { <span class="cstat-no" title="statement not covered" >return true; </span>}</span>
<span class="cstat-no" title="statement not covered" >    var min = this.minutes();</span>
<span class="cstat-no" title="statement not covered" >    if (parsed.time&gt;min+1) { <span class="cstat-no" title="statement not covered" >return false; </span>} </span>// bad clocks somewhere
<span class="cstat-no" title="statement not covered" >    this.lastTimeSeen = parsed.time;</span>
<span class="cstat-no" title="statement not covered" >    this.lastSeqSeen = parsed.seq;</span>
<span class="cstat-no" title="statement not covered" >    return true;</span>
};
&nbsp;
&nbsp;
MinutePreciseClock.prototype.time2date = <span class="fstat-no" title="function not covered" >function () {</span>
    // parse etc
};
&nbsp;
module.exports = MinutePreciseClock;
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/Model.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/Model.js</span></h1>
    <h2>
        
        Statements: <span class="metric">6.94% <small>(5 / 72)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 45)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 13)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">6.94% <small>(5 / 72)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/node_modules/swarm/lib/</a> &#187; Model.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
&nbsp;
var Spec = require('./Spec');
var Syncable = require('./Syncable');
&nbsp;
/**
 * Model (LWW key-value object)
 * @param idOrState
 * @constructor
 */
<span class="fstat-no" title="function not covered" >function Model(idOrState) {</span>
<span class="cstat-no" title="statement not covered" >    var ret = Model._super.apply(this, arguments);</span>
    /// TODO: combine with state push, make clean
<span class="cstat-no" title="statement not covered" >    if (ret === this &amp;&amp; idOrState &amp;&amp; idOrState.constructor !== String &amp;&amp; !Spec.is(idOrState)) {</span>
<span class="cstat-no" title="statement not covered" >        this.deliver(this.spec().add(this._id, '!').add('.set'), idOrState);</span>
    }
}
&nbsp;
module.exports = Syncable.extend(Model, {
    defaults: {
        _oplog: Object
    },
    /**  init modes:
     *    1  fresh id, fresh object
     *    2  known id, stateless object
     *    3  known id, state boot
     */
    neutrals: {
        on: <span class="fstat-no" title="function not covered" >function (spec, base, repl) {</span>
            //  support the model.on('field',callback_fn) pattern
<span class="cstat-no" title="statement not covered" >            if (typeof(repl) === 'function' &amp;&amp;</span>
                    typeof(base) === 'string' &amp;&amp;
                    (base in this.constructor.defaults)) {
<span class="cstat-no" title="statement not covered" >                var stub = {</span>
                    fn: repl,
                    key: base,
                    self: this,
                    _op: 'set',
                    deliver: <span class="fstat-no" title="function not covered" >function (spec, val, src) {</span>
<span class="cstat-no" title="statement not covered" >                        if (this.key in val) {</span>
<span class="cstat-no" title="statement not covered" >                            this.fn.call(this.self, spec, val, src);</span>
                        }
                    }
                };
<span class="cstat-no" title="statement not covered" >                repl = stub;</span>
<span class="cstat-no" title="statement not covered" >                base = '';</span>
            }
            // this will delay response if we have no state yet
<span class="cstat-no" title="statement not covered" >            Syncable._pt._neutrals.on.call(this, spec, base, repl);</span>
        },
&nbsp;
        off: <span class="fstat-no" title="function not covered" >function (spec, base, repl) {</span>
<span class="cstat-no" title="statement not covered" >            var ls = this._lstn;</span>
<span class="cstat-no" title="statement not covered" >            if (typeof(repl) === 'function') { // TODO ugly</span>
<span class="cstat-no" title="statement not covered" >                for (var i = 0; i &lt; ls.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >                    if (ls[i] &amp;&amp; ls[i].fn === repl &amp;&amp; ls[i].key === base) {</span>
<span class="cstat-no" title="statement not covered" >                        repl = ls[i];</span>
<span class="cstat-no" title="statement not covered" >                        break;</span>
                    }
                }
            }
<span class="cstat-no" title="statement not covered" >            Syncable._pt._neutrals.off.apply(this, arguments);</span>
        }
&nbsp;
    },
&nbsp;
    // TODO remove unnecessary value duplication
    packState: <span class="fstat-no" title="function not covered" >function (state) {</span>
    },
    unpackState: <span class="fstat-no" title="function not covered" >function (state) {</span>
    },
    /**
     * Removes redundant information from the log; as we carry a copy
     * of the log in every replica we do everythin to obtain the minimal
     * necessary subset of it.
     * As a side effect, distillLog allows up to handle some partial
     * order issues (see _ops.set).
     * @see Model.ops.set
     * @returns {*} distilled log {spec:true}
     */
    distillLog: <span class="fstat-no" title="function not covered" >function () {</span>
        // explain
<span class="cstat-no" title="statement not covered" >        var sets = [],</span>
            cumul = {},
            heads = {},
            spec;
<span class="cstat-no" title="statement not covered" >        for (var s in this._oplog) {</span>
<span class="cstat-no" title="statement not covered" >            spec = new Spec(s);</span>
            //if (spec.op() === 'set') {
<span class="cstat-no" title="statement not covered" >            sets.push(spec);</span>
            //}
        }
<span class="cstat-no" title="statement not covered" >        sets.sort();</span>
<span class="cstat-no" title="statement not covered" >        for (var i = sets.length - 1; i &gt;= 0; i--) {</span>
<span class="cstat-no" title="statement not covered" >            spec = sets[i];</span>
<span class="cstat-no" title="statement not covered" >            var val = this._oplog[spec],</span>
                notempty = false;
<span class="cstat-no" title="statement not covered" >            for (var field in val) {</span>
<span class="cstat-no" title="statement not covered" >                if (field in cumul) {</span>
<span class="cstat-no" title="statement not covered" >                    delete val[field];</span>
                } else {
<span class="cstat-no" title="statement not covered" >                    notempty = cumul[field] = val[field]; </span>//store last value of the field
                }
            }
<span class="cstat-no" title="statement not covered" >            var source = spec.source();</span>
<span class="cstat-no" title="statement not covered" >            notempty || (heads[source] &amp;&amp; delete this._oplog[spec]);</span>
<span class="cstat-no" title="statement not covered" >            heads[source] = true;</span>
        }
<span class="cstat-no" title="statement not covered" >        return cumul;</span>
    },
&nbsp;
    ops: {
        /**
         * This barebones Model class implements just one kind of an op:
         * set({key:value}). To implment your own ops you need to understand
         * implications of partial order as ops may be applied in slightly
         * different orders at different replicas. This implementation
         * may resort to distillLog() to linearize ops.
         */
        set: <span class="fstat-no" title="function not covered" >function (spec, value, repl) {</span>
<span class="cstat-no" title="statement not covered" >            var version = spec.version(),</span>
                vermet = spec.filter('!.').toString();
<span class="cstat-no" title="statement not covered" >            if (version &lt; this._version.substr(1)) {</span>
<span class="cstat-no" title="statement not covered" >                this._oplog[vermet] = value;</span>
<span class="cstat-no" title="statement not covered" >                this.distillLog(); </span>// may amend the value
<span class="cstat-no" title="statement not covered" >                value = this._oplog[vermet];</span>
            }
<span class="cstat-no" title="statement not covered" >            value &amp;&amp; this.apply(value);</span>
        }
    },
&nbsp;
    fill: <span class="fstat-no" title="function not covered" >function (key) {</span> // TODO goes to Model to support references
<span class="cstat-no" title="statement not covered" >        if (!this.hasOwnProperty(key)) {</span>
<span class="cstat-no" title="statement not covered" >            throw new Error('no such entry');</span>
        }
&nbsp;
        //if (!Spec.is(this[key]))
        //    throw new Error('not a specifier');
<span class="cstat-no" title="statement not covered" >        var spec = new Spec(this[key]).filter('/#');</span>
<span class="cstat-no" title="statement not covered" >        if (spec.pattern() !== '/#') {</span>
<span class="cstat-no" title="statement not covered" >            throw new Error('incomplete spec');</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        this[key] = this._host.get(spec);</span>
        /* TODO new this.refType(id) || new Swarm.types[type](id);
         on('init', function(){
         self.emit('fill',key,this)
         self.emit('full',key,this)
         });*/
    },
&nbsp;
    /**
     * Generate .set operation after some of the model fields were changed
     * TODO write test for Model.save()
     */
    save: <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >        var cumul = this.distillLog(),</span>
            changes = {},
            pojo = this.pojo(),
            field;
<span class="cstat-no" title="statement not covered" >        for (field in pojo) {</span>
<span class="cstat-no" title="statement not covered" >            if (this[field] !== cumul[field]) {// TODO nesteds</span>
<span class="cstat-no" title="statement not covered" >                changes[field] = this[field];</span>
            }
        }
<span class="cstat-no" title="statement not covered" >        for (field in cumul) {</span>
<span class="cstat-no" title="statement not covered" >            if (!(field in pojo)) {</span>
<span class="cstat-no" title="statement not covered" >                changes[field] = null; </span>// JSON has no undefined
            }
        }
<span class="cstat-no" title="statement not covered" >        this.set(changes);</span>
    },
&nbsp;
    validate: <span class="fstat-no" title="function not covered" >function (spec, val) {</span>
<span class="cstat-no" title="statement not covered" >        if (spec.op() !== 'set') {</span>
<span class="cstat-no" title="statement not covered" >            return '';</span>
        } // no idea
<span class="cstat-no" title="statement not covered" >        for (var key in val) {</span>
<span class="cstat-no" title="statement not covered" >            if (!Syncable.reFieldName.test(key)) {</span>
<span class="cstat-no" title="statement not covered" >                return 'bad field name';</span>
            }
        }
<span class="cstat-no" title="statement not covered" >        return '';</span>
    }
&nbsp;
});
&nbsp;
// Model may have reactions for field changes as well as for 'real' ops/events
// (a field change is a .set operation accepting a {field:newValue} map)
module.exports.addReaction = <span class="fstat-no" title="function not covered" >function (methodOrField, fn) {</span>
<span class="cstat-no" title="statement not covered" >    var proto = this.prototype;</span>
<span class="cstat-no" title="statement not covered" >    if (typeof (proto[methodOrField]) === 'function') { // it is a field name</span>
<span class="cstat-no" title="statement not covered" >        return Syncable.addReaction.call(this, methodOrField, fn);</span>
    } else {
<span class="cstat-no" title="statement not covered" >        var wrapper = <span class="fstat-no" title="function not covered" >function (spec, val) {</span></span>
<span class="cstat-no" title="statement not covered" >            if (methodOrField in val) {</span>
<span class="cstat-no" title="statement not covered" >                fn.apply(this, arguments);</span>
            }
        };
<span class="cstat-no" title="statement not covered" >        wrapper._rwrap = true;</span>
<span class="cstat-no" title="statement not covered" >        return Syncable.addReaction.call(this, 'set', wrapper);</span>
    }
};
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/NodeServer.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header high">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/NodeServer.js</span></h1>
    <h2>
        
        Statements: <span class="metric">100% <small>(17 / 17)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">100% <small>(0 / 0)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">100% <small>(0 / 0)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">100% <small>(17 / 17)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/node_modules/swarm/lib/</a> &#187; NodeServer.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
&nbsp;
var Swarm = {'profile': 'node.js'};
&nbsp;
Swarm.env = require('./env');
Swarm.Spec = require('./Spec');
Swarm.LongSpec = require('./LongSpec');
Swarm.Syncable = require('./Syncable');
Swarm.Model = require('./Model');
Swarm.Set = require('./Set');
Swarm.Vector = require('./Vector');
Swarm.Host = require('./Host');
Swarm.Pipe = require('./Pipe');
Swarm.Storage = require('./Storage');
Swarm.FileStorage = require('./FileStorage');
Swarm.LevelStorage = require('./LevelStorage');
Swarm.EinarosWSStream = require('./EinarosWSStream');
Swarm.ReactMixin = require('./ReactMixin');
Swarm.SecondPreciseClock = require('./SecondPreciseClock');
&nbsp;
module.exports = Swarm;
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/Pipe.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/Pipe.js</span></h1>
    <h2>
        
        Statements: <span class="metric">11.49% <small>(17 / 148)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 86)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 17)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">11.64% <small>(17 / 146)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/node_modules/swarm/lib/</a> &#187; Pipe.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
&nbsp;
var env = require('./env');
var Spec = require('./Spec');
&nbsp;
/**
 * A "pipe" is a channel to a remote Swarm Host. Pipe's interface
 * mocks a Host except all calls are serialized and sent to the
 * *stream*; any arriving data is parsed and delivered to the
 * local host. The *stream* must support an interface of write(),
 * end() and on('open'|'data'|'close'|'error',fn).  Instead of a
 * *stream*, the caller may supply an *uri*, so the Pipe will
 * create a stream and connect/reconnect as necessary.
 */
&nbsp;
<span class="fstat-no" title="function not covered" >function Pipe(host, stream, opts) {</span>
<span class="cstat-no" title="statement not covered" >    var self = this;</span>
<span class="cstat-no" title="statement not covered" >    self.opts = opts || {};</span>
<span class="cstat-no" title="statement not covered" >    if (!stream || !host) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error('new Pipe(host,stream[,opts])');</span>
    }
<span class="cstat-no" title="statement not covered" >    self._id = null;</span>
<span class="cstat-no" title="statement not covered" >    self.host = host;</span>
    // uplink/downlink state flag;
    //  true: this side initiated handshake &gt;.on &lt;.reon
    //  false: this side received handshake &lt;.on &gt;.reon
    //  undefined: nothing sent/received OR had a .reoff
<span class="cstat-no" title="statement not covered" >    this.isOnSent = undefined;</span>
<span class="cstat-no" title="statement not covered" >    this.reconnectDelay = self.opts.reconnectDelay || 1000;</span>
<span class="cstat-no" title="statement not covered" >    self.serializer = self.opts.serializer || JSON;</span>
<span class="cstat-no" title="statement not covered" >    self.katimer = null;</span>
<span class="cstat-no" title="statement not covered" >    self.send_timer = null;</span>
<span class="cstat-no" title="statement not covered" >    self.lastSendTS = self.lastRecvTS = self.time();</span>
<span class="cstat-no" title="statement not covered" >    self.bundle = {};</span>
    // don't send immediately, delay to bundle more messages
<span class="cstat-no" title="statement not covered" >    self.delay = self.opts.delay || -1;</span>
    //self.reconnectDelay = self.opts.reconnectDelay || 1000;
<span class="cstat-no" title="statement not covered" >    if (typeof(stream.write) !== 'function') { // TODO nicer</span>
<span class="cstat-no" title="statement not covered" >        var url = stream.toString();</span>
<span class="cstat-no" title="statement not covered" >        var m = url.match(/(\w+):.*/);</span>
<span class="cstat-no" title="statement not covered" >        if (!m) {</span>
<span class="cstat-no" title="statement not covered" >            throw new Error('invalid url ' + url);</span>
        }
<span class="cstat-no" title="statement not covered" >        var proto = m[1].toLowerCase();</span>
<span class="cstat-no" title="statement not covered" >        var fn = env.streams[proto];</span>
<span class="cstat-no" title="statement not covered" >        if (!fn) {</span>
<span class="cstat-no" title="statement not covered" >            throw new Error('protocol not supported: ' + proto);</span>
        }
<span class="cstat-no" title="statement not covered" >        self.url = url;</span>
<span class="cstat-no" title="statement not covered" >        stream = new fn(url);</span>
    }
<span class="cstat-no" title="statement not covered" >    self.connect(stream);</span>
}
&nbsp;
module.exports = Pipe;
//env.streams = {};
Pipe.TIMEOUT = 60000; //ms
&nbsp;
Pipe.prototype.connect = <span class="fstat-no" title="function not covered" >function pc(stream) {</span>
<span class="cstat-no" title="statement not covered" >    var self = this;</span>
<span class="cstat-no" title="statement not covered" >    self.stream = stream;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    self.stream.on('data', <span class="fstat-no" title="function not covered" >function onMsg(data) {</span></span>
<span class="cstat-no" title="statement not covered" >        data = data.toString();</span>
<span class="cstat-no" title="statement not covered" >        env.trace &amp;&amp; env.log(dotIn, data, this, this.host);</span>
<span class="cstat-no" title="statement not covered" >        self.lastRecvTS = self.time();</span>
<span class="cstat-no" title="statement not covered" >        var json = self.serializer.parse(data);</span>
<span class="cstat-no" title="statement not covered" >        try {</span>
<span class="cstat-no" title="statement not covered" >            self._id ? self.parseBundle(json) : self.parseHandshake(json);</span>
        } catch (ex) {
<span class="cstat-no" title="statement not covered" >            console.error('error processing message', ex, ex.stack);</span>
            //this.deliver(this.host.newEventSpec('error'), ex.message);
<span class="cstat-no" title="statement not covered" >            this.close();</span>
        }
<span class="cstat-no" title="statement not covered" >        self.reconnectDelay = self.opts.reconnectDelay || 1000;</span>
    });
&nbsp;
<span class="cstat-no" title="statement not covered" >    self.stream.on('close', <span class="fstat-no" title="function not covered" >function onConnectionClosed(reason) {</span></span>
<span class="cstat-no" title="statement not covered" >        self.stream = null; </span>// needs no further attention
<span class="cstat-no" title="statement not covered" >        self.close("stream closed");</span>
    });
&nbsp;
<span class="cstat-no" title="statement not covered" >    self.stream.on('error', <span class="fstat-no" title="function not covered" >function (err) {</span></span>
<span class="cstat-no" title="statement not covered" >        self.close('stream error event: ' + err);</span>
    });
&nbsp;
<span class="cstat-no" title="statement not covered" >    self.katimer = setInterval(self.keepAliveFn.bind(self), (Pipe.TIMEOUT / 4 + Math.random() * 100) | 0);</span>
&nbsp;
    // NOPE client only finally, initiate handshake
    // self.host.connect(self);
&nbsp;
};
&nbsp;
Pipe.prototype.keepAliveFn = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >    var now = this.time(),</span>
        sinceRecv = now - this.lastRecvTS,
        sinceSend = now - this.lastSendTS;
<span class="cstat-no" title="statement not covered" >    if (sinceSend &gt; Pipe.TIMEOUT / 2) {</span>
<span class="cstat-no" title="statement not covered" >        this.sendBundle();</span>
    }
<span class="cstat-no" title="statement not covered" >    if (sinceRecv &gt; Pipe.TIMEOUT) {</span>
<span class="cstat-no" title="statement not covered" >        this.close("stream timeout");</span>
    }
};
&nbsp;
Pipe.prototype.parseHandshake = <span class="fstat-no" title="function not covered" >function ph(handshake) {</span>
<span class="cstat-no" title="statement not covered" >    var spec, value, key;</span>
<span class="cstat-no" title="statement not covered" >    for (key in handshake) {</span>
<span class="cstat-no" title="statement not covered" >        spec = new Spec(key);</span>
<span class="cstat-no" title="statement not covered" >        value = handshake[key];</span>
<span class="cstat-no" title="statement not covered" >        break; </span>// 8)-
    }
<span class="cstat-no" title="statement not covered" >    if (!spec) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error('handshake has no spec');</span>
    }
<span class="cstat-no" title="statement not covered" >    if (spec.type() !== 'Host') {</span>
<span class="cstat-no" title="statement not covered" >        env.warn("non-Host handshake");</span>
    }
<span class="cstat-no" title="statement not covered" >    if (spec.id() === this.host._id) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error('self hs');</span>
    }
<span class="cstat-no" title="statement not covered" >    this._id = spec.id();</span>
<span class="cstat-no" title="statement not covered" >    var op = spec.op();</span>
<span class="cstat-no" title="statement not covered" >    var evspec = spec.set(this.host._id, '#');</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (op in {on: 1, reon: 1, off: 1, reoff: 1}) {// access denied TODO</span>
<span class="cstat-no" title="statement not covered" >        this.host.deliver(evspec, value, this);</span>
    } else {
<span class="cstat-no" title="statement not covered" >        throw new Error('invalid handshake');</span>
    }
};
&nbsp;
/**
 * Close the underlying stream.
 * Schedule new Pipe creation (when error passed).
 * note: may be invoked multiple times
 * @param {Error|string} error
 */
Pipe.prototype.close = <span class="fstat-no" title="function not covered" >function pc(error) {</span>
<span class="cstat-no" title="statement not covered" >    env.log(dotClose, error ? 'error: ' + error : 'correct', this, this.host);</span>
<span class="cstat-no" title="statement not covered" >    if (error &amp;&amp; this.host &amp;&amp; this.url) {</span>
<span class="cstat-no" title="statement not covered" >        var uplink_uri = this.url,</span>
            host = this.host,
            pipe_opts = this.opts;
        //reconnect delay for next disconnection
<span class="cstat-no" title="statement not covered" >        pipe_opts.reconnectDelay = Math.min(30000, this.reconnectDelay &lt;&lt; 1);</span>
        // schedule a retry
<span class="cstat-no" title="statement not covered" >        setTimeout(<span class="fstat-no" title="function not covered" >function () {</span></span>
<span class="cstat-no" title="statement not covered" >            host.connect(uplink_uri, pipe_opts);</span>
        }, this.reconnectDelay);
&nbsp;
<span class="cstat-no" title="statement not covered" >        this.url = null; </span>//to prevent second reconnection timer
    }
<span class="cstat-no" title="statement not covered" >    if (this.host) {</span>
<span class="cstat-no" title="statement not covered" >        if (this.isOnSent !== undefined &amp;&amp; this._id) {</span>
            // emulate normal off
<span class="cstat-no" title="statement not covered" >            var offspec = this.host.newEventSpec(this.isOnSent ? 'off' : 'reoff');</span>
<span class="cstat-no" title="statement not covered" >            this.host.deliver(offspec, '', this);</span>
        }
<span class="cstat-no" title="statement not covered" >        this.host = null; </span>// can't pass any more messages
    }
<span class="cstat-no" title="statement not covered" >    if (this.katimer) {</span>
<span class="cstat-no" title="statement not covered" >        clearInterval(this.katimer);</span>
<span class="cstat-no" title="statement not covered" >        this.katimer = null;</span>
    }
<span class="cstat-no" title="statement not covered" >    if (this.stream) {</span>
<span class="cstat-no" title="statement not covered" >        try {</span>
<span class="cstat-no" title="statement not covered" >            this.stream.close();</span>
        } catch (ex) {}
<span class="cstat-no" title="statement not covered" >        this.stream = null;</span>
    }
<span class="cstat-no" title="statement not covered" >    this._id = null;</span>
};
&nbsp;
/**
 * Sends operation to remote
 */
Pipe.prototype.deliver = <span class="fstat-no" title="function not covered" >function pd(spec, val, src) {</span>
<span class="cstat-no" title="statement not covered" >    var self = this;</span>
<span class="cstat-no" title="statement not covered" >    val &amp;&amp; val.constructor === Spec &amp;&amp; (val = val.toString());</span>
<span class="cstat-no" title="statement not covered" >    if (spec.type() === 'Host') {</span>
<span class="cstat-no" title="statement not covered" >        switch (spec.op()) {</span>
        case 'reoff':
<span class="cstat-no" title="statement not covered" >            setTimeout(<span class="fstat-no" title="function not covered" >function itsOverReally() {</span></span>
<span class="cstat-no" title="statement not covered" >                self.isOnSent = undefined;</span>
<span class="cstat-no" title="statement not covered" >                self.close();</span>
            }, 1);
<span class="cstat-no" title="statement not covered" >            break;</span>
        case 'off':
<span class="cstat-no" title="statement not covered" >            setTimeout(<span class="fstat-no" title="function not covered" >function tickingBomb() {</span></span>
<span class="cstat-no" title="statement not covered" >                self.close();</span>
            }, 5000);
<span class="cstat-no" title="statement not covered" >            break;</span>
        case 'on':
<span class="cstat-no" title="statement not covered" >            this.isOnSent = true;</span>
        case 'reon':
<span class="cstat-no" title="statement not covered" >            this.isOnSent = false;</span>
        }
    }
<span class="cstat-no" title="statement not covered" >    this.bundle[spec] = val === undefined ? null : val; </span>// TODO aggregation
<span class="cstat-no" title="statement not covered" >    if (this.delay === -1) {</span>
<span class="cstat-no" title="statement not covered" >        this.sendBundle();</span>
    } else <span class="cstat-no" title="statement not covered" >if (!this.send_timer) {</span>
<span class="cstat-no" title="statement not covered" >        var now = this.time(),</span>
            gap = now - this.lastSendTS,
            timeout = gap &gt; this.delay ? this.delay : this.delay - gap;
<span class="cstat-no" title="statement not covered" >        this.send_timer = setTimeout(this.sendBundle.bind(this), timeout); </span>// hmmm...
    } // else {} // just wait
};
&nbsp;
/** @returns {number} milliseconds as an int */
Pipe.prototype.time = <span class="fstat-no" title="function not covered" >function () {</span> <span class="cstat-no" title="statement not covered" >return new Date().getTime(); </span>};
&nbsp;
/**
 * @returns {Spec|string} remote host spec "/Host#peer_id" or empty string (when not handshaken yet)
 */
Pipe.prototype.spec = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >    return this._id ? new Spec('/Host#' + this._id) : '';</span>
};
/**
 * @param {*} bundle is a bunch of operations in a form {operation_spec: operation_params_object}
 * @private
 */
Pipe.prototype.parseBundle = <span class="fstat-no" title="function not covered" >function pb(bundle) {</span>
<span class="cstat-no" title="statement not covered" >    var spec_list = [], spec, self = this;</span>
    //parse specifiers
<span class="cstat-no" title="statement not covered" >    for (spec in bundle) { <span class="cstat-no" title="statement not covered" >spec &amp;&amp; spec_list.push(new Spec(spec)); </span>}</span>
<span class="cstat-no" title="statement not covered" >    spec_list.sort().reverse();</span>
<span class="cstat-no" title="statement not covered" >    while (spec = spec_list.pop()) {</span>
<span class="cstat-no" title="statement not covered" >        spec = Spec.as(spec);</span>
<span class="cstat-no" title="statement not covered" >        this.host.deliver(spec, bundle[spec], this);</span>
<span class="cstat-no" title="statement not covered" >        if (spec.type() === 'Host' &amp;&amp; spec.op() === 'reoff') { //TODO check #id</span>
<span class="cstat-no" title="statement not covered" >            setTimeout(<span class="fstat-no" title="function not covered" >function () {</span></span>
<span class="cstat-no" title="statement not covered" >                self.isOnSent = undefined;</span>
<span class="cstat-no" title="statement not covered" >                self.close();</span>
            }, 1);
        }
    }
};
&nbsp;
var dotIn = new Spec('/Pipe.in');
var dotOut = new Spec('/Pipe.out');
var dotClose = new Spec('/Pipe.close');
//var dotOpen = new Spec('/Pipe.open');
&nbsp;
/**
 * Sends operations buffered in this.bundle as a bundle {operation_spec: operation_params_object}
 * @private
 */
Pipe.prototype.sendBundle = <span class="fstat-no" title="function not covered" >function pS() {</span>
<span class="cstat-no" title="statement not covered" >    var payload = this.serializer.stringify(this.bundle);</span>
<span class="cstat-no" title="statement not covered" >    this.bundle = {};</span>
<span class="cstat-no" title="statement not covered" >    if (!this.stream) {</span>
<span class="cstat-no" title="statement not covered" >        this.send_timer = null;</span>
<span class="cstat-no" title="statement not covered" >        return; </span>// too late
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    try {</span>
<span class="cstat-no" title="statement not covered" >        env.trace &amp;&amp; env.log(dotOut, payload, this, this.host);</span>
<span class="cstat-no" title="statement not covered" >        this.stream.write(payload);</span>
<span class="cstat-no" title="statement not covered" >        this.lastSendTS = this.time();</span>
    } catch (ex) {
<span class="cstat-no" title="statement not covered" >        env.error('stream error on write: ' + ex, ex.stack);</span>
<span class="cstat-no" title="statement not covered" >        if (this._id) {</span>
<span class="cstat-no" title="statement not covered" >            this.close('stream error', ex);</span>
        }
    } finally {
<span class="cstat-no" title="statement not covered" >        this.send_timer = null;</span>
    }
};
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/PostMessageStream.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/PostMessageStream.js</span></h1>
    <h2>
        
        Statements: <span class="metric">8.51% <small>(8 / 94)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 53)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 12)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">8.51% <small>(8 / 94)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/node_modules/swarm/lib/</a> &#187; PostMessageStream.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
&nbsp;
var env = require('./env');
var Spec = require('./Spec');
&nbsp;
// This stream implementation uses postMessage to synchronize to
// another IFRAME (use URIs like iframe:parent or iframe:elementId)
<span class="fstat-no" title="function not covered" >function PostMessageStream(frameUri, origin, secret) {</span>
<span class="cstat-no" title="statement not covered" >    this.origin = origin;</span>
<span class="cstat-no" title="statement not covered" >    this.lstn = {};</span>
<span class="cstat-no" title="statement not covered" >    if (frameUri.constructor === String) {</span>
<span class="cstat-no" title="statement not covered" >        var m = frameUri.match(/^iframe:(\w+)/i);</span>
<span class="cstat-no" title="statement not covered" >        if (!m) {</span>
<span class="cstat-no" title="statement not covered" >            throw new Error('invalid URL');</span>
        }
<span class="cstat-no" title="statement not covered" >        var frameId = m[1];</span>
<span class="cstat-no" title="statement not covered" >        if (!frameId || frameId === 'parent') {</span>
<span class="cstat-no" title="statement not covered" >            this.targetWindow = window.parent;</span>
        } else {
<span class="cstat-no" title="statement not covered" >            var i = document.getElementById(frameId);</span>
<span class="cstat-no" title="statement not covered" >            if (!i) {</span>
<span class="cstat-no" title="statement not covered" >                throw new Error('element unknown: ' + frameId);</span>
            }
<span class="cstat-no" title="statement not covered" >            if (!i.contentWindow) {</span>
<span class="cstat-no" title="statement not covered" >                throw new Error('not an IFRAME');</span>
            }
<span class="cstat-no" title="statement not covered" >            this.targetWindow = i.contentWindow;</span>
        }
    } else {
<span class="cstat-no" title="statement not covered" >        if (!frameUri.location) {</span>
<span class="cstat-no" title="statement not covered" >            throw new Error('1st param: target frame');</span>
        }
<span class="cstat-no" title="statement not covered" >        this.targetWindow = frameUri;</span>
    }
<span class="cstat-no" title="statement not covered" >    var rnd = (Math.random() * 0xffffff) | 0;</span>
<span class="cstat-no" title="statement not covered" >    var time = new Date().getTime() &amp; 0xffffff;</span>
<span class="cstat-no" title="statement not covered" >    this.secret = secret ||</span>
    ( Spec.int2base(time) + '~' + Spec.int2base(rnd) );
<span class="cstat-no" title="statement not covered" >    PostMessageStream.streams[this.secret] = this;</span>
<span class="cstat-no" title="statement not covered" >    this.pending = null;</span>
<span class="cstat-no" title="statement not covered" >    this.retries = 0;</span>
<span class="cstat-no" title="statement not covered" >    this.retryInt = null;</span>
<span class="cstat-no" title="statement not covered" >    if (!secret) { // make sure somebody listens on the other end</span>
<span class="cstat-no" title="statement not covered" >        this.pending = '';</span>
<span class="cstat-no" title="statement not covered" >        var self = this;</span>
<span class="cstat-no" title="statement not covered" >        this.retryInt = setInterval(<span class="fstat-no" title="function not covered" >function () {</span></span>
<span class="cstat-no" title="statement not covered" >            self.retryHandshake();</span>
        }, 100); // keep pinging the other frame for 1 second
    }
<span class="cstat-no" title="statement not covered" >    this.write(''); </span>// handshake
}
PostMessageStream.streams = {};
PostMessageStream.re64 = /^([0-9A-Za-z_~]+)&gt;/;
&nbsp;
PostMessageStream.prototype.retryHandshake = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >    if (this.pending === null) { // it's OK</span>
<span class="cstat-no" title="statement not covered" >        clearInterval(this.retryInt);</span>
<span class="cstat-no" title="statement not covered" >        return;</span>
    }
<span class="cstat-no" title="statement not covered" >    if (this.retries++ &gt; 10) {</span>
<span class="cstat-no" title="statement not covered" >        clearInterval(this.retryInt);</span>
<span class="cstat-no" title="statement not covered" >        this.lstn.error &amp;&amp; this.lstn.error('no response from the frame');</span>
<span class="cstat-no" title="statement not covered" >        this.close();</span>
    } else {
<span class="cstat-no" title="statement not covered" >        this.write('');</span>
<span class="cstat-no" title="statement not covered" >        console.warn('retrying postMessage handshake');</span>
    }
};
&nbsp;
PostMessageStream.prototype.onMessage = <span class="fstat-no" title="function not covered" >function (msg, origin) {</span>
<span class="cstat-no" title="statement not covered" >    if (this.origin &amp;&amp; origin !== this.origin) {</span>
<span class="cstat-no" title="statement not covered" >        console.warn('mismatched origin: ', origin, this.origin);</span>
<span class="cstat-no" title="statement not covered" >        return;</span>
    }
<span class="cstat-no" title="statement not covered" >    if (this.pending !== null) {</span>
<span class="cstat-no" title="statement not covered" >        var p = this.pending;</span>
<span class="cstat-no" title="statement not covered" >        this.pending = null;</span>
<span class="cstat-no" title="statement not covered" >        p &amp;&amp; this.write(p);</span>
    }
<span class="cstat-no" title="statement not covered" >    msg &amp;&amp; this.lstn.data &amp;&amp; this.lstn.data(msg);</span>
};
&nbsp;
// FIXME: explicitly invoke (security - entry point)
window.addEventListener('message', <span class="fstat-no" title="function not covered" >function onPostMessage(ev) {</span>
<span class="cstat-no" title="statement not covered" >    var msg = ev.data.toString();</span>
<span class="cstat-no" title="statement not covered" >    var m = msg.match(PostMessageStream.re64);</span>
<span class="cstat-no" title="statement not covered" >    if (!m) {</span>
<span class="cstat-no" title="statement not covered" >        return;</span>
    }
<span class="cstat-no" title="statement not covered" >    var secret = m[1], json = msg.substr(secret.length + 1);</span>
<span class="cstat-no" title="statement not covered" >    var stream = PostMessageStream.streams[secret];</span>
<span class="cstat-no" title="statement not covered" >    if (!stream) {</span>
<span class="cstat-no" title="statement not covered" >        if (!PostMessageStream.host) {</span>
<span class="cstat-no" title="statement not covered" >            throw new Error('unknown stream: ' + secret);</span>
        }
<span class="cstat-no" title="statement not covered" >        stream = new PostMessageStream(ev.source, PostMessageStream.origin, secret);</span>
<span class="cstat-no" title="statement not covered" >        stream.on('close', <span class="fstat-no" title="function not covered" >function cleanup() {</span></span>
<span class="cstat-no" title="statement not covered" >            delete PostMessageStream.streams[secret];</span>
        });
<span class="cstat-no" title="statement not covered" >        PostMessageStream.host.accept(stream);</span>
    }
<span class="cstat-no" title="statement not covered" >    stream.onMessage(json, ev.origin);</span>
});
&nbsp;
<span class="cstat-no" title="statement not covered" >PostMessageStream.listen = <span class="fstat-no" title="function not covered" >function (host, origin) {</span></span>
<span class="cstat-no" title="statement not covered" >    PostMessageStream.host = host;</span>
<span class="cstat-no" title="statement not covered" >    PostMessageStream.origin = origin;</span>
};
&nbsp;
&nbsp;
<span class="cstat-no" title="statement not covered" >PostMessageStream.prototype.on = <span class="fstat-no" title="function not covered" >function (evname, fn) {</span></span>
<span class="cstat-no" title="statement not covered" >    if (evname in this.lstn) {</span>
<span class="cstat-no" title="statement not covered" >        var self = this,</span>
            prev_fn = this.lstn[evname];
<span class="cstat-no" title="statement not covered" >        this.lstn[evname] = <span class="fstat-no" title="function not covered" >function () {</span></span>
<span class="cstat-no" title="statement not covered" >            prev_fn.apply(self, arguments);</span>
<span class="cstat-no" title="statement not covered" >            fn.apply(self, arguments);</span>
        };
    } else {
<span class="cstat-no" title="statement not covered" >        this.lstn[evname] = fn;</span>
    }
};
&nbsp;
<span class="cstat-no" title="statement not covered" >PostMessageStream.prototype.write = <span class="fstat-no" title="function not covered" >function (data) {</span></span>
<span class="cstat-no" title="statement not covered" >    if (this.pending !== null) {</span>
<span class="cstat-no" title="statement not covered" >        this.pending += data || '';</span>
<span class="cstat-no" title="statement not covered" >        data = '';</span>
    }
<span class="cstat-no" title="statement not covered" >    var str = this.secret + '&gt;' + data;</span>
<span class="cstat-no" title="statement not covered" >    this.targetWindow.postMessage(str, this.origin || '*');</span>
};
&nbsp;
<span class="cstat-no" title="statement not covered" >PostMessageStream.prototype.close = <span class="fstat-no" title="function not covered" >function () {</span></span>
<span class="cstat-no" title="statement not covered" >    var ln = this.lstn || {};</span>
<span class="cstat-no" title="statement not covered" >    ln.close &amp;&amp; ln.close();</span>
<span class="cstat-no" title="statement not covered" >    delete PostMessageStream.streams[this.secret];</span>
};
&nbsp;
<span class="cstat-no" title="statement not covered" >PostMessageStream.prototype.log = <span class="fstat-no" title="function not covered" >function (event, message) {</span></span>
<span class="cstat-no" title="statement not covered" >    console.log('pm:' + this.frameId, event, message);</span>
};
&nbsp;
<span class="cstat-no" title="statement not covered" >env.streams.iframe = PostMessageStream;</span>
<span class="cstat-no" title="statement not covered" >module.exports = PostMessageStream;</span>
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/ProxyListener.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/ProxyListener.js</span></h1>
    <h2>
        
        Statements: <span class="metric">20.83% <small>(5 / 24)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 12)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 4)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">23.81% <small>(5 / 21)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/node_modules/swarm/lib/</a> &#187; ProxyListener.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
&nbsp;
<span class="fstat-no" title="function not covered" >function ProxyListener() {</span>
<span class="cstat-no" title="statement not covered" >    this.callbacks = null;</span>
<span class="cstat-no" title="statement not covered" >    this.owner = null;</span>
}
&nbsp;
ProxyListener.prototype.deliver = <span class="fstat-no" title="function not covered" >function (spec,value,src) {</span>
<span class="cstat-no" title="statement not covered" >    if (this.callbacks===null) { <span class="cstat-no" title="statement not covered" >return; </span>}</span>
<span class="cstat-no" title="statement not covered" >    var that = this.owner || src;</span>
<span class="cstat-no" title="statement not covered" >    for(var i=0; i&lt;this.callbacks.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >        var cb = this.callbacks[i];</span>
<span class="cstat-no" title="statement not covered" >        if (cb.constructor===Function) {</span>
<span class="cstat-no" title="statement not covered" >            cb.call(that,spec,value,src);</span>
        } else {
<span class="cstat-no" title="statement not covered" >            cb.deliver(spec,value,src);</span>
        }
    }
};
&nbsp;
ProxyListener.prototype.on = <span class="fstat-no" title="function not covered" >function (callback) {</span>
<span class="cstat-no" title="statement not covered" >    if (this.callbacks===null) { <span class="cstat-no" title="statement not covered" >this.callbacks = []; </span>}</span>
<span class="cstat-no" title="statement not covered" >    this.callbacks.push(callback);</span>
};
&nbsp;
ProxyListener.prototype.off = <span class="fstat-no" title="function not covered" >function (callback) {</span>
<span class="cstat-no" title="statement not covered" >    if (this.callbacks===null) { <span class="cstat-no" title="statement not covered" >return; </span>}</span>
<span class="cstat-no" title="statement not covered" >    var i = this.callbacks.indexOf(callback);</span>
<span class="cstat-no" title="statement not covered" >    if (i!==-1) {</span>
<span class="cstat-no" title="statement not covered" >        this.callbacks.splice(i,1);</span>
    } else {
<span class="cstat-no" title="statement not covered" >        console.warn('listener unknown', callback);</span>
    }
};
&nbsp;
module.exports = ProxyListener;
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/ReactMixin.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/ReactMixin.js</span></h1>
    <h2>
        
        Statements: <span class="metric">9.38% <small>(3 / 32)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 22)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 4)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">9.38% <small>(3 / 32)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/node_modules/swarm/lib/</a> &#187; ReactMixin.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
&nbsp;
var env = require('./env');
var Spec = require('./Spec');
&nbsp;
module.exports = {
&nbsp;
    deliver: <span class="fstat-no" title="function not covered" >function (spec,val,source) {</span>
<span class="cstat-no" title="statement not covered" >        var sync = this.sync;</span>
<span class="cstat-no" title="statement not covered" >        var version = sync._version;</span>
<span class="cstat-no" title="statement not covered" >        if (this.props.listenEntries) {</span>
<span class="cstat-no" title="statement not covered" >            var opId = '!' + spec.version();</span>
<span class="cstat-no" title="statement not covered" >            if (version !== opId) {</span>
<span class="cstat-no" title="statement not covered" >                version = opId;</span>
            }
        }
<span class="cstat-no" title="statement not covered" >        this.setState({version: version});</span>
    },
&nbsp;
    componentWillMount: <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >        var spec = this.props.spec || this.props.key;</span>
<span class="cstat-no" title="statement not covered" >        if (!Spec.is(spec)) {</span>
<span class="cstat-no" title="statement not covered" >            if (spec &amp;&amp; this.constructor.modelType) {</span>
<span class="cstat-no" title="statement not covered" >                var id = spec;</span>
<span class="cstat-no" title="statement not covered" >                spec = new Spec(this.constructor.modelType,'/'); </span>// TODO fn!!!
<span class="cstat-no" title="statement not covered" >                spec = spec.add(id,'#');</span>
            } else {
<span class="cstat-no" title="statement not covered" >                throw new Error('not a specifier: '+spec+' at '+this._rootNodeID);</span>
            }
        }
<span class="cstat-no" title="statement not covered" >        this.sync = env.localhost.get(spec);</span>
<span class="cstat-no" title="statement not covered" >        this.setState({version:''});</span>
<span class="cstat-no" title="statement not covered" >        if (!env.isServer) {</span>
<span class="cstat-no" title="statement not covered" >            var sync = this.sync;</span>
<span class="cstat-no" title="statement not covered" >            sync.on('init', this); </span>// TODO single listener
<span class="cstat-no" title="statement not covered" >            sync.on(this);</span>
<span class="cstat-no" title="statement not covered" >            if (this.props.listenEntries) {</span>
<span class="cstat-no" title="statement not covered" >                sync.onObjectEvent(this);</span>
            }
        }
    },
&nbsp;
    componentWillUnmount: <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >        if (!env.isServer) {</span>
<span class="cstat-no" title="statement not covered" >            var sync = this.sync;</span>
<span class="cstat-no" title="statement not covered" >            sync.off(this);</span>
<span class="cstat-no" title="statement not covered" >            sync.off(this); </span>// FIXME: remove after TODO: prevent second subscription
<span class="cstat-no" title="statement not covered" >            if (this.props.listenEntries) {</span>
<span class="cstat-no" title="statement not covered" >                sync.offObjectEvent(this);</span>
            }
        }
    },
&nbsp;
    shouldComponentUpdate: <span class="fstat-no" title="function not covered" >function (nextProps, nextState) {</span>
<span class="cstat-no" title="statement not covered" >        return this.props !== nextProps || this.state.version !== nextState.version;</span>
    }
&nbsp;
};
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/SecondPreciseClock.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/SecondPreciseClock.js</span></h1>
    <h2>
        
        Statements: <span class="metric">16.67% <small>(12 / 72)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 28)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 8)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">18.46% <small>(12 / 65)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/node_modules/swarm/lib/</a> &#187; SecondPreciseClock.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
&nbsp;
var Spec = require('./Spec');
&nbsp;
/** Swarm is based on the Lamport model of time and events in a
  * distributed system, so Lamport timestamps are essential to
  * its functioning. In most of the cases, it is useful to
  * use actuall wall clock time to create timestamps. This
  * class creates second-precise Lamport timestamps.
  * Timestamp ordering is alphanumeric, length may vary.
  *
  * @param processId id of the process/clock to add to every
  *        timestamp (like !timeseq+gritzko~ssn, where gritzko
  *        is the user and ssn is a session id, so processId
  *        is "gritzko~ssn").
  * @param initTime normally, that is server-supplied timestamp
  *        to init our time offset; there is no guarantee about
  *        clock correctness on the client side
  */
var SecondPreciseClock = <span class="fstat-no" title="function not covered" >function (processId, timeOffsetMs) {</span>
<span class="cstat-no" title="statement not covered" >    if (!Spec.reTok.test(processId)) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error('invalid process id: '+processId);</span>
    }
<span class="cstat-no" title="statement not covered" >    this.id = processId;</span>
    // sometimes we assume our local clock has some offset
<span class="cstat-no" title="statement not covered" >    this.clockOffsetMs = 0;</span>
<span class="cstat-no" title="statement not covered" >    this.lastTimestamp = '';</span>
    // although we try hard to use wall clock time, we must
    // obey Lamport logical clock rules, in particular our
    // timestamps must be greater than any other timestamps
    // previously seen
<span class="cstat-no" title="statement not covered" >    this.lastTimeSeen = 0;</span>
<span class="cstat-no" title="statement not covered" >    this.lastSeqSeen = 0;</span>
<span class="cstat-no" title="statement not covered" >    if (timeOffsetMs) {</span>
<span class="cstat-no" title="statement not covered" >        this.clockOffsetMs = timeOffsetMs;</span>
    }
};
&nbsp;
var epochDate = new Date("Wed, 01 Jan 2014 00:00:00 GMT");
SecondPreciseClock.EPOCH = epochDate.getTime();
&nbsp;
SecondPreciseClock.prototype.adjustTime = <span class="fstat-no" title="function not covered" >function (trueMs) {</span>
<span class="cstat-no" title="statement not covered" >    var localTime = this.ms();</span>
<span class="cstat-no" title="statement not covered" >    var clockOffsetMs = trueMs - localTime;</span>
<span class="cstat-no" title="statement not covered" >    this.clockOffsetMs = clockOffsetMs;</span>
<span class="cstat-no" title="statement not covered" >    var lastTS = this.lastTimeSeen;</span>
<span class="cstat-no" title="statement not covered" >    this.lastTimeSeen = 0;</span>
<span class="cstat-no" title="statement not covered" >    this.lastSeqSeen = 0;</span>
<span class="cstat-no" title="statement not covered" >    this.lastTimestamp = '';</span>
<span class="cstat-no" title="statement not covered" >    if ( this.seconds()+1 &lt; lastTS ) {</span>
<span class="cstat-no" title="statement not covered" >        console.error("risky clock reset",this.lastTimestamp);</span>
    }
};
&nbsp;
SecondPreciseClock.prototype.ms = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >    var millis = new Date().getTime();</span>
<span class="cstat-no" title="statement not covered" >    millis -= SecondPreciseClock.EPOCH;</span>
<span class="cstat-no" title="statement not covered" >    return millis;</span>
};
&nbsp;
SecondPreciseClock.prototype.seconds = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >    var millis = this.ms();</span>
<span class="cstat-no" title="statement not covered" >    millis += this.clockOffsetMs;</span>
<span class="cstat-no" title="statement not covered" >    return (millis/1000) | 0;</span>
};
&nbsp;
SecondPreciseClock.prototype.issueTimestamp = <span class="fstat-no" title="function not covered" >function time () {</span>
<span class="cstat-no" title="statement not covered" >    var res = this.seconds();</span>
<span class="cstat-no" title="statement not covered" >    if (this.lastTimeSeen&gt;res) { <span class="cstat-no" title="statement not covered" >res = this.lastTimeSeen; </span>}</span>
<span class="cstat-no" title="statement not covered" >    if (res&gt;this.lastTimeSeen) { <span class="cstat-no" title="statement not covered" >this.lastSeqSeen = -1; </span>}</span>
<span class="cstat-no" title="statement not covered" >    this.lastTimeSeen = res;</span>
<span class="cstat-no" title="statement not covered" >    var seq = ++this.lastSeqSeen;</span>
<span class="cstat-no" title="statement not covered" >    if (seq&gt;=(1&lt;&lt;12)) {<span class="cstat-no" title="statement not covered" >throw new Error('max event freq is 4000Hz');}</span></span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    var baseTimeSeq = Spec.int2base(res, 5);</span>
<span class="cstat-no" title="statement not covered" >    if (seq&gt;0) { <span class="cstat-no" title="statement not covered" >baseTimeSeq+=Spec.int2base(seq, 2); </span>}</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    this.lastTimestamp = baseTimeSeq + '+' + this.id;</span>
<span class="cstat-no" title="statement not covered" >    return this.lastTimestamp;</span>
};
&nbsp;
//SecondPreciseClock.reQTokExt = new RegExp(Spec.rsTokExt); // no 'g'
&nbsp;
SecondPreciseClock.prototype.parseTimestamp = <span class="fstat-no" title="function not covered" >function parse (ts) {</span>
<span class="cstat-no" title="statement not covered" >    var m = ts.match(Spec.reTokExt);</span>
<span class="cstat-no" title="statement not covered" >    if (!m) {<span class="cstat-no" title="statement not covered" >throw new Error('malformed timestamp: '+ts);}</span></span>
<span class="cstat-no" title="statement not covered" >    var timeseq=m[1]; </span>//, process=m[2];
<span class="cstat-no" title="statement not covered" >    var time = timeseq.substr(0,5), seq = timeseq.substr(5);</span>
<span class="cstat-no" title="statement not covered" >    if (seq&amp;&amp;seq.length!==2) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error('malformed timestamp value: '+timeseq);</span>
    }
<span class="cstat-no" title="statement not covered" >    return {</span>
        time: Spec.base2int(time),
        seq: seq ? Spec.base2int(seq) : 0
    };
};
&nbsp;
/** Freshly issued Lamport logical tiemstamps must be greater than
    any timestamps previously seen. */
SecondPreciseClock.prototype.checkTimestamp = <span class="fstat-no" title="function not covered" >function see (ts) {</span>
<span class="cstat-no" title="statement not covered" >    if (ts&lt;this.lastTimestamp) { <span class="cstat-no" title="statement not covered" >return true; </span>}</span>
<span class="cstat-no" title="statement not covered" >    var parsed = this.parseTimestamp(ts);</span>
<span class="cstat-no" title="statement not covered" >    if (parsed.time&lt;this.lastTimeSeen) { <span class="cstat-no" title="statement not covered" >return true; </span>}</span>
<span class="cstat-no" title="statement not covered" >    var sec = this.seconds();</span>
<span class="cstat-no" title="statement not covered" >    if (parsed.time&gt;sec+1) {</span>
<span class="cstat-no" title="statement not covered" >        return false; </span>// back to the future
    }
<span class="cstat-no" title="statement not covered" >    this.lastTimeSeen = parsed.time;</span>
<span class="cstat-no" title="statement not covered" >    this.lastSeqSeen = parsed.seq;</span>
<span class="cstat-no" title="statement not covered" >    return true;</span>
};
&nbsp;
SecondPreciseClock.prototype.timestamp2date = <span class="fstat-no" title="function not covered" >function (ts) {</span>
<span class="cstat-no" title="statement not covered" >    var parsed = this.parseTimestamp(ts);</span>
<span class="cstat-no" title="statement not covered" >    var millis = parsed.time * 1000 + SecondPreciseClock.EPOCH;</span>
<span class="cstat-no" title="statement not covered" >    return new Date(millis);</span>
};
&nbsp;
&nbsp;
module.exports = SecondPreciseClock;
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/Set.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/Set.js</span></h1>
    <h2>
        
        Statements: <span class="metric">9.86% <small>(7 / 71)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 26)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 16)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">9.86% <small>(7 / 71)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/node_modules/swarm/lib/</a> &#187; Set.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
&nbsp;
var env = require('./env');
var Spec = require('./Spec');
var Syncable = require('./Syncable');
var Model = require('./Model'); // TODO
var ProxyListener = require('./ProxyListener');
var CollectionMethodsMixin = require('./CollectionMethodsMixin');
&nbsp;
/**
 * Backbone's Collection is essentially an array and arrays behave poorly
 * under concurrent writes (see OT). Hence, our primary collection type
 * is a {id:Model} Set. One may obtain a linearized version by sorting
 * them by keys or otherwise.
 * This basic Set implementation can only store objects of the same type.
 * @constructor
 */
module.exports = Syncable.extend('Set', {
&nbsp;
    defaults: {
        _objects: Object,
        _oplog: Object,
        _proxy: ProxyListener
    },
&nbsp;
    mixins: [
        CollectionMethodsMixin
    ],
&nbsp;
    reactions: {
        init: <span class="fstat-no" title="function not covered" >function (spec,val,src) {</span>
<span class="cstat-no" title="statement not covered" >            this.forEach(<span class="fstat-no" title="function not covered" >function (obj) {</span></span>
<span class="cstat-no" title="statement not covered" >                obj.on(this._proxy);</span>
            }, this);
        }
    },
&nbsp;
    ops: {
        /**
         * Both Model and Set are oplog-only; they never pass the state on the wire,
         * only the oplog; new replicas are booted with distilled oplog as well.
         * So, this is the only point in the code that mutates the state of a Set.
         */
        change: <span class="fstat-no" title="function not covered" >function (spec, value, repl) {</span>
<span class="cstat-no" title="statement not covered" >            value = this.distillOp(spec, value);</span>
<span class="cstat-no" title="statement not covered" >            var key_spec;</span>
<span class="cstat-no" title="statement not covered" >            for (key_spec in value) {</span>
<span class="cstat-no" title="statement not covered" >                if (value[key_spec] === 1) {</span>
<span class="cstat-no" title="statement not covered" >                    if (!this._objects[key_spec]) { // only if object not in the set</span>
<span class="cstat-no" title="statement not covered" >                        this._objects[key_spec] = this._host.get(key_spec);</span>
<span class="cstat-no" title="statement not covered" >                        this._objects[key_spec].on(this._proxy);</span>
                    }
                } else <span class="cstat-no" title="statement not covered" >if (value[key_spec] === 0) {</span>
<span class="cstat-no" title="statement not covered" >                    if (this._objects[key_spec]) {</span>
<span class="cstat-no" title="statement not covered" >                        this._objects[key_spec].off(this._proxy);</span>
<span class="cstat-no" title="statement not covered" >                        delete this._objects[key_spec];</span>
                    }
                } else {
<span class="cstat-no" title="statement not covered" >                    env.log(this.spec(), 'unexpected val', JSON.stringify(value));</span>
                }
            }
        }
    },
&nbsp;
    validate: <span class="fstat-no" title="function not covered" >function (spec, val, src) {</span>
<span class="cstat-no" title="statement not covered" >        if (spec.op() !== 'change') {</span>
<span class="cstat-no" title="statement not covered" >            return '';</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        for (var key_spec in val) {</span>
            // member spec validity
<span class="cstat-no" title="statement not covered" >            if (Spec.pattern(key_spec) !== '/#') {</span>
<span class="cstat-no" title="statement not covered" >                return 'invalid spec: ' + key_spec;</span>
            }
        }
<span class="cstat-no" title="statement not covered" >        return '';</span>
    },
&nbsp;
    distillOp: <span class="fstat-no" title="function not covered" >function (spec, val) {</span>
<span class="cstat-no" title="statement not covered" >        if (spec.version() &gt; this._version) {</span>
<span class="cstat-no" title="statement not covered" >            return val; </span>// no concurrent op
        }
<span class="cstat-no" title="statement not covered" >        var opkey = spec.filter('!.');</span>
<span class="cstat-no" title="statement not covered" >        this._oplog[opkey] = val;</span>
<span class="cstat-no" title="statement not covered" >        this.distillLog(); </span>// may amend the value
<span class="cstat-no" title="statement not covered" >        return this._oplog[opkey] || {};</span>
    },
&nbsp;
    distillLog: Model.prototype.distillLog,
&nbsp;
    pojo: <span class="fstat-no" title="function not covered" >function () {</span>
        // invoke super.pojo()
<span class="cstat-no" title="statement not covered" >        var result = Syncable._pt.pojo.apply(this, arguments);</span>
<span class="cstat-no" title="statement not covered" >        result.entries = Object.keys(this._objects);</span>
<span class="cstat-no" title="statement not covered" >        return result;</span>
    },
&nbsp;
    /**
     * Adds an object to the set.
     * @param {Syncable} obj the object  //TODO , its id or its specifier.
     */
    addObject: <span class="fstat-no" title="function not covered" >function (obj) {</span>
<span class="cstat-no" title="statement not covered" >        var specs = {};</span>
<span class="cstat-no" title="statement not covered" >        specs[obj.spec()] = 1;</span>
<span class="cstat-no" title="statement not covered" >        this.change(specs);</span>
    },
    // FIXME reactions to emit .add, .remove
&nbsp;
    removeObject: <span class="fstat-no" title="function not covered" >function (obj) {</span>
<span class="cstat-no" title="statement not covered" >        var spec = obj._id ? obj.spec() : new Spec(obj).filter('/#');</span>
<span class="cstat-no" title="statement not covered" >        if (spec.pattern() !== '/#') {</span>
<span class="cstat-no" title="statement not covered" >            throw new Error('invalid spec: ' + spec);</span>
        }
<span class="cstat-no" title="statement not covered" >        var specs = {};</span>
<span class="cstat-no" title="statement not covered" >        specs[spec] = 0;</span>
<span class="cstat-no" title="statement not covered" >        this.change(specs);</span>
    },
&nbsp;
    /**
     * @param {Spec|string} key_spec key (specifier)
     * @returns {Syncable} object by key
     */
    get: <span class="fstat-no" title="function not covered" >function (key_spec) {</span>
<span class="cstat-no" title="statement not covered" >        key_spec = new Spec(key_spec).filter('/#');</span>
<span class="cstat-no" title="statement not covered" >        if (key_spec.pattern() !== '/#') {</span>
<span class="cstat-no" title="statement not covered" >            throw new Error("invalid spec");</span>
        }
<span class="cstat-no" title="statement not covered" >        return this._objects[key_spec];</span>
    },
&nbsp;
    /**
     * @param {function?} order
     * @returns {Array} sorted list of objects currently in set
     */
    list: <span class="fstat-no" title="function not covered" >function (order) {</span>
<span class="cstat-no" title="statement not covered" >        var ret = [];</span>
<span class="cstat-no" title="statement not covered" >        for (var key in this._objects) {</span>
<span class="cstat-no" title="statement not covered" >            ret.push(this._objects[key]);</span>
        }
<span class="cstat-no" title="statement not covered" >        ret.sort(order);</span>
<span class="cstat-no" title="statement not covered" >        return ret;</span>
    },
&nbsp;
    forEach: <span class="fstat-no" title="function not covered" >function (cb, thisArg) {</span>
<span class="cstat-no" title="statement not covered" >        var index = 0;</span>
<span class="cstat-no" title="statement not covered" >        for (var spec in this._objects) {</span>
<span class="cstat-no" title="statement not covered" >            cb.call(thisArg, this._objects[spec], index++);</span>
        }
    },
&nbsp;
    every: <span class="fstat-no" title="function not covered" >function (cb, thisArg) {</span>
<span class="cstat-no" title="statement not covered" >        var index = 0;</span>
<span class="cstat-no" title="statement not covered" >        for (var spec in this._objects) {</span>
<span class="cstat-no" title="statement not covered" >            if (!cb.call(thisArg, this._objects[spec], index++)) {</span>
<span class="cstat-no" title="statement not covered" >                return false;</span>
            }
        }
<span class="cstat-no" title="statement not covered" >        return true;</span>
    },
&nbsp;
    filter: <span class="fstat-no" title="function not covered" >function (cb, thisArg) {</span>
<span class="cstat-no" title="statement not covered" >        var res = [];</span>
<span class="cstat-no" title="statement not covered" >        this.forEach(<span class="fstat-no" title="function not covered" >function (entry, idx) {</span></span>
<span class="cstat-no" title="statement not covered" >            if (cb.call(thisArg, entry, idx)) {</span>
<span class="cstat-no" title="statement not covered" >                res.push(entry);</span>
            }
        });
<span class="cstat-no" title="statement not covered" >        return res;</span>
    },
&nbsp;
    map: <span class="fstat-no" title="function not covered" >function (cb, thisArg) {</span>
<span class="cstat-no" title="statement not covered" >        var res = [];</span>
<span class="cstat-no" title="statement not covered" >        this.forEach(<span class="fstat-no" title="function not covered" >function (entry, idx) {</span></span>
<span class="cstat-no" title="statement not covered" >            res.push(cb.call(thisArg, entry, idx));</span>
        });
<span class="cstat-no" title="statement not covered" >        return res;</span>
    }
});
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/SharedWebStorage.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/SharedWebStorage.js</span></h1>
    <h2>
        
        Statements: <span class="metric">16.67% <small>(14 / 84)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 39)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 9)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">17.07% <small>(14 / 82)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/node_modules/swarm/lib/</a> &#187; SharedWebStorage.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
var Spec = require('./Spec');
var Storage = require('./Storage');
&nbsp;
&nbsp;
/** SharedWebStorage may use localStorage or sessionStorage
 *  to cache data. The role of ShWS is dual: it may also
 *  bridge ops from one browser tab/window to another using
 *  HTML5 onstorage events. */
<span class="fstat-no" title="function not covered" >function SharedWebStorage(id, options) {</span>
<span class="cstat-no" title="statement not covered" >    this.options = options || {};</span>
<span class="cstat-no" title="statement not covered" >    this.lstn = {};</span>
<span class="cstat-no" title="statement not covered" >    this._id = id;</span>
<span class="cstat-no" title="statement not covered" >    this.tails = {};</span>
<span class="cstat-no" title="statement not covered" >    this.store = this.options.persistent ?</span>
        window.localStorage : window.sessionStorage;
&nbsp;
<span class="cstat-no" title="statement not covered" >    this.loadLog();</span>
<span class="cstat-no" title="statement not covered" >    this.installListeners();</span>
}
&nbsp;
SharedWebStorage.prototype = new Storage();
SharedWebStorage.prototype.isRoot = false;
module.exports = SharedWebStorage;
&nbsp;
&nbsp;
SharedWebStorage.prototype.onOp = <span class="fstat-no" title="function not covered" >function (spec, value) {</span>
<span class="cstat-no" title="statement not covered" >    var ti = spec.filter('/#');</span>
<span class="cstat-no" title="statement not covered" >    var vo = spec.filter('!.');</span>
<span class="cstat-no" title="statement not covered" >    if (!vo.toString()) {</span>
<span class="cstat-no" title="statement not covered" >        return; </span>// state, not an op
    }
<span class="cstat-no" title="statement not covered" >    var tail = this.tails[ti];</span>
<span class="cstat-no" title="statement not covered" >    if (!tail) {</span>
<span class="cstat-no" title="statement not covered" >        tail = this.tails[ti] = [];</span>
    } else <span class="cstat-no" title="statement not covered" >if (tail.indexOf(vo)!==-1) {</span>
<span class="cstat-no" title="statement not covered" >        return; </span>// replay
    }
<span class="cstat-no" title="statement not covered" >    tail.push(vo);</span>
<span class="cstat-no" title="statement not covered" >    this.emit(spec,value);</span>
};
&nbsp;
&nbsp;
SharedWebStorage.prototype.installListeners = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >    var self = this;</span>
<span class="fstat-no" title="function not covered" >    function onStorageChange(ev) {</span>
<span class="cstat-no" title="statement not covered" >        if (Spec.is(ev.key) &amp;&amp; ev.newValue) {</span>
<span class="cstat-no" title="statement not covered" >            self.onOp(new Spec(ev.key), JSON.parse(ev.newValue));</span>
        }
    }
<span class="cstat-no" title="statement not covered" >    window.addEventListener('storage', onStorageChange, false);</span>
};
&nbsp;
&nbsp;
SharedWebStorage.prototype.loadLog = <span class="fstat-no" title="function not covered" >function () {</span>
    // scan/sort specs for existing records
<span class="cstat-no" title="statement not covered" >    var store = this.store;</span>
<span class="cstat-no" title="statement not covered" >    var ti;</span>
<span class="cstat-no" title="statement not covered" >    for (var i = 0; i &lt; store.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >        var key = store.key(i);</span>
<span class="cstat-no" title="statement not covered" >        if (!Spec.is(key)) { <span class="cstat-no" title="statement not covered" >continue; </span>}</span>
<span class="cstat-no" title="statement not covered" >        var spec = new Spec(key);</span>
<span class="cstat-no" title="statement not covered" >        if (spec.pattern() !== '/#!.') {</span>
<span class="cstat-no" title="statement not covered" >            continue; </span>// ops only
        }
<span class="cstat-no" title="statement not covered" >        ti = spec.filter('/#');</span>
<span class="cstat-no" title="statement not covered" >        var tail = this.tails[ti];</span>
<span class="cstat-no" title="statement not covered" >        if (!tail) {</span>
<span class="cstat-no" title="statement not covered" >            tail = this.tails[ti] = [];</span>
        }
<span class="cstat-no" title="statement not covered" >        tail.push(spec.filter('!.'));</span>
    }
<span class="cstat-no" title="statement not covered" >    for (ti in this.tails) {</span>
<span class="cstat-no" title="statement not covered" >        this.tails[ti].sort();</span>
    }
};
&nbsp;
&nbsp;
SharedWebStorage.prototype.writeOp = <span class="fstat-no" title="function not covered" >function wsOp(spec, value, src) {</span>
<span class="cstat-no" title="statement not covered" >    var ti = spec.filter('/#');</span>
<span class="cstat-no" title="statement not covered" >    var vm = spec.filter('!.');</span>
<span class="cstat-no" title="statement not covered" >    var tail = this.tails[ti] || (this.tails[ti] = []);</span>
<span class="cstat-no" title="statement not covered" >    tail.push(vm);</span>
<span class="cstat-no" title="statement not covered" >    var json = JSON.stringify(value);</span>
<span class="cstat-no" title="statement not covered" >    this.store.setItem(spec, json);</span>
<span class="cstat-no" title="statement not covered" >    if (this.options.trigger) {</span>
<span class="cstat-no" title="statement not covered" >        var otherStore = !this.options.persistent ?</span>
            window.localStorage : window.sessionStorage;
<span class="cstat-no" title="statement not covered" >        if (!otherStore.getItem(spec)) {</span>
<span class="cstat-no" title="statement not covered" >            otherStore.setItem(spec,json);</span>
<span class="cstat-no" title="statement not covered" >            otherStore.removeItem(spec,json);</span>
        }
    }
};
&nbsp;
&nbsp;
SharedWebStorage.prototype.writeState = <span class="fstat-no" title="function not covered" >function wsPatch(spec, state, src) {</span>
<span class="cstat-no" title="statement not covered" >    var ti = spec.filter('/#');</span>
<span class="cstat-no" title="statement not covered" >    this.store.setItem(ti, JSON.stringify(state));</span>
<span class="cstat-no" title="statement not covered" >    var tail = this.tails[ti];</span>
<span class="cstat-no" title="statement not covered" >    if (tail) {</span>
<span class="cstat-no" title="statement not covered" >        for(var k=0; k&lt;tail.length; k++) {</span>
<span class="cstat-no" title="statement not covered" >            this.store.removeItem(ti + tail[k]);</span>
        }
<span class="cstat-no" title="statement not covered" >        delete this.tails[ti];</span>
    }
};
&nbsp;
SharedWebStorage.prototype.readState = <span class="fstat-no" title="function not covered" >function (spec, callback) {</span>
<span class="cstat-no" title="statement not covered" >    spec = new Spec(spec);</span>
<span class="cstat-no" title="statement not covered" >    var ti = spec.filter('/#');</span>
<span class="cstat-no" title="statement not covered" >    var state = this.store.getItem(ti);</span>
<span class="cstat-no" title="statement not covered" >    callback(null, (state&amp;&amp;JSON.parse(state)) || null);</span>
};
&nbsp;
SharedWebStorage.prototype.readOps = <span class="fstat-no" title="function not covered" >function (ti, callback) {</span>
<span class="cstat-no" title="statement not covered" >    var tail = this.tails[ti];</span>
<span class="cstat-no" title="statement not covered" >    var parsed = null;</span>
<span class="cstat-no" title="statement not covered" >    for(var k=0; tail &amp;&amp; k&lt;tail.length; k++) {</span>
<span class="cstat-no" title="statement not covered" >        var spec = tail[k];</span>
<span class="cstat-no" title="statement not covered" >        var value = this.store.getItem(ti+spec);</span>
<span class="cstat-no" title="statement not covered" >        if (!value) {<span class="cstat-no" title="statement not covered" >continue;}</span> </span>// it happens
<span class="cstat-no" title="statement not covered" >        parsed = parsed || {};</span>
<span class="cstat-no" title="statement not covered" >        parsed[spec] = JSON.parse(value);</span>
    }
<span class="cstat-no" title="statement not covered" >    callback(null, parsed);</span>
};
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/SockJSServerStream.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/SockJSServerStream.js</span></h1>
    <h2>
        
        Statements: <span class="metric">17.39% <small>(4 / 23)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 14)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 5)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">18.18% <small>(4 / 22)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/node_modules/swarm/lib/</a> &#187; SockJSServerStream.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
&nbsp;
<span class="fstat-no" title="function not covered" >function SockJSStream(ws) {</span>
<span class="cstat-no" title="statement not covered" >    var ln = this.lstn = {},</span>
        buf = [];
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (typeof ws === 'string') { // url passed</span>
<span class="cstat-no" title="statement not covered" >        throw new Error('client-side connections not supported yet');</span>
    }
<span class="cstat-no" title="statement not covered" >    this.ws = ws;</span>
<span class="cstat-no" title="statement not covered" >    if (ws.readyState !== 1/*WebSocket.OPEN*/) {</span>
<span class="cstat-no" title="statement not covered" >        this.buf = buf; </span>//will wait for "open"
    }
<span class="cstat-no" title="statement not covered" >    ws.on('close', <span class="fstat-no" title="function not covered" >function () {</span> <span class="cstat-no" title="statement not covered" >ln.close &amp;&amp; ln.close(); </span>});</span>
<span class="cstat-no" title="statement not covered" >    ws.on('data', <span class="fstat-no" title="function not covered" >function (msg) {</span></span>
<span class="cstat-no" title="statement not covered" >        try {</span>
<span class="cstat-no" title="statement not covered" >            ln.data &amp;&amp; ln.data(msg);</span>
        } catch (ex) {
<span class="cstat-no" title="statement not covered" >            console.error('message processing fails', ex);</span>
<span class="cstat-no" title="statement not covered" >            ln.error &amp;&amp; ln.error(ex.message);</span>
        }
    });
}
&nbsp;
module.exports = SockJSStream;
&nbsp;
SockJSStream.prototype.on = <span class="fstat-no" title="function not covered" >function (evname, fn) {</span>
<span class="cstat-no" title="statement not covered" >    if (evname in this.lstn) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error('not supported');</span>
    }
<span class="cstat-no" title="statement not covered" >    this.lstn[evname] = fn;</span>
};
&nbsp;
SockJSStream.prototype.write = <span class="fstat-no" title="function not covered" >function (data) {</span>
<span class="cstat-no" title="statement not covered" >    if (this.buf) {</span>
<span class="cstat-no" title="statement not covered" >        this.buf.push(data.toString());</span>
    } else {
<span class="cstat-no" title="statement not covered" >        this.ws.write(data.toString());</span>
    }
};
&nbsp;
//TODO SockJS-client env.streams.ws = env.streams.wss = SockJSStream;
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/SockJSStream.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/SockJSStream.js</span></h1>
    <h2>
        
        Statements: <span class="metric">6.45% <small>(2 / 31)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 8)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 7)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">6.67% <small>(2 / 30)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/node_modules/swarm/lib/</a> &#187; SockJSStream.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
&nbsp;
var SockJS = require('sockjs-client');
<span class="cstat-no" title="statement not covered" >var Swarm = require('swarm');</span>
<span class="cstat-no" title="statement not covered" >var env = Swarm.env;</span>
&nbsp;
<span class="fstat-no" title="function not covered" >function SockJSStream(url) {</span>
<span class="cstat-no" title="statement not covered" >    var self = this;</span>
<span class="cstat-no" title="statement not covered" >    var ln = this.lstn = {};</span>
<span class="cstat-no" title="statement not covered" >    this.url = url.replace(/^ws(s?):/, 'http$1:');</span>
<span class="cstat-no" title="statement not covered" >    var ws = this.ws = new SockJS(this.url);</span>
<span class="cstat-no" title="statement not covered" >    var buf = this.buf = [];</span>
<span class="cstat-no" title="statement not covered" >    ws.onopen = <span class="fstat-no" title="function not covered" >function () {</span></span>
<span class="cstat-no" title="statement not covered" >        buf.reverse();</span>
<span class="cstat-no" title="statement not covered" >        self.buf = null;</span>
<span class="cstat-no" title="statement not covered" >        while (buf.length) {</span>
<span class="cstat-no" title="statement not covered" >            self.write(buf.pop());</span>
        }
    };
<span class="cstat-no" title="statement not covered" >    ws.onclose = <span class="fstat-no" title="function not covered" >function () {</span> <span class="cstat-no" title="statement not covered" >ln.close &amp;&amp; ln.close(); </span>};</span>
<span class="cstat-no" title="statement not covered" >    ws.onmessage = <span class="fstat-no" title="function not covered" >function (msg) {</span></span>
<span class="cstat-no" title="statement not covered" >        ln.data &amp;&amp; ln.data(msg.data);</span>
    };
}
&nbsp;
<span class="cstat-no" title="statement not covered" >SockJSStream.prototype.on = <span class="fstat-no" title="function not covered" >function (evname, fn) {</span></span>
<span class="cstat-no" title="statement not covered" >    if (evname in this.lstn) {</span>
<span class="cstat-no" title="statement not covered" >        var self = this,</span>
            prev_fn = this.lstn[evname];
<span class="cstat-no" title="statement not covered" >        this.lstn[evname] = <span class="fstat-no" title="function not covered" >function () {</span></span>
<span class="cstat-no" title="statement not covered" >            prev_fn.apply(self, arguments);</span>
<span class="cstat-no" title="statement not covered" >            fn.apply(self, arguments);</span>
        };
    } else {
<span class="cstat-no" title="statement not covered" >        this.lstn[evname] = fn;</span>
    }
};
&nbsp;
<span class="cstat-no" title="statement not covered" >SockJSStream.prototype.write = <span class="fstat-no" title="function not covered" >function (data) {</span></span>
<span class="cstat-no" title="statement not covered" >    if (this.buf) {</span>
<span class="cstat-no" title="statement not covered" >        this.buf.push(data);</span>
    } else {
<span class="cstat-no" title="statement not covered" >        this.ws.send(data);</span>
    }
};
&nbsp;
<span class="cstat-no" title="statement not covered" >env.streams.ws = env.streams.wss = SockJSStream;</span>
<span class="cstat-no" title="statement not covered" >module.exports = SockJSStream;</span>
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/Spec.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/Spec.js</span></h1>
    <h2>
        
        Statements: <span class="metric">30.52% <small>(47 / 154)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">7.78% <small>(7 / 90)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">3.13% <small>(1 / 32)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">32.19% <small>(47 / 146)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/node_modules/swarm/lib/</a> &#187; Spec.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
&nbsp;
//  S P E C I F I E R
//
//  The Swarm aims to switch fully from the classic HTTP
//  request-response client-server interaction pattern to continuous
//  real-time synchronization (WebSocket), possibly involving
//  client-to-client interaction (WebRTC) and client-side storage
//  (WebStorage). That demands (a) unification of transfer and storage
//  where possible and (b) transferring, processing and storing of
//  fine-grained changes.
//
//  That's why we use compound event identifiers named *specifiers*
//  instead of just regular "plain" object ids everyone is so used to.
//  Our ids have to fully describe the context of every small change as
//  it is likely to be delivered, processed and stored separately from
//  the rest of the related state.  For every atomic operation, be it a
//  field mutation or a method invocation, a specifier contains its
//  class, object id, a method name and, most importantly, its
//  version id.
//
//  A serialized specifier is a sequence of Base64 tokens each prefixed
//  with a "quant". A quant for a class name is '/', an object id is
//  prefixed with '#', a method with '.' and a version id with '!'.  A
//  special quant '+' separates parts of each token.  For example, a
//  typical version id looks like "!7AMTc+gritzko" which corresponds to
//  a version created on Tue Oct 22 2013 08:05:59 GMT by @gritzko (see
//  Host.time()).
//
//  A full serialized specifier looks like
//        /TodoItem#7AM0f+gritzko.done!7AMTc+gritzko
//  (a todo item created by @gritzko was marked 'done' by himself)
//
//  Specifiers are stored in strings, but we use a lightweight wrapper
//  class Spec to parse them easily. A wrapper is immutable as we pass
//  specifiers around a lot.
&nbsp;
function Spec(str, quant) {
    <span class="missing-if-branch" title="if path not taken" >I</span>if (str &amp;&amp; str.constructor === Spec) {
<span class="cstat-no" title="statement not covered" >        str = str.value;</span>
    } else { // later we assume value has valid format
        str = (str || <span class="branch-1 cbranch-no" title="branch not covered" >'')</span>.toString();
        <span class="missing-if-branch" title="if path not taken" >I</span>if (quant &amp;&amp; <span class="branch-1 cbranch-no" title="branch not covered" >str.charAt(0) &gt;= '0')</span> {
<span class="cstat-no" title="statement not covered" >            str = quant + str;</span>
        }
        <span class="missing-if-branch" title="if path not taken" >I</span>if (str.replace(Spec.reQTokExt, '')) {
<span class="cstat-no" title="statement not covered" >            throw new Error('malformed specifier: ' + str);</span>
        }
    }
    this.value = str;
    this.index = 0;
}
module.exports = Spec;
&nbsp;
Spec.prototype.filter = <span class="fstat-no" title="function not covered" >function (quants) {</span>
<span class="cstat-no" title="statement not covered" >    var filterfn = //typeof(quants)==='function' ? quants :</span>
<span class="fstat-no" title="function not covered" >                function (token, quant) {</span>
<span class="cstat-no" title="statement not covered" >                    return quants.indexOf(quant) !== -1 ? token : '';</span>
                };
<span class="cstat-no" title="statement not covered" >    return new Spec(this.value.replace(Spec.reQTokExt, filterfn));</span>
};
Spec.pattern = <span class="fstat-no" title="function not covered" >function (spec) {</span>
<span class="cstat-no" title="statement not covered" >    return spec.toString().replace(Spec.reQTokExt, '$1');</span>
};
Spec.prototype.isEmpty = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >    return this.value==='';</span>
};
Spec.prototype.pattern = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >    return Spec.pattern(this.value);</span>
};
Spec.prototype.token = <span class="fstat-no" title="function not covered" >function (quant) {</span>
<span class="cstat-no" title="statement not covered" >    var at = quant ? this.value.indexOf(quant, this.index) : this.index;</span>
<span class="cstat-no" title="statement not covered" >    if (at === -1) {</span>
<span class="cstat-no" title="statement not covered" >        return undefined;</span>
    }
<span class="cstat-no" title="statement not covered" >    Spec.reQTokExt.lastIndex = at;</span>
<span class="cstat-no" title="statement not covered" >    var m = Spec.reQTokExt.exec(this.value);</span>
<span class="cstat-no" title="statement not covered" >    this.index = Spec.reQTokExt.lastIndex;</span>
<span class="cstat-no" title="statement not covered" >    if (!m) {</span>
<span class="cstat-no" title="statement not covered" >        return undefined;</span>
    }
<span class="cstat-no" title="statement not covered" >    return {quant: m[1], body: m[2], bare: m[3], ext: m[4]};</span>
};
Spec.prototype.get = <span class="fstat-no" title="function not covered" >function specGet(quant) {</span>
<span class="cstat-no" title="statement not covered" >    var i = this.value.indexOf(quant);</span>
<span class="cstat-no" title="statement not covered" >    if (i === -1) {</span>
<span class="cstat-no" title="statement not covered" >        return '';</span>
    }
<span class="cstat-no" title="statement not covered" >    Spec.reQTokExt.lastIndex = i;</span>
<span class="cstat-no" title="statement not covered" >    var m = Spec.reQTokExt.exec(this.value);</span>
<span class="cstat-no" title="statement not covered" >    return m &amp;&amp; m[2];</span>
};
Spec.prototype.tok = <span class="fstat-no" title="function not covered" >function specGet(quant) {</span>
<span class="cstat-no" title="statement not covered" >    var i = this.value.indexOf(quant);</span>
<span class="cstat-no" title="statement not covered" >    if (i === -1) { <span class="cstat-no" title="statement not covered" >return ''; </span>}</span>
<span class="cstat-no" title="statement not covered" >    Spec.reQTokExt.lastIndex = i;</span>
<span class="cstat-no" title="statement not covered" >    var m = Spec.reQTokExt.exec(this.value);</span>
<span class="cstat-no" title="statement not covered" >    return m &amp;&amp; m[0];</span>
};
Spec.prototype.has = <span class="fstat-no" title="function not covered" >function specHas(quant) {</span>
<span class="cstat-no" title="statement not covered" >    if (quant.length===1) {</span>
<span class="cstat-no" title="statement not covered" >        return this.value.indexOf(quant) !== -1;</span>
    } else {
<span class="cstat-no" title="statement not covered" >        var toks = this.value.match(Spec.reQTokExt);</span>
<span class="cstat-no" title="statement not covered" >        return toks.indexOf(quant) !== -1;</span>
    }
};
Spec.prototype.set = <span class="fstat-no" title="function not covered" >function specSet(spec, quant) {</span>
<span class="cstat-no" title="statement not covered" >    var ret = new Spec(spec, quant);</span>
<span class="cstat-no" title="statement not covered" >    var m;</span>
<span class="cstat-no" title="statement not covered" >    Spec.reQTokExt.lastIndex = 0;</span>
<span class="cstat-no" title="statement not covered" >    while (null !== (m = Spec.reQTokExt.exec(this.value))) {</span>
<span class="cstat-no" title="statement not covered" >        if (!ret.has(m[1])) {</span>
<span class="cstat-no" title="statement not covered" >            ret = ret.add(m[0]);</span>
        }
    }
<span class="cstat-no" title="statement not covered" >    return ret.sort();</span>
};
Spec.prototype.version = <span class="fstat-no" title="function not covered" >function () {</span> <span class="cstat-no" title="statement not covered" >return this.get('!'); </span>};
Spec.prototype.op = <span class="fstat-no" title="function not covered" >function () {</span> <span class="cstat-no" title="statement not covered" >return this.get('.'); </span>};
Spec.prototype.type = <span class="fstat-no" title="function not covered" >function () {</span> <span class="cstat-no" title="statement not covered" >return this.get('/'); </span>};
Spec.prototype.id = <span class="fstat-no" title="function not covered" >function () {</span> <span class="cstat-no" title="statement not covered" >return this.get('#'); </span>};
Spec.prototype.typeid = <span class="fstat-no" title="function not covered" >function () {</span> <span class="cstat-no" title="statement not covered" >return this.filter('/#'); </span>};
Spec.prototype.source = <span class="fstat-no" title="function not covered" >function () {</span> <span class="cstat-no" title="statement not covered" >return this.token('!').ext; </span>};
&nbsp;
Spec.prototype.sort = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="fstat-no" title="function not covered" >    function Q(a, b) {</span>
<span class="cstat-no" title="statement not covered" >        var qa = a.charAt(0), qb = b.charAt(0), q = Spec.quants;</span>
<span class="cstat-no" title="statement not covered" >        return (q.indexOf(qa) - q.indexOf(qb)) || (a &lt; b);</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    var split = this.value.match(Spec.reQTokExt);</span>
<span class="cstat-no" title="statement not covered" >    return new Spec(split ? split.sort(Q).join('') : '');</span>
};
&nbsp;
Spec.prototype.add = <span class="fstat-no" title="function not covered" >function (spec, quant) {</span>
<span class="cstat-no" title="statement not covered" >    if (spec.constructor !== Spec) {</span>
<span class="cstat-no" title="statement not covered" >        spec = new Spec(spec, quant);</span>
    }
<span class="cstat-no" title="statement not covered" >    return new Spec(this.value + spec.value);</span>
};
Spec.prototype.toString = <span class="fstat-no" title="function not covered" >function () {</span> <span class="cstat-no" title="statement not covered" >return this.value; </span>};
&nbsp;
&nbsp;
Spec.int2base = <span class="fstat-no" title="function not covered" >function (i, padlen) {</span>
<span class="cstat-no" title="statement not covered" >    if (i &lt; 0 || i &gt;= (1 &lt;&lt; 30)) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error('out of range');</span>
    }
<span class="cstat-no" title="statement not covered" >    var ret = '', togo = padlen || 5;</span>
<span class="cstat-no" title="statement not covered" >    for (; i || (togo &gt; 0); i &gt;&gt;= 6, togo--) {</span>
<span class="cstat-no" title="statement not covered" >        ret = Spec.base64.charAt(i &amp; 63) + ret;</span>
    }
<span class="cstat-no" title="statement not covered" >    return ret;</span>
};
&nbsp;
Spec.prototype.fits = <span class="fstat-no" title="function not covered" >function (specFilter) {</span>
<span class="cstat-no" title="statement not covered" >    var myToks = this.value.match(Spec.reQTokExt);</span>
<span class="cstat-no" title="statement not covered" >    var filterToks = specFilter.match(Spec.reQTokExt), tok;</span>
<span class="cstat-no" title="statement not covered" >    while (tok=filterToks.pop()) {</span>
<span class="cstat-no" title="statement not covered" >        if (myToks.indexOf(tok) === -1) {</span>
<span class="cstat-no" title="statement not covered" >            return false;</span>
        }
    }
<span class="cstat-no" title="statement not covered" >    return true;</span>
};
&nbsp;
Spec.base2int = <span class="fstat-no" title="function not covered" >function (base) {</span>
<span class="cstat-no" title="statement not covered" >    var ret = 0, l = base.match(Spec.re64l);</span>
<span class="cstat-no" title="statement not covered" >    for (var shift = 0; l.length; shift += 6) {</span>
<span class="cstat-no" title="statement not covered" >        ret += Spec.base64.indexOf(l.pop()) &lt;&lt; shift;</span>
    }
<span class="cstat-no" title="statement not covered" >    return ret;</span>
};
Spec.parseToken = <span class="fstat-no" title="function not covered" >function (token_body) {</span>
<span class="cstat-no" title="statement not covered" >    Spec.reTokExt.lastIndex = -1;</span>
<span class="cstat-no" title="statement not covered" >    var m = Spec.reTokExt.exec(token_body);</span>
<span class="cstat-no" title="statement not covered" >    if (!m) {</span>
<span class="cstat-no" title="statement not covered" >        return null;</span>
    }
<span class="cstat-no" title="statement not covered" >    return {bare: m[1], ext: m[2] || 'swarm'}; </span>// FIXME not generic
};
&nbsp;
Spec.base64 = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz~';
Spec.rT = '[0-9A-Za-z_~]{1,80}'; // 60*8 bits is enough for everyone
Spec.reTok = new RegExp('^'+Spec.rT+'$'); // plain no-extension token
Spec.re64l = new RegExp('[0-9A-Za-z_~]', 'g');
Spec.quants = ['/', '#', '!', '.'];
Spec.rsTokExt = '^(=)(?:\\+(=))?$'.replace(/=/g, Spec.rT);
Spec.reTokExt = new RegExp(Spec.rsTokExt);
Spec.rsQTokExt = '([/#\\.!\\*])((=)(?:\\+(=))?)'.replace(/=/g, Spec.rT);
Spec.reQTokExt = new RegExp(Spec.rsQTokExt, 'g');
Spec.is = <span class="fstat-no" title="function not covered" >function (str) {</span>
<span class="cstat-no" title="statement not covered" >    if (str === null || str === undefined) {</span>
<span class="cstat-no" title="statement not covered" >        return false;</span>
    }
<span class="cstat-no" title="statement not covered" >    return str.constructor === Spec || '' === str.toString().replace(Spec.reQTokExt, '');</span>
};
Spec.as = <span class="fstat-no" title="function not covered" >function (spec) {</span>
<span class="cstat-no" title="statement not covered" >    if (!spec) {</span>
<span class="cstat-no" title="statement not covered" >        return new Spec('');</span>
    } else {
<span class="cstat-no" title="statement not covered" >        return spec.constructor === Spec ? spec : new Spec(spec);</span>
    }
};
&nbsp;
Spec.Map = <span class="fstat-no" title="function not covered" >function VersionVectorAsAMap(vec) {</span>
<span class="cstat-no" title="statement not covered" >    this.map = {};</span>
<span class="cstat-no" title="statement not covered" >    if (vec) {</span>
<span class="cstat-no" title="statement not covered" >        this.add(vec);</span>
    }
};
Spec.Map.prototype.add = <span class="fstat-no" title="function not covered" >function (versionVector) {</span>
<span class="cstat-no" title="statement not covered" >    var vec = new Spec(versionVector, '!'), tok;</span>
<span class="cstat-no" title="statement not covered" >    while (undefined !== (tok = vec.token('!'))) {</span>
<span class="cstat-no" title="statement not covered" >        var time = tok.bare, source = tok.ext || 'swarm';</span>
<span class="cstat-no" title="statement not covered" >        if (time &gt; (this.map[source] || '')) {</span>
<span class="cstat-no" title="statement not covered" >            this.map[source] = time;</span>
        }
    }
};
Spec.Map.prototype.covers = <span class="fstat-no" title="function not covered" >function (version) {</span>
<span class="cstat-no" title="statement not covered" >    Spec.reTokExt.lastIndex = 0;</span>
<span class="cstat-no" title="statement not covered" >    var m = Spec.reTokExt.exec(version);</span>
<span class="cstat-no" title="statement not covered" >    var ts = m[1], src = m[2] || 'swarm';</span>
<span class="cstat-no" title="statement not covered" >    return ts &lt;= (this.map[src] || '');</span>
};
Spec.Map.prototype.maxTs = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >    var ts = null,</span>
        map = this.map;
<span class="cstat-no" title="statement not covered" >    for (var src in map) {</span>
<span class="cstat-no" title="statement not covered" >        if (!ts || ts &lt; map[src]) {</span>
<span class="cstat-no" title="statement not covered" >            ts = map[src];</span>
        }
    }
<span class="cstat-no" title="statement not covered" >    return ts;</span>
};
Spec.Map.prototype.toString = <span class="fstat-no" title="function not covered" >function (trim) {</span>
<span class="cstat-no" title="statement not covered" >    trim = trim || {top: 10, rot: '0'};</span>
<span class="cstat-no" title="statement not covered" >    var top = trim.top || 10,</span>
        rot = '!' + (trim.rot || '0'),
        ret = [],
        map = this.map;
<span class="cstat-no" title="statement not covered" >    for (var src in map) {</span>
<span class="cstat-no" title="statement not covered" >        ret.push('!' + map[src] + (src === 'swarm' ? '' : '+' + src));</span>
    }
<span class="cstat-no" title="statement not covered" >    ret.sort().reverse();</span>
<span class="cstat-no" title="statement not covered" >    while (ret.length &gt; top || ret[ret.length - 1] &lt;= rot) {</span>
<span class="cstat-no" title="statement not covered" >        ret.pop();</span>
    }
<span class="cstat-no" title="statement not covered" >    return ret.join('') || '!0';</span>
};
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/Storage.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/Storage.js</span></h1>
    <h2>
        
        Statements: <span class="metric">17.86% <small>(25 / 140)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">2.17% <small>(2 / 92)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">5.26% <small>(1 / 19)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">18.8% <small>(25 / 133)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/node_modules/swarm/lib/</a> &#187; Storage.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
&nbsp;
var Syncable = require('./Syncable');
&nbsp;
function Storage(async) {
    this.async = !!async || false;
    this.states = {};
    this.tails = {};
    this.counts = {};
    this._host = null;
    // many implementations do not push changes
    // so there are no listeners
    this.lstn = null;
    this._id = 'some_storage';
}
module.exports = Storage;
Storage.prototype.MAX_LOG_SIZE = 10;
Storage.prototype.isRoot = true; // may create global objects
&nbsp;
Storage.prototype.deliver = <span class="fstat-no" title="function not covered" >function (spec, value, src) {</span>
<span class="cstat-no" title="statement not covered" >    var ret;</span>
<span class="cstat-no" title="statement not covered" >    switch (spec.op()) {</span>
        // A storage is always an "uplink" so it never receives reon, reoff.
    case 'on':
<span class="cstat-no" title="statement not covered" >        ret = this.on(spec, value, src); <span class="cstat-no" title="statement not covered" ></span>break;</span>
    case 'off':
<span class="cstat-no" title="statement not covered" >        ret = this.off(spec, value, src); <span class="cstat-no" title="statement not covered" ></span>break;</span>
    case 'init':
<span class="cstat-no" title="statement not covered" >        if (value._version) { // state</span>
<span class="cstat-no" title="statement not covered" >            ret = this.init(spec, value, src);</span>
        } else { // patch
<span class="cstat-no" title="statement not covered" >            var ti = spec.filter('/#');</span>
<span class="cstat-no" title="statement not covered" >            var specs = [], s;</span>
<span class="cstat-no" title="statement not covered" >            for(s in value._tail) {  <span class="cstat-no" title="statement not covered" >specs.push(s); </span> }</span>
<span class="cstat-no" title="statement not covered" >            specs.sort();</span>
<span class="cstat-no" title="statement not covered" >            while (s=specs.pop()) {</span>
<span class="cstat-no" title="statement not covered" >                ret = this.anyOp( ti.add(s), value._tail[s], src);</span>
            }
        }
<span class="cstat-no" title="statement not covered" >        break;</span>
    default:
<span class="cstat-no" title="statement not covered" >        ret = this.anyOp(spec, value, src);</span>
    }
<span class="cstat-no" title="statement not covered" >    return ret;</span>
};
&nbsp;
Storage.prototype.on = <span class="fstat-no" title="function not covered" >function storageOn (spec, base, src) {</span>
<span class="cstat-no" title="statement not covered" >    var ti = spec.filter('/#');</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (this.lstn) {</span>
<span class="cstat-no" title="statement not covered" >        var ls = this.lstn[ti];</span>
<span class="cstat-no" title="statement not covered" >        if (ls === undefined) {</span>
<span class="cstat-no" title="statement not covered" >            ls = src;</span>
        } else <span class="cstat-no" title="statement not covered" >if (ls !== src) {</span>
<span class="cstat-no" title="statement not covered" >            if (ls.constructor !== Array) {</span>
<span class="cstat-no" title="statement not covered" >                ls = [ls];</span>
            }
<span class="cstat-no" title="statement not covered" >            ls.push(src);</span>
        }
<span class="cstat-no" title="statement not covered" >        this.lstn[ti] = ls;</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    var self = this;</span>
<span class="cstat-no" title="statement not covered" >    var state;</span>
<span class="cstat-no" title="statement not covered" >    var tail;</span>
&nbsp;
<span class="fstat-no" title="function not covered" >    function sendResponse() {</span>
<span class="cstat-no" title="statement not covered" >        if (!state) {</span>
<span class="cstat-no" title="statement not covered" >            if (self.isRoot) {// &amp;&amp; !spec.token('#').ext) {</span>
                // make 0 state for a global object TODO move to Host
<span class="cstat-no" title="statement not covered" >                state = {_version: '!0'};</span>
            }
        }
<span class="cstat-no" title="statement not covered" >        if (tail) {</span>
<span class="cstat-no" title="statement not covered" >            if (!state) {<span class="cstat-no" title="statement not covered" >state={};}</span></span>
<span class="cstat-no" title="statement not covered" >            state._tail = state._tail || {};</span>
<span class="cstat-no" title="statement not covered" >            for (var s in tail) {</span>
<span class="cstat-no" title="statement not covered" >                state._tail[s] = tail[s];</span>
            }
        }
<span class="cstat-no" title="statement not covered" >        var tiv = ti.add(spec.version(), '!');</span>
<span class="cstat-no" title="statement not covered" >        if (state) {</span>
<span class="cstat-no" title="statement not covered" >            src.deliver(tiv.add('.init'), state, self);</span>
<span class="cstat-no" title="statement not covered" >            src.deliver(tiv.add('.reon'), Syncable.stateVersionVector(state), self); </span>// TODO and the tail
        } else {
<span class="cstat-no" title="statement not covered" >            src.deliver(tiv.add('.reon'), '!0', self); </span>// state unknown
        }
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    this.readState(ti, <span class="fstat-no" title="function not covered" >function (err, s) {</span></span>
<span class="cstat-no" title="statement not covered" >        state = s || null;</span>
<span class="cstat-no" title="statement not covered" >        if (tail !== undefined) {</span>
<span class="cstat-no" title="statement not covered" >            sendResponse();</span>
        }
    });
&nbsp;
<span class="cstat-no" title="statement not covered" >    this.readOps(ti, <span class="fstat-no" title="function not covered" >function (err, t) {</span></span>
<span class="cstat-no" title="statement not covered" >        tail = t || null;</span>
<span class="cstat-no" title="statement not covered" >        if (state !== undefined) {</span>
<span class="cstat-no" title="statement not covered" >            sendResponse();</span>
        }
    });
};
&nbsp;
&nbsp;
Storage.prototype.off = <span class="fstat-no" title="function not covered" >function (spec, value, src) {</span>
<span class="cstat-no" title="statement not covered" >    if (!this.lstn) {</span>
<span class="cstat-no" title="statement not covered" >        return;</span>
    }
<span class="cstat-no" title="statement not covered" >    var ti = spec.filter('/#');</span>
<span class="cstat-no" title="statement not covered" >    var ls = this.lstn[ti];</span>
<span class="cstat-no" title="statement not covered" >    if (ls === src) {</span>
<span class="cstat-no" title="statement not covered" >        delete this.lstn[ti];</span>
    } else <span class="cstat-no" title="statement not covered" >if (ls &amp;&amp; ls.constructor === Array) {</span>
<span class="cstat-no" title="statement not covered" >        var cleared = ls.filter(<span class="fstat-no" title="function not covered" >function (v) {<span class="cstat-no" title="statement not covered" ></span>return v !== src;}</span>);</span>
<span class="cstat-no" title="statement not covered" >        if (cleared.length) {</span>
<span class="cstat-no" title="statement not covered" >            this.lstn[ti] = cleared;</span>
        } else {
<span class="cstat-no" title="statement not covered" >            delete this.lstn[ti];</span>
        }
    }
};
&nbsp;
Storage.prototype.init = <span class="fstat-no" title="function not covered" >function (spec, state, src) {</span>
<span class="cstat-no" title="statement not covered" >    var ti = spec.filter('/#'), self=this;</span>
<span class="cstat-no" title="statement not covered" >    var saveops = this.tails[ti];</span>
<span class="cstat-no" title="statement not covered" >    this.writeState(spec, state, <span class="fstat-no" title="function not covered" >function (err) {</span></span>
<span class="cstat-no" title="statement not covered" >        if (err) {</span>
<span class="cstat-no" title="statement not covered" >            console.error('state dump error:', err);</span>
        } else {
<span class="cstat-no" title="statement not covered" >            var tail = self.tails[ti] || (self.tails[ti] = {});</span>
<span class="cstat-no" title="statement not covered" >            for(var op in saveops) { // OK, let's keep that in the log</span>
<span class="cstat-no" title="statement not covered" >                tail[op] = saveops[op];</span>
            }
        }
    });
};
&nbsp;
&nbsp;
Storage.prototype.anyOp = <span class="fstat-no" title="function not covered" >function (spec, value, src) {</span>
<span class="cstat-no" title="statement not covered" >    var self = this;</span>
<span class="cstat-no" title="statement not covered" >    var ti = spec.filter('/#');</span>
<span class="cstat-no" title="statement not covered" >    this.writeOp(spec, value, <span class="fstat-no" title="function not covered" >function (err) {</span></span>
<span class="cstat-no" title="statement not covered" >        if (err) {</span>
<span class="cstat-no" title="statement not covered" >            this.close(err); </span>// the log is sacred
        }
    });
<span class="cstat-no" title="statement not covered" >    self.counts[ti] = self.counts[ti] || 0;</span>
<span class="cstat-no" title="statement not covered" >    if (++self.counts[ti]&gt;self.MAX_LOG_SIZE) {</span>
        // The storage piggybacks on the object's state/log handling logic
        // First, it adds an op to the log tail unless the log is too long...
        // ...otherwise it sends back a subscription effectively requesting
        // the state, on state arrival zeroes the tail.
<span class="cstat-no" title="statement not covered" >        delete self.counts[ti];</span>
<span class="cstat-no" title="statement not covered" >        src.deliver(spec.set('.reon'), '!0.init', self);</span>
    }
};
&nbsp;
&nbsp;
// In a real storage implementation, state and log often go into
// different backends, e.g. the state is saved to SQL/NoSQL db,
// while the log may live in a key-value storage.
// As long as the state has sufficient versioning info saved with
// it (like a version vector), we may purge the log lazily, once
// we are sure that the state is reliably saved. So, the log may
// overlap with the state (some ops are already applied). That
// provides some necessary resilience to workaround the lack of
// transactions across backends.
// In case third parties may write to the backend, go figure
// some way to deal with it (e.g. make a retrofit operation).
Storage.prototype.writeState = <span class="fstat-no" title="function not covered" >function (spec, state, cb) {</span>
<span class="cstat-no" title="statement not covered" >    var ti = spec.filter('/#');</span>
<span class="cstat-no" title="statement not covered" >    this.states[ti] = JSON.stringify(state);</span>
    // tail is zeroed on state flush
<span class="cstat-no" title="statement not covered" >    delete this.tails[ti];</span>
    // callback is mandatory
<span class="cstat-no" title="statement not covered" >    cb();</span>
};
&nbsp;
Storage.prototype.writeOp = <span class="fstat-no" title="function not covered" >function (spec, value, cb) {</span>
<span class="cstat-no" title="statement not covered" >    var ti = spec.filter('/#');</span>
<span class="cstat-no" title="statement not covered" >    var vm = spec.filter('!.');</span>
<span class="cstat-no" title="statement not covered" >    var tail = this.tails[ti] || (this.tails[ti] = {});</span>
<span class="cstat-no" title="statement not covered" >    if (tail[vm]) {</span>
<span class="cstat-no" title="statement not covered" >        console.error('op replay @storage'+vm+new Error().stack);</span>
    }
<span class="cstat-no" title="statement not covered" >    tail[vm] = JSON.stringify(value);</span>
<span class="cstat-no" title="statement not covered" >    cb();</span>
};
&nbsp;
Storage.prototype.readState = <span class="fstat-no" title="function not covered" >function (ti, callback) {</span>
<span class="cstat-no" title="statement not covered" >    var state = JSON.parse(this.states[ti] || null);</span>
&nbsp;
<span class="fstat-no" title="function not covered" >    function sendResponse() {</span>
<span class="cstat-no" title="statement not covered" >        callback(null, state);</span>
    }
&nbsp;
    // may force async behavior
<span class="cstat-no" title="statement not covered" >    this.async ? setTimeout(sendResponse, 1) : sendResponse();</span>
};
&nbsp;
Storage.prototype.readOps = <span class="fstat-no" title="function not covered" >function (ti, callback) {</span>
<span class="cstat-no" title="statement not covered" >    var tail = JSON.parse(this.tails[ti] || null);</span>
<span class="cstat-no" title="statement not covered" >    callback(null, tail);</span>
};
&nbsp;
Storage.prototype.close = <span class="fstat-no" title="function not covered" >function (callback) {</span>
<span class="cstat-no" title="statement not covered" >    if (callback) { <span class="cstat-no" title="statement not covered" >callback(); </span>}</span>
};
&nbsp;
Storage.prototype.emit = <span class="fstat-no" title="function not covered" >function (spec,value) {</span>
<span class="cstat-no" title="statement not covered" >    var ti = spec.filter('/#');</span>
<span class="cstat-no" title="statement not covered" >    var ln = this.lstn[ti];</span>
<span class="cstat-no" title="statement not covered" >    if (!ln) {<span class="cstat-no" title="statement not covered" >return;}</span></span>
<span class="cstat-no" title="statement not covered" >    if (ln &amp;&amp; ln.constructor===Array) {</span>
<span class="cstat-no" title="statement not covered" >        for(var i=0; ln &amp;&amp; i&lt;ln.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >            var l = ln[i];</span>
<span class="cstat-no" title="statement not covered" >            if (l &amp;&amp; l.constructor===Function) {</span>
<span class="cstat-no" title="statement not covered" >                l(spec,value,this);</span>
            } else <span class="cstat-no" title="statement not covered" >if (l &amp;&amp; l.deliver) {</span>
<span class="cstat-no" title="statement not covered" >                l.deliver(spec,value,this);</span>
            }
        }
    } else <span class="cstat-no" title="statement not covered" >if (ln &amp;&amp; ln.deliver) {</span>
<span class="cstat-no" title="statement not covered" >        ln.deliver(spec,value,this);</span>
    } else <span class="cstat-no" title="statement not covered" >if (ln &amp;&amp; ln.constructor===Function) {</span>
<span class="cstat-no" title="statement not covered" >        ln(spec,value,this);</span>
    }
};
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/Syncable.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/Syncable.js</span></h1>
    <h2>
        
        Statements: <span class="metric">22.36% <small>(89 / 398)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">12.21% <small>(37 / 303)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">12% <small>(6 / 50)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">23.04% <small>(88 / 382)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/node_modules/swarm/lib/</a> &#187; Syncable.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659
660
661
662
663
664
665
666
667
668
669
670
671
672
673
674
675
676
677
678
679
680
681
682
683
684
685
686
687
688
689
690
691
692
693
694
695
696
697
698
699
700
701
702
703
704
705
706
707
708
709
710
711
712
713
714
715
716
717
718
719
720
721
722
723
724
725
726
727
728
729
730
731
732
733
734
735
736
737
738
739
740
741
742
743
744
745
746
747
748
749
750
751
752
753
754
755
756
757
758
759
760
761
762
763
764
765
766
767
768
769
770
771
772
773
774
775
776
777
778
779
780
781
782
783
784
785
786
787
788
789
790
791
792
793
794
795
796
797
798
799
800
801
802
803
804
805
806
807
808
809
810
811
812
813
814
815
816
817
818
819
820
821
822
823
824
825
826
827
828
829
830
831
832
833
834
835
836
837
838
839
840
841
842
843
844
845
846
847
848
849
850
851
852
853
854
855
856
857
858
859
860
861
862
863
864
865
866
867
868
869
870
871
872
873
874
875
876
877
878
879
880
881
882
883
884
885
886
887
888
889
890
891
892
893
894
895
896
897
898
899
900
901
902
903
904
905
906
907
908
909
910
911
912
913
914
915
916
917
918
919
920
921
922
923
924
925
926
927
928
929
930
931
932
933
934
935
936
937
938
939
940
941
942
943
944
945
946</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5</span>
<span class="cline-any cline-yes">25</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5</span>
<span class="cline-any cline-yes">5</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">7</span>
<span class="cline-any cline-yes">7</span>
<span class="cline-any cline-yes">7</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">12</span>
<span class="cline-any cline-yes">12</span>
<span class="cline-any cline-yes">12</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">101</span>
<span class="cline-any cline-yes">101</span>
<span class="cline-any cline-yes">101</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">84</span>
<span class="cline-any cline-yes">17</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-yes">17</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">17</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">12</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">12</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">11</span>
<span class="cline-any cline-yes">9</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">19</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
&nbsp;
var Spec = require('./Spec');
var env = require('./env');
&nbsp;
/**
 * Syncable: an oplog-synchronized object
 * @constructor
 */
<span class="fstat-no" title="function not covered" >function Syncable() {</span>
    // listeners represented as objects that have deliver() method
<span class="cstat-no" title="statement not covered" >    this._lstn = [',']; </span>// we unshift() uplink listeners and push() downlinks
    // ...so _lstn is like [server1, server2, storage, ',', view, listener]
    // The most correct way to specify a version is the version vector,
    // but that one may consume more space than the data itself in some cases.
    // Hence, _version is not a fully specified version vector (see version()
    // instead). _version is essentially is the greatest operation timestamp
    // (Lamport-like, i.e. "time+source"), sometimes amended with additional
    // timestamps. Its main features:
    // (1) changes once the object's state changes
    // (2) does it monotonically (in the alphanum order sense)
<span class="cstat-no" title="statement not covered" >    this._version = '';</span>
    // make sense of arguments
<span class="cstat-no" title="statement not covered" >    var args = Array.prototype.slice.call(arguments);</span>
<span class="cstat-no" title="statement not covered" >    this._host = (args.length &amp;&amp; args[args.length - 1]._type === 'Host') ?</span>
            args.pop() : env.localhost;
<span class="cstat-no" title="statement not covered" >    if (Spec.is(args[0])) {</span>
<span class="cstat-no" title="statement not covered" >        this._id = new Spec(args.shift()).id() || this._host.time();</span>
    } else <span class="cstat-no" title="statement not covered" >if (typeof(args[0]) === 'string') {</span>
<span class="cstat-no" title="statement not covered" >        this._id = args.shift(); </span>// TODO format
    } else {
<span class="cstat-no" title="statement not covered" >        this._id = this._host.time();</span>
<span class="cstat-no" title="statement not covered" >        this._version = '!0'; </span>// may apply state in the constructor, see Model
    }
    //var state = args.length ? args.pop() : (fresh?{}:undefined);
    // register with the host
<span class="cstat-no" title="statement not covered" >    var doubl = this._host.register(this);</span>
<span class="cstat-no" title="statement not covered" >    if (doubl !== this) { <span class="cstat-no" title="statement not covered" >return doubl; </span>}</span>
    // locally created objects get state immediately
    // (while external-id objects need to query uplinks)
    /*if (fresh &amp;&amp; state) {
     state._version = '!'+this._id;
     var pspec = this.spec().add(state._version).add('.init');
     this.deliver(pspec,state,this._host);
     }*/
<span class="cstat-no" title="statement not covered" >    this.reset();</span>
    // find uplinks, subscribe
<span class="cstat-no" title="statement not covered" >    this.checkUplink();</span>
    // TODO inplement state push
<span class="cstat-no" title="statement not covered" >    return this;</span>
}
module.exports = Syncable;
&nbsp;
Syncable.types = {};
Syncable.isOpSink = <span class="fstat-no" title="function not covered" >function (obj) {</span>
<span class="cstat-no" title="statement not covered" >    if (!obj) { <span class="cstat-no" title="statement not covered" >return false; </span>}</span>
<span class="cstat-no" title="statement not covered" >    if (obj.constructor === Function) { <span class="cstat-no" title="statement not covered" >return true; </span>}</span>
<span class="cstat-no" title="statement not covered" >    if (obj.deliver &amp;&amp; obj.deliver.constructor === Function) { <span class="cstat-no" title="statement not covered" >return true; </span>}</span>
<span class="cstat-no" title="statement not covered" >    return false;</span>
};
Syncable.reMethodName = /^[a-z][a-z0-9]*([A-Z][a-z0-9]*)*$/;
Syncable.memberClasses = {ops:1,neutrals:1,remotes:1,defaults:1,reactions:1,mixins:1};
Syncable._default = {};
&nbsp;
function fnname(fn) {
    <span class="missing-if-branch" title="else path not taken" >E</span>if (fn.name) { return fn.name; }
<span class="cstat-no" title="statement not covered" >    return fn.toString().match(/^function\s*([^\s(]+)/)[1];</span>
}
&nbsp;
&nbsp;
/**
 * All CRDT model classes must extend syncable directly or indirectly. Syncable
 * provides all the necessary oplog- and state-related primitives and methods.
 * Every state-mutating method should be explicitly declared to be wrapped
 * by extend() (see 'ops', 'neutrals', 'remotes' sections in class declaration).
 * @param {function|string} fn
 * @param {{ops:object, neutrals:object, remotes:object}} own
 */
Syncable.extend = function (fn, own) {
    var parent = this, fnid;
    if (fn.constructor !== Function) {
        var id = fn.toString();
        fn = <span class="fstat-no" title="function not covered" >function SomeSyncable() {</span>
<span class="cstat-no" title="statement not covered" >            return parent.apply(this, arguments);</span>
        };
        fnid = id; // if only it worked
    } else { // please call Syncable.constructor.apply(this,args) in your constructor
        fnid = fnname(fn);
    }
&nbsp;
    // inheritance trick from backbone.js
    var SyncProto = function () {
        this.constructor = fn;
        this._neutrals = {};
        this._ops = {};
        this._reactions = {};
&nbsp;
        var event,
            name;
        if (parent._pt) {
            //copy _neutrals &amp; _ops from parent
            for (event in parent._pt._neutrals) {
                this._neutrals[event] = parent._pt._neutrals[event];
            }
            for (event in parent._pt._ops) {
                this._ops[event] = parent._pt._ops[event];
            }
        }
&nbsp;
        // "Methods" are serialized, logged and delivered to replicas
        for (name in own.ops || {}) {
            <span class="missing-if-branch" title="else path not taken" >E</span>if (Syncable.reMethodName.test(name)) {
                this._ops[name] = own.ops[name];
                this[name] = wrapCall(name);
            } else {
<span class="cstat-no" title="statement not covered" >                console.warn('invalid op name:',name);</span>
            }
        }
&nbsp;
        // "Neutrals" don't change the state
        for (name in own.neutrals || {}) {
            <span class="missing-if-branch" title="else path not taken" >E</span>if (Syncable.reMethodName.test(name)) {
                this._neutrals[name] = own.neutrals[name];
                this[name] = wrapCall(name);
            } else {
<span class="cstat-no" title="statement not covered" >                console.warn('invalid neutral op name:',name);</span>
            }
        }
&nbsp;
        // "Remotes" are serialized and sent upstream (like RPC calls)
        for (name in own.remotes || {}) {
<span class="cstat-no" title="statement not covered" >            if (Syncable.reMethodName.test(name)) {</span>
<span class="cstat-no" title="statement not covered" >                this[name] = wrapCall(name);</span>
            } else {
<span class="cstat-no" title="statement not covered" >                console.warn('invalid rpc name:',name);</span>
            }
        }
&nbsp;
        // add mixins
        (own.mixins || []).forEach(function (mixin) {
            for (var name in mixin) {
                this[name] = mixin[name];
            }
        }, this);
&nbsp;
        // add other members
        for (name in own) {
            <span class="missing-if-branch" title="else path not taken" >E</span>if (Syncable.reMethodName.test(name)) {
                var memberType = own[name].constructor;
                if (memberType === Function) { // non-op method
                    // these must change state ONLY by invoking ops
                    this[name] = own[name];
                } else <span class="missing-if-branch" title="if path not taken" >I</span>if (memberType===String || memberType===Number) {
<span class="cstat-no" title="statement not covered" >                    this[name] = own[name]; </span>// some static constant, OK
                } else <span class="missing-if-branch" title="else path not taken" >E</span>if (name in Syncable.memberClasses) {
                    // see above
                    continue;
                } else {
<span class="cstat-no" title="statement not covered" >                    console.warn('invalid member:',name,memberType);</span>
                }
            } else {
<span class="cstat-no" title="statement not covered" >                console.warn('invalid member name:',name);</span>
            }
        }
&nbsp;
        // add reactions
        for (name in own.reactions || {}) {
            var reaction = own.reactions[name];
            <span class="missing-if-branch" title="if path not taken" >I</span>if (!reaction) { <span class="cstat-no" title="statement not covered" >continue; </span>}
&nbsp;
            switch (typeof reaction) {
            case 'function':
                // handler-function
                this._reactions[name] = [reaction];
                break;
<span class="branch-1 cbranch-no" title="branch not covered" >            case 'string':</span>
                // handler-method name
<span class="cstat-no" title="statement not covered" >                this._reactions[name] = [this[name]];</span>
<span class="cstat-no" title="statement not covered" >                break;</span>
<span class="branch-2 cbranch-no" title="branch not covered" >            default:</span>
<span class="cstat-no" title="statement not covered" >                if (reaction.constructor === Array) {</span>
                    // array of handlers
<span class="cstat-no" title="statement not covered" >                    this._reactions[name] = reaction.map(<span class="fstat-no" title="function not covered" >function (item) {</span></span>
<span class="cstat-no" title="statement not covered" >                        switch (typeof item) {</span>
                        case 'function':
<span class="cstat-no" title="statement not covered" >                            return item;</span>
                        case 'string':
<span class="cstat-no" title="statement not covered" >                            return this[item];</span>
                        default:
<span class="cstat-no" title="statement not covered" >                            throw new Error('unexpected reaction type');</span>
                        }
                    }, this);
                } else {
<span class="cstat-no" title="statement not covered" >                    throw new Error('unexpected reaction type');</span>
                }
            }
        }
&nbsp;
        var syncProto = this;
        this.callReactions = <span class="fstat-no" title="function not covered" >function (spec, value, src) {</span>
<span class="cstat-no" title="statement not covered" >            var superReactions = syncProto._super.callReactions;</span>
<span class="cstat-no" title="statement not covered" >            if ('function' === typeof superReactions) {</span>
<span class="cstat-no" title="statement not covered" >                superReactions.call(this, spec, value, src);</span>
            }
<span class="cstat-no" title="statement not covered" >            var r = syncProto._reactions[spec.op()];</span>
<span class="cstat-no" title="statement not covered" >            if (r) {</span>
<span class="cstat-no" title="statement not covered" >                r.constructor !== Array &amp;&amp; (r = [r]);</span>
<span class="cstat-no" title="statement not covered" >                for (var i = 0; i &lt; r.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >                    r[i] &amp;&amp; r[i].call(this, spec, value, src);</span>
                }
            }
        };
&nbsp;
        this._super = parent.prototype;
        this._type = fnid;
    };
&nbsp;
    SyncProto.prototype = parent.prototype;
    fn.prototype = new SyncProto();
    fn._pt = fn.prototype; // just a shortcut
&nbsp;
    // default field values
    var key;
    var defs = fn.defaults = {};
    for (key in (parent.defaults || <span class="branch-1 cbranch-no" title="branch not covered" >{})</span>) {
<span class="cstat-no" title="statement not covered" >        defs[key] = normalizeDefault(parent.defaults[key]);</span>
    }
    for (key in (own.defaults || {})) {
        defs[key] = normalizeDefault(own.defaults[key]);
    }
&nbsp;
    function normalizeDefault(val) {
        if (val &amp;&amp; val.type) {
            return val;
        }
        if (val &amp;&amp; val.constructor === Function) {
            return {type: val, value: undefined};
        }
        return {type:null, value: val};
    }
&nbsp;
    // signature normalization for logged/remote/local method calls;
    function wrapCall(name) {
        return <span class="fstat-no" title="function not covered" >function wrapper() {</span>
            // assign a Lamport timestamp
<span class="cstat-no" title="statement not covered" >            var spec = this.newEventSpec(name);</span>
<span class="cstat-no" title="statement not covered" >            var args = Array.prototype.slice.apply(arguments), lstn;</span>
            // find the callback if any
<span class="cstat-no" title="statement not covered" >            Syncable.isOpSink(args[args.length - 1]) &amp;&amp; (lstn = args.pop());</span>
            // prettify the rest of the arguments
<span class="cstat-no" title="statement not covered" >            if (!args.length) {  // FIXME isn't it confusing?</span>
<span class="cstat-no" title="statement not covered" >                args = ''; </span>// used as 'empty'
            } else <span class="cstat-no" title="statement not covered" >if (args.length === 1) {</span>
<span class="cstat-no" title="statement not covered" >                args = args[0]; </span>// {key:val}
            }
            // TODO log 'initiated'
<span class="cstat-no" title="statement not covered" >            return this.deliver(spec, args, lstn);</span>
        };
    }
&nbsp;
    // finishing touches
    fn._super = parent;
    fn.extend = this.extend;
    fn.addReaction = this.addReaction;
    fn.removeReaction = this.removeReaction;
    Syncable.types[fnid] = fn;
    return fn;
};
&nbsp;
/**
 * A *reaction* is a hybrid of a listener and a method. It "reacts" on a
 * certain event for all objects of that type. The callback gets invoked
 * as a method, i.e. this===syncableObj. In an event-oriented architecture
 * reactions are rather handy, e.g. for creating mixins.
 * @param {string} op operation name
 * @param {function} fn callback
 * @returns {{op:string, fn:function}}
 */
Syncable.addReaction = <span class="fstat-no" title="function not covered" >function (op, fn) {</span>
<span class="cstat-no" title="statement not covered" >    var reactions = this.prototype._reactions;</span>
<span class="cstat-no" title="statement not covered" >    var list = reactions[op];</span>
<span class="cstat-no" title="statement not covered" >    list || (list = reactions[op] = []);</span>
<span class="cstat-no" title="statement not covered" >    list.push(fn);</span>
<span class="cstat-no" title="statement not covered" >    return {op: op, fn: fn};</span>
};
&nbsp;
/**
 *
 * @param handle
 */
Syncable.removeReaction = <span class="fstat-no" title="function not covered" >function (handle) {</span>
<span class="cstat-no" title="statement not covered" >    var op = handle.op,</span>
        fn = handle.fn,
        list = this.prototype._reactions[op],
        i = list.indexOf(fn);
<span class="cstat-no" title="statement not covered" >    if (i === -1) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error('reaction unknown');</span>
    }
<span class="cstat-no" title="statement not covered" >    list[i] = undefined; </span>// such a peculiar pattern not to mess up out-of-callback removal
<span class="cstat-no" title="statement not covered" >    while (list.length &amp;&amp; !list[list.length - 1]) {</span>
<span class="cstat-no" title="statement not covered" >        list.pop();</span>
    }
};
&nbsp;
/**
 * compare two listeners
 * @param {{deliver:function, _src:*, sink:function}} ln listener from syncable._lstn
 * @param {function|{deliver:function}} other some other listener or function
 * @returns {boolean}
 */
Syncable.listenerEquals = <span class="fstat-no" title="function not covered" >function (ln, other) {</span>
<span class="cstat-no" title="statement not covered" >    return !!ln &amp;&amp; ((ln === other) ||</span>
        (ln._src &amp;&amp; ln._src === other) ||
        (ln.fn &amp;&amp; ln.fn === other) ||
        (ln.sink &amp;&amp; ln.sink === other));
};
&nbsp;
// Syncable includes all the oplog, change propagation and distributed
// garbage collection logix.
Syncable.extend(Syncable, {  // :P
    /**
     * @returns {Spec} specifier "/Type#objid"
     */
    spec: <span class="fstat-no" title="function not covered" >function () {</span> <span class="cstat-no" title="statement not covered" >return new Spec('/' + this._type + '#' + this._id); </span>},
&nbsp;
    /**
     * Generates new specifier with unique version
     * @param {string} op operation
     * @returns {Spec}
     */
    newEventSpec: <span class="fstat-no" title="function not covered" >function (op) {</span>
<span class="cstat-no" title="statement not covered" >        return this.spec().add(this._host.time(), '!').add(op, '.');</span>
    },
&nbsp;
    /**
     * Returns current object state specifier
     * @returns {string} specifier "/Type#objid!version+source[!version+source2...]"
     */
    stateSpec: <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >        return this.spec() + (this._version || ''); </span>//?
    },
&nbsp;
    /**
     * Applies a serialized operation (or a batch thereof) to this replica
     */
    deliver: <span class="fstat-no" title="function not covered" >function (spec, value, lstn) {</span>
<span class="cstat-no" title="statement not covered" >        spec = Spec.as(spec);</span>
<span class="cstat-no" title="statement not covered" >        var opver = '!' + spec.version();</span>
<span class="cstat-no" title="statement not covered" >        var error;</span>
&nbsp;
<span class="fstat-no" title="function not covered" >        function fail(msg, ex) {</span>
<span class="cstat-no" title="statement not covered" >            console.error(msg, spec, value, (ex &amp;&amp; ex.stack) || ex || new Error(msg));</span>
<span class="cstat-no" title="statement not covered" >            if (typeof(lstn) === 'function') {</span>
<span class="cstat-no" title="statement not covered" >                lstn(spec.set('.fail'), msg);</span>
            } else <span class="cstat-no" title="statement not covered" >if (lstn &amp;&amp; typeof(lstn.error) === 'function') {</span>
<span class="cstat-no" title="statement not covered" >                lstn.error(spec, msg);</span>
            } // else { } no callback provided
        }
&nbsp;
        // sanity checks
<span class="cstat-no" title="statement not covered" >        if (spec.pattern() !== '/#!.') {</span>
<span class="cstat-no" title="statement not covered" >            return fail('malformed spec', spec);</span>
        }
<span class="cstat-no" title="statement not covered" >        if (!this._id) {</span>
<span class="cstat-no" title="statement not covered" >            return fail('undead object invoked');</span>
        }
<span class="cstat-no" title="statement not covered" >        if (error = this.validate(spec, value)) {</span>
<span class="cstat-no" title="statement not covered" >            return fail('invalid input, ' + error, value);</span>
        }
<span class="cstat-no" title="statement not covered" >        if (!this.acl(spec, value, lstn)) {</span>
<span class="cstat-no" title="statement not covered" >            return fail('access violation', spec);</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        env.debug &amp;&amp; env.log(spec, value, lstn);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        try {</span>
<span class="cstat-no" title="statement not covered" >            var call = spec.op();</span>
<span class="cstat-no" title="statement not covered" >            if (this._ops[call]) {  // FIXME name=&gt;impl table</span>
<span class="cstat-no" title="statement not covered" >                if (this.isReplay(spec)) { // it happens</span>
<span class="cstat-no" title="statement not covered" >                    console.warn('replay', spec);</span>
<span class="cstat-no" title="statement not covered" >                    return;</span>
                }
                // invoke the implementation
<span class="cstat-no" title="statement not covered" >                this._ops[call].call(this, spec, value, lstn); </span>// NOTE: no return value
                // once applied, may remember in the log...
<span class="cstat-no" title="statement not covered" >                if (spec.op() !== 'init') {</span>
<span class="cstat-no" title="statement not covered" >                    this._oplog &amp;&amp; (this._oplog[spec.filter('!.')] = value);</span>
                    // this._version is practically a label that lets you know whether
                    // the state has changed. Also, it allows to detect some cases of
                    // concurrent change, as it is always set to the maximum version id
                    // received by this object. Still, only the full version vector may
                    // precisely and uniquely specify the current version (see version()).
<span class="cstat-no" title="statement not covered" >                    this._version = (opver &gt; this._version) ? opver : this._version + opver;</span>
                } else {
<span class="cstat-no" title="statement not covered" >                    value = this.diff('!0');</span>
                }
                // ...and relay further to downstream replicas and various listeners
<span class="cstat-no" title="statement not covered" >                this.emit(spec, value, lstn);</span>
            } else <span class="cstat-no" title="statement not covered" >if (this._neutrals[call]) {</span>
                // invoke the implementation
<span class="cstat-no" title="statement not covered" >                this._neutrals[call].call(this, spec, value, lstn);</span>
                // and relay to listeners
<span class="cstat-no" title="statement not covered" >                this.emit(spec, value, lstn);</span>
            } else {
<span class="cstat-no" title="statement not covered" >                this.unimplemented(spec, value, lstn);</span>
            }
        } catch (ex) { // log and rethrow; don't relay further; don't log
<span class="cstat-no" title="statement not covered" >            return fail("method execution failed", ex);</span>
        }
&nbsp;
        // to force async signatures we eat the returned value silently
<span class="cstat-no" title="statement not covered" >        return spec;</span>
    },
&nbsp;
    /**
     * Notify all the listeners of a state change (i.e. the operation applied).
     */
    emit: <span class="fstat-no" title="function not covered" >function (spec, value, src) {</span>
<span class="cstat-no" title="statement not covered" >        var ls = this._lstn,</span>
            op = spec.op(),
            is_neutrals = op in this._neutrals;
<span class="cstat-no" title="statement not covered" >        if (ls) {</span>
<span class="cstat-no" title="statement not covered" >            var notify = [];</span>
<span class="cstat-no" title="statement not covered" >            for (var i = 0; i &lt; ls.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >                var l = ls[i];</span>
                // skip empties, deferreds and the source
<span class="cstat-no" title="statement not covered" >                if (!l || l === ',' || l === src) { <span class="cstat-no" title="statement not covered" >continue; </span>}</span>
<span class="cstat-no" title="statement not covered" >                if (is_neutrals &amp;&amp; l._op !== op) { <span class="cstat-no" title="statement not covered" >continue; </span>}</span>
<span class="cstat-no" title="statement not covered" >                if (l._op &amp;&amp; l._op !== op) { <span class="cstat-no" title="statement not covered" >continue; </span>}</span>
<span class="cstat-no" title="statement not covered" >                notify.push(l);</span>
            }
<span class="cstat-no" title="statement not covered" >            for (i = 0; i &lt; notify.length; i++) { // screw it I want my 'this'</span>
<span class="cstat-no" title="statement not covered" >                try {</span>
<span class="cstat-no" title="statement not covered" >                    notify[i].deliver(spec, value, this);</span>
                } catch (ex) {
<span class="cstat-no" title="statement not covered" >                    console.error(ex.message, ex.stack);</span>
                }
            }
        }
<span class="cstat-no" title="statement not covered" >        this.callReactions(spec, value, src);</span>
    },
&nbsp;
    trigger: <span class="fstat-no" title="function not covered" >function (event, params) {</span>
<span class="cstat-no" title="statement not covered" >        var spec = this.newEventSpec(event);</span>
<span class="cstat-no" title="statement not covered" >        this.deliver(spec, params);</span>
    },
&nbsp;
    /**
     * Blindly applies a JSON changeset to this model.
     * @param {*} values
     */
    apply: <span class="fstat-no" title="function not covered" >function (values) {</span>
<span class="cstat-no" title="statement not covered" >        for (var key in values) {</span>
<span class="cstat-no" title="statement not covered" >            if (Syncable.reFieldName.test(key)) { // skip special fields</span>
<span class="cstat-no" title="statement not covered" >                var def = this.constructor.defaults[key];</span>
<span class="cstat-no" title="statement not covered" >                this[key] = def &amp;&amp; def.type ?</span>
                    new def.type(values[key]) : values[key];
            }
        }
    },
&nbsp;
    /**
     * @returns {Spec.Map} the version vector for this object
     */
    version: <span class="fstat-no" title="function not covered" >function () {</span>
        // distillLog() may drop some operations; still, those need to be counted
        // in the version vector; so, their Lamport ids must be saved in this._vector
<span class="cstat-no" title="statement not covered" >        var map = new Spec.Map(this._version + (this._vector || ''));</span>
<span class="cstat-no" title="statement not covered" >        if (this._oplog) {</span>
<span class="cstat-no" title="statement not covered" >            for (var op in this._oplog) {</span>
<span class="cstat-no" title="statement not covered" >                map.add(op);</span>
            }
        }
<span class="cstat-no" title="statement not covered" >        return map; </span>// TODO return the object, let the consumer trim it to taste
    },
&nbsp;
    /**
     * Produce the entire state or probably the necessary difference
     * to synchronize a replica which is at version *base*.
     * The format of a state/patch object is:
     * {
     *   // A version label, see Syncable(). Presence of the label means
     *   // that this object has a snapshot of the state. No version
     *   // means it is a diff (log tail).
     *   _version: Spec,
     *   // Some parts of the version vector that can not be derived from
     *   // _oplog or _version.
     *   _vector: Spec,
     *   // Some ops that were already applied. See distillLog()
     *   _oplog: { spec: value },
     *   // Pending ops that need to be applied.
     *   _tail: { spec: value }
     * }
     *
     * The state object must survive JSON.parse(JSON.stringify(obj))
     *
     * In many cases, the size of a distilled log is small enough to
     * use it for state transfer (i.e. no snapshots needed).
     */
    diff: <span class="fstat-no" title="function not covered" >function (base) {</span>
        //var vid = new Spec(this._version).get('!'); // first !token
        //var spec = vid + '.patch';
<span class="cstat-no" title="statement not covered" >        if (!this._version) { <span class="cstat-no" title="statement not covered" >return undefined; </span>}</span>
<span class="cstat-no" title="statement not covered" >        this.distillLog(); </span>// TODO optimize?
<span class="cstat-no" title="statement not covered" >        var patch, spec;</span>
<span class="cstat-no" title="statement not covered" >        if (base &amp;&amp; base != '!0' &amp;&amp; base != '0') { // FIXME ugly</span>
<span class="cstat-no" title="statement not covered" >            var map = new Spec.Map(base || '');</span>
<span class="cstat-no" title="statement not covered" >            for (spec in this._oplog) {</span>
<span class="cstat-no" title="statement not covered" >                if (!map.covers(new Spec(spec).version())) {</span>
<span class="cstat-no" title="statement not covered" >                    patch = patch || {_tail: {}}; </span>// NOTE: no _version
<span class="cstat-no" title="statement not covered" >                    patch._tail[spec] = this._oplog[spec];</span>
                }
            }
        } else {
<span class="cstat-no" title="statement not covered" >            patch = {_version: '!0', _tail: {}}; </span>// zero state plus the tail
<span class="cstat-no" title="statement not covered" >            for (spec in this._oplog) {</span>
<span class="cstat-no" title="statement not covered" >                patch._tail[spec] = this._oplog[spec];</span>
            }
        }
<span class="cstat-no" title="statement not covered" >        return patch;</span>
    },
&nbsp;
    distillLog: <span class="fstat-no" title="function not covered" >function () {</span>
    },
&nbsp;
    /**
     * The method must decide whether the source of the operation has
     * the rights to perform it. The method may check both the nearest
     * source and the original author of the op.
     * If this method ever mentions 'this', that is a really bad sign.
     * @returns {boolean}
     */
    acl: <span class="fstat-no" title="function not covered" >function (spec, val, src) {</span>
<span class="cstat-no" title="statement not covered" >        return true;</span>
    },
&nbsp;
    /**
     * Check operation format/validity (recommendation: don't check against the current state)
     * @returns {string} '' if OK, error message otherwise.
     */
    validate: <span class="fstat-no" title="function not covered" >function (spec, val, src) {</span>
<span class="cstat-no" title="statement not covered" >        if (spec.pattern() !== '/#!.') {</span>
<span class="cstat-no" title="statement not covered" >            return 'incomplete event spec';</span>
        }
<span class="cstat-no" title="statement not covered" >        if (this.clock &amp;&amp; spec.type()!=='Host' &amp;&amp; !this.clock.checkTimestamp(spec.version())) {</span>
<span class="cstat-no" title="statement not covered" >            return 'invalid timestamp '+spec;</span>
        }
    },
&nbsp;
    /**
     * whether this op was already applied in the past
     * @returns {boolean}
     */
    isReplay: <span class="fstat-no" title="function not covered" >function (spec) {</span>
<span class="cstat-no" title="statement not covered" >        if (!this._version) { <span class="cstat-no" title="statement not covered" >return false; </span>}</span>
<span class="cstat-no" title="statement not covered" >        if (spec.op() === 'init') { <span class="cstat-no" title="statement not covered" >return false; </span>} </span>// these are .on !vids
<span class="cstat-no" title="statement not covered" >        var opver = spec.version();</span>
<span class="cstat-no" title="statement not covered" >        if (opver &gt; this._version.substr(1)) { <span class="cstat-no" title="statement not covered" >return false; </span>}</span>
<span class="cstat-no" title="statement not covered" >        if (spec.filter('!.').toString() in this._oplog) { <span class="cstat-no" title="statement not covered" >return true; </span>}/</span>/ TODO log trimming, vvectors?
<span class="cstat-no" title="statement not covered" >        return this.version().covers(opver); </span>// heavyweight
    },
&nbsp;
    /**
     * External objects (those you create by supplying an id) need first to query
     * the uplink for their state. Before the state arrives they are stateless.
     * @return {boolean}
     */
    hasState: <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >        return !!this._version;</span>
    },
&nbsp;
    getListenerIndex: <span class="fstat-no" title="function not covered" >function (search_for, uplinks_only) {</span>
<span class="cstat-no" title="statement not covered" >        var i = this._lstn.indexOf(search_for),</span>
            l;
<span class="cstat-no" title="statement not covered" >        if (i &gt; -1) { <span class="cstat-no" title="statement not covered" >return i; </span>}</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        for (i = 0, l = this._lstn.length; i &lt; l; i++) {</span>
<span class="cstat-no" title="statement not covered" >            var ln = this._lstn[i];</span>
<span class="cstat-no" title="statement not covered" >            if (uplinks_only &amp;&amp; ln === ',') {</span>
<span class="cstat-no" title="statement not covered" >                return -1;</span>
            }
<span class="cstat-no" title="statement not covered" >            if (Syncable.listenerEquals(ln, search_for)) {</span>
<span class="cstat-no" title="statement not covered" >                return i;</span>
            }
        }
<span class="cstat-no" title="statement not covered" >        return -1;</span>
    },
&nbsp;
    reset: <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >        var defs = this.constructor.defaults;</span>
<span class="cstat-no" title="statement not covered" >        for (var name in defs) {</span>
<span class="cstat-no" title="statement not covered" >            var def = defs[name];</span>
<span class="cstat-no" title="statement not covered" >            if (def.type) {</span>
<span class="cstat-no" title="statement not covered" >                this[name] = def.value ? new def.type(def.value) : new def.type();</span>
            } else {
<span class="cstat-no" title="statement not covered" >                this[name] = def.value;</span>
            }
        }
    },
&nbsp;
&nbsp;
    neutrals: {
        /**
         * Subscribe to the object's operations;
         * the upstream part of the two-way subscription
         *  on() with a full filter:
         *  @param {Spec} spec /Mouse#Mickey!now.on
         *  @param {Spec|string} filter !since.event
         *  @param {{deliver:function}|function} repl callback
         *  @this {Syncable}
         *
         * TODO: prevent second subscription
         */
        on: <span class="fstat-no" title="function not covered" >function (spec, filter, repl) {</span>   // WELL  on() is not an op, right?
            // if no listener is supplied then the object is only
            // guaranteed to exist till the next Host.gc() run
<span class="cstat-no" title="statement not covered" >            if (!repl) { <span class="cstat-no" title="statement not covered" >return; </span>}</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >            var self = this;</span>
            // stateless objects fire no events; essentially, on() is deferred
<span class="cstat-no" title="statement not covered" >            if (!this._version &amp;&amp; filter) { // TODO solidify</span>
<span class="cstat-no" title="statement not covered" >                this._lstn.push({</span>
                    _op: 'reon',
                    _src: repl,
                    deliver: <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >                        var i = self._lstn.indexOf(this);</span>
<span class="cstat-no" title="statement not covered" >                        self._lstn.splice(i, 1);</span>
<span class="cstat-no" title="statement not covered" >                        self.deliver(spec, filter, repl);</span>
                    }
                });
<span class="cstat-no" title="statement not covered" >                return; </span>// defer this call till uplinks are ready
            }
            // make all listeners uniform objects
<span class="cstat-no" title="statement not covered" >            if (repl.constructor === Function) {</span>
<span class="cstat-no" title="statement not covered" >                repl = {</span>
                    sink: repl,
                    that: this,
                    deliver: <span class="fstat-no" title="function not covered" >function () {</span> // .deliver is invoked on an event
<span class="cstat-no" title="statement not covered" >                        this.sink.apply(this.that, arguments);</span>
                    }
                };
            }
&nbsp;
<span class="cstat-no" title="statement not covered" >            if (filter) {</span>
<span class="cstat-no" title="statement not covered" >                filter = new Spec(filter, '.');</span>
<span class="cstat-no" title="statement not covered" >                var baseVersion = filter.filter('!'),</span>
                    filter_by_op = filter.get('.');
&nbsp;
<span class="cstat-no" title="statement not covered" >                if (filter_by_op === 'init') {</span>
<span class="cstat-no" title="statement not covered" >                    var diff_if_needed = baseVersion ? this.diff(baseVersion) : '';</span>
<span class="cstat-no" title="statement not covered" >                    repl.deliver(spec.set('.init'), diff_if_needed, this); </span>//??
                    // FIXME use once()
<span class="cstat-no" title="statement not covered" >                    return;</span>
                }
<span class="cstat-no" title="statement not covered" >                if (filter_by_op) {</span>
<span class="cstat-no" title="statement not covered" >                    repl = {</span>
                        sink: repl,
                        _op: filter_by_op,
                        deliver: <span class="fstat-no" title="function not covered" >function deliverWithFilter(spec, val, src) {</span>
<span class="cstat-no" title="statement not covered" >                            if (spec.op() === filter_by_op) {</span>
<span class="cstat-no" title="statement not covered" >                                this.sink.deliver(spec, val, src);</span>
                            }
                        }
                    };
                }
&nbsp;
<span class="cstat-no" title="statement not covered" >                if (!baseVersion.isEmpty()) {</span>
<span class="cstat-no" title="statement not covered" >                    var diff = this.diff(baseVersion);</span>
<span class="cstat-no" title="statement not covered" >                    diff &amp;&amp; repl.deliver(spec.set('.init'), diff, this); </span>// 2downlink
<span class="cstat-no" title="statement not covered" >                    repl.deliver(spec.set('.reon'), this.version().toString(), this);</span>
                }
            }
&nbsp;
<span class="cstat-no" title="statement not covered" >            this._lstn.push(repl);</span>
            // TODO repeated subscriptions: send a diff, otherwise ignore
        },
&nbsp;
        /**
         * downstream reciprocal subscription
         */
        reon: <span class="fstat-no" title="function not covered" >function (spec, filter, repl) {</span>
<span class="cstat-no" title="statement not covered" >            if (filter) {  // a diff is requested</span>
<span class="cstat-no" title="statement not covered" >                var base = Spec.as(filter).tok('!');</span>
<span class="cstat-no" title="statement not covered" >                var diff = this.diff(base);</span>
<span class="cstat-no" title="statement not covered" >                if (diff) {</span>
<span class="cstat-no" title="statement not covered" >                    repl.deliver(spec.set('.init'), diff, this);</span>
                }
            }
        },
&nbsp;
        /** Unsubscribe */
        off: <span class="fstat-no" title="function not covered" >function (spec, val, repl) {</span>
<span class="cstat-no" title="statement not covered" >            var idx = this.getListenerIndex(repl); </span>//TODO ??? uplinks_only?
<span class="cstat-no" title="statement not covered" >            if (idx &gt; -1) {</span>
<span class="cstat-no" title="statement not covered" >                this._lstn.splice(idx, 1);</span>
            }
        },
&nbsp;
        /** Reciprocal unsubscription */
        reoff: <span class="fstat-no" title="function not covered" >function (spec, val, repl) {</span>
<span class="cstat-no" title="statement not covered" >            var idx = this.getListenerIndex(repl); </span>//TODO ??? uplinks_only?
<span class="cstat-no" title="statement not covered" >            if (idx &gt; -1) {</span>
<span class="cstat-no" title="statement not covered" >                this._lstn.splice(idx, 1);</span>
            }
<span class="cstat-no" title="statement not covered" >            if (this._id) {</span>
<span class="cstat-no" title="statement not covered" >                this.checkUplink();</span>
            }
        },
&nbsp;
        /**
         * As all the event/operation processing is asynchronous, we
         * cannot simply throw/catch exceptions over the network.
         * This method allows to send errors back asynchronously.
         * Sort of an asynchronous complaint mailbox :)
         */
        error: <span class="fstat-no" title="function not covered" >function (spec, val, repl) {</span>
<span class="cstat-no" title="statement not covered" >            console.error('something failed:', spec, val, '@', (repl &amp;&amp; repl._id));</span>
        }
&nbsp;
    }, // neutrals
&nbsp;
    ops: {
        /**
         * A state of a Syncable CRDT object is transferred to a replica using
         * some combination of POJO state and oplog. For example, a simple LWW
         * object (Last Writer Wins, see Model.js) uses its distilled oplog
         * as the most concise form. A CT document (Causal Trees) has a highly
         * compressed state, its log being hundred times heavier. Hence, it
         * mainly uses its plain state, but sometimes its log tail as well. The
         * format of the state object is POJO plus (optionally) special fields:
         * _oplog, _tail, _vector, _version (the latter flags POJO presence).
         * In either case, .init is only produced by diff() (+ by storage).
         * Any real-time changes are transferred as individual events.
         * @this {Syncable}
         */
        init: <span class="fstat-no" title="function not covered" >function (spec, state, src) {</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >            var tail = {}, // ops to be applied on top of the received state</span>
                typeid = spec.filter('/#'),
                lstn = this._lstn,
                a_spec;
<span class="cstat-no" title="statement not covered" >            this._lstn = []; </span>// prevent events from being fired
&nbsp;
<span class="cstat-no" title="statement not covered" >            if (state._version/* &amp;&amp; state._version !== '!0'*/) {</span>
                // local changes may need to be merged into the received state
<span class="cstat-no" title="statement not covered" >                if (this._oplog) {</span>
<span class="cstat-no" title="statement not covered" >                    for (a_spec in this._oplog) {</span>
<span class="cstat-no" title="statement not covered" >                        tail[a_spec] = this._oplog[a_spec];</span>
                    }
<span class="cstat-no" title="statement not covered" >                    this._oplog = {};</span>
                }
<span class="cstat-no" title="statement not covered" >                this._vector &amp;&amp; (this._vector = undefined);</span>
                // zero everything
<span class="cstat-no" title="statement not covered" >                for (var key in this) {</span>
<span class="cstat-no" title="statement not covered" >                    if (this.hasOwnProperty(key) &amp;&amp; key.charAt(0) !== '_') {</span>
<span class="cstat-no" title="statement not covered" >                        this[key] = undefined;</span>
                    }
                }
                // set default values
<span class="cstat-no" title="statement not covered" >                this.reset();</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >                this.apply(state);</span>
<span class="cstat-no" title="statement not covered" >                this._version = state._version;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >                state._oplog &amp;&amp; (this._oplog = state._oplog); </span>// FIXME copy
<span class="cstat-no" title="statement not covered" >                state._vector &amp;&amp; (this._vector = state._vector);</span>
            }
            // add the received tail to the local one
<span class="cstat-no" title="statement not covered" >            if (state._tail) {</span>
<span class="cstat-no" title="statement not covered" >                for (a_spec in state._tail) {</span>
<span class="cstat-no" title="statement not covered" >                    tail[a_spec] = state._tail[a_spec];</span>
                }
            }
            // appply the combined tail to the new state
<span class="cstat-no" title="statement not covered" >            var specs = [];</span>
<span class="cstat-no" title="statement not covered" >            for (a_spec in tail) {</span>
<span class="cstat-no" title="statement not covered" >                specs.push(a_spec);</span>
            }
<span class="cstat-no" title="statement not covered" >            specs.sort().reverse();</span>
            // there will be some replays, but those will be ignored
<span class="cstat-no" title="statement not covered" >            while (a_spec = specs.pop()) {</span>
<span class="cstat-no" title="statement not covered" >                this.deliver(typeid.add(a_spec), tail[a_spec], this);</span>
            }
&nbsp;
<span class="cstat-no" title="statement not covered" >            this._lstn = lstn;</span>
&nbsp;
        }
&nbsp;
    }, // ops
&nbsp;
&nbsp;
    /**
     * Uplink connections may be closed or reestablished so we need
     * to adjust every object's subscriptions time to time.
     * @this {Syncable}
     */
    checkUplink: <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >        var new_uplinks = this._host.getSources(this.spec()).slice(),</span>
            up, self = this;
        // the plan is to eliminate extra subscriptions and to
        // establish missing ones; that only affects outbound subs
<span class="cstat-no" title="statement not covered" >        for (var i = 0; i &lt; this._lstn.length &amp;&amp; this._lstn[i] != ','; i++) {</span>
<span class="cstat-no" title="statement not covered" >            up = this._lstn[i];</span>
<span class="cstat-no" title="statement not covered" >            if (!up) {</span>
<span class="cstat-no" title="statement not covered" >                continue;</span>
            }
<span class="cstat-no" title="statement not covered" >            up._src &amp;&amp; (up = up._src); </span>// unready
<span class="cstat-no" title="statement not covered" >            var up_idx = new_uplinks.indexOf(up);</span>
<span class="cstat-no" title="statement not covered" >            if (up_idx === -1) { // don't need this uplink anymore</span>
<span class="cstat-no" title="statement not covered" >                up.deliver(this.newEventSpec('off'), '', this);</span>
            } else {
<span class="cstat-no" title="statement not covered" >                new_uplinks[up_idx] = undefined;</span>
            }
        }
        // subscribe to the new
<span class="cstat-no" title="statement not covered" >        for (i = 0; i &lt; new_uplinks.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >            up = new_uplinks[i];</span>
<span class="cstat-no" title="statement not covered" >            if (!up) {</span>
<span class="cstat-no" title="statement not covered" >                continue;</span>
            }
<span class="cstat-no" title="statement not covered" >            var onspec = this.newEventSpec('on');</span>
<span class="cstat-no" title="statement not covered" >            this._lstn.unshift({</span>
                _op: 'reon',
                _src: up,
                deliver: <span class="fstat-no" title="function not covered" >function (spec, base, src) {</span>
<span class="cstat-no" title="statement not covered" >                    if (spec.version() !== onspec.version()) {</span>
<span class="cstat-no" title="statement not covered" >                        return;</span>
                    } // not mine
&nbsp;
<span class="cstat-no" title="statement not covered" >                    var i = self.getListenerIndex(this);</span>
<span class="cstat-no" title="statement not covered" >                    self._lstn[i] = up;</span>
                }
            });
<span class="cstat-no" title="statement not covered" >            up.deliver(onspec, this.version().toString(), this);</span>
        }
    },
&nbsp;
    /**
     * returns a Plain Javascript Object with the state
     * @this {Syncable}
     */
    pojo: <span class="fstat-no" title="function not covered" >function (addVersionInfo) {</span>
<span class="cstat-no" title="statement not covered" >        var pojo = {},</span>
            defs = this.constructor.defaults;
<span class="cstat-no" title="statement not covered" >        for (var key in this) {</span>
<span class="cstat-no" title="statement not covered" >            if (this.hasOwnProperty(key)) {</span>
<span class="cstat-no" title="statement not covered" >                if (Syncable.reFieldName.test(key) &amp;&amp; this[key] !== undefined) {</span>
<span class="cstat-no" title="statement not covered" >                    var def = defs[key],</span>
                        val = this[key];
<span class="cstat-no" title="statement not covered" >                    pojo[key] = def &amp;&amp; def.type ?</span>
                    (val.toJSON &amp;&amp; val.toJSON()) || val.toString() :
                            (val &amp;&amp; val._id ? val._id : val); // TODO prettify
                }
            }
        }
<span class="cstat-no" title="statement not covered" >        if (addVersionInfo) {</span>
<span class="cstat-no" title="statement not covered" >            pojo._id = this._id; </span>// not necassary
<span class="cstat-no" title="statement not covered" >            pojo._version = this._version;</span>
<span class="cstat-no" title="statement not covered" >            this._vector &amp;&amp; (pojo._vector = this._vector);</span>
<span class="cstat-no" title="statement not covered" >            this._oplog &amp;&amp; (pojo._oplog = this._oplog); </span>//TODO copy
        }
<span class="cstat-no" title="statement not covered" >        return pojo;</span>
    },
&nbsp;
    /**
     * Sometimes we get an operation we don't support; not normally
     * happens for a regular replica, but still needs to be caught
     */
    unimplemented: <span class="fstat-no" title="function not covered" >function (spec, val, repl) {</span>
<span class="cstat-no" title="statement not covered" >        console.warn("method not implemented:", spec);</span>
    },
&nbsp;
    /**
     * Deallocate everything, free all resources.
     */
    close: <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >        var l = this._lstn,</span>
            s = this.spec(),
            uplink;
&nbsp;
<span class="cstat-no" title="statement not covered" >        this._id = null; </span>// no id - no object; prevent relinking
<span class="cstat-no" title="statement not covered" >        while ((uplink = l.shift()) &amp;&amp; uplink !== ',') {</span>
<span class="cstat-no" title="statement not covered" >            uplink.off(s, null, this);</span>
        }
<span class="cstat-no" title="statement not covered" >        while (l.length) {</span>
<span class="cstat-no" title="statement not covered" >            l.pop().deliver(s.set('.reoff'), null, this);</span>
        }
<span class="cstat-no" title="statement not covered" >        this._host.unregister(this);</span>
    },
&nbsp;
    /**
     * Once an object is not listened by anyone it is perfectly safe
     * to garbage collect it.
     */
    gc: <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >        var l = this._lstn;</span>
<span class="cstat-no" title="statement not covered" >        if (!l.length || (l.length === 1 &amp;&amp; !l[0])) {</span>
<span class="cstat-no" title="statement not covered" >            this.close();</span>
        }
    },
&nbsp;
    /**
     * @param {string} filter event filter for subscription
     * @param {function} cb callback (will be called once)
     * @see Syncable#on
     */
    once: <span class="fstat-no" title="function not covered" >function (filter, cb) {</span>
<span class="cstat-no" title="statement not covered" >        this.on(filter, <span class="fstat-no" title="function not covered" >function onceWrap(spec, val, src) {</span></span>
            // "this" is the object (Syncable)
<span class="cstat-no" title="statement not covered" >            if (cb.constructor === Function) {</span>
<span class="cstat-no" title="statement not covered" >                cb.call(this, spec, val, src);</span>
            } else {
<span class="cstat-no" title="statement not covered" >                cb.deliver(spec, val, src);</span>
            }
<span class="cstat-no" title="statement not covered" >            this.off(filter, onceWrap);</span>
        });
    }
});
&nbsp;
&nbsp;
Syncable.reFieldName = /^[a-z][a-z0-9]*([A-Z][a-z0-9]*)*$/;
&nbsp;
/**
 * Derive version vector from a state of a Syncable object.
 * This is not a method as it needs to be applied to a flat JSON object.
 * @see Syncable.version
 * @see Spec.Map
 * @returns {string} string representation of Spec.Map
 */
Syncable.stateVersionVector = <span class="fstat-no" title="function not covered" >function stateVersionVector(state) {</span>
<span class="cstat-no" title="statement not covered" >    var op,</span>
        map = new Spec.Map( (state._version||'!0') + (state._vector || '') );
<span class="cstat-no" title="statement not covered" >    if (state._oplog) {</span>
<span class="cstat-no" title="statement not covered" >        for (op in state._oplog) {</span>
<span class="cstat-no" title="statement not covered" >            map.add(op);</span>
        }
    }
<span class="cstat-no" title="statement not covered" >    if (state._tail) {</span>
<span class="cstat-no" title="statement not covered" >        for (op in state._tail) {</span>
<span class="cstat-no" title="statement not covered" >            map.add(op);</span>
        }
    }
<span class="cstat-no" title="statement not covered" >    return map.toString();</span>
};
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/Text.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/Text.js</span></h1>
    <h2>
        
        Statements: <span class="metric">6.98% <small>(6 / 86)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 41)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 7)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">6.98% <small>(6 / 86)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/node_modules/swarm/lib/</a> &#187; Text.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
&nbsp;
var Spec = require('./Spec');
var Syncable = require('./Syncable');
&nbsp;
var Text = Syncable.extend('Text', {
    // naive uncompressed CT weave implementation
    defaults: {
        weave: '\n',
        ids: {type:Array, value:'00000+swarm'},
        text: '',
        _oplog: Object
    },
&nbsp;
    neutrals: {
        state: <span class="fstat-no" title="function not covered" >function (spec, text, src) {</span>
<span class="cstat-no" title="statement not covered" >            console.log('what?');</span>
        }
    },
    ops: {
        insert: <span class="fstat-no" title="function not covered" >function (spec, ins, src) {</span>
<span class="cstat-no" title="statement not covered" >            var w1 = [], w4 = [];</span>
<span class="cstat-no" title="statement not covered" >            var vt = spec.token('!'), v = vt.bare;</span>
<span class="cstat-no" title="statement not covered" >            var ts = v.substr(0, 5), seq = v.substr(5) || '00';</span>
<span class="cstat-no" title="statement not covered" >            var seqi = Spec.base2int(seq);</span>
<span class="cstat-no" title="statement not covered" >            for (var i = 0; i &lt; this.weave.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >                var id = this.ids[i];</span>
<span class="cstat-no" title="statement not covered" >                w1.push(this.weave.charAt(i));</span>
<span class="cstat-no" title="statement not covered" >                w4.push(id);</span>
<span class="cstat-no" title="statement not covered" >                if (id in ins) {</span>
<span class="cstat-no" title="statement not covered" >                    var str = ins[id].toString();</span>
<span class="cstat-no" title="statement not covered" >                    var k = i + 1;</span>
<span class="cstat-no" title="statement not covered" >                    while (k &lt; this.weave.length &amp;&amp; this.ids[k] &gt; vt.body) {</span>
<span class="cstat-no" title="statement not covered" >                        k++;</span>
                    }
<span class="cstat-no" title="statement not covered" >                    if (k &gt; i + 1) { // concurrent edits</span>
<span class="cstat-no" title="statement not covered" >                        var newid = this.ids[k - 1];</span>
<span class="cstat-no" title="statement not covered" >                        ins[newid] = ins[id];</span>
<span class="cstat-no" title="statement not covered" >                        delete ins[id];</span>
                    } else {
<span class="cstat-no" title="statement not covered" >                        for (var j = 0; j &lt; str.length; j++) {</span>
<span class="cstat-no" title="statement not covered" >                            w1.push(str.charAt(j)); </span>// FIXME overfill
<span class="cstat-no" title="statement not covered" >                            var genTs = ts + (seqi ? Spec.int2base(seqi++, 2) : '') + '+' + vt.ext;</span>
<span class="cstat-no" title="statement not covered" >                            w4.push(genTs);</span>
<span class="cstat-no" title="statement not covered" >                            if (!seqi) {</span>
<span class="cstat-no" title="statement not covered" >                                seqi = 1; </span>// FIXME repeat ids, double insert
                            }
                        }
                    }
                }
            }
<span class="cstat-no" title="statement not covered" >            if (genTs) {</span>
<span class="cstat-no" title="statement not covered" >                this._host.clock.checkTimestamp(genTs);</span>
            }
<span class="cstat-no" title="statement not covered" >            this.weave = w1.join('');</span>
<span class="cstat-no" title="statement not covered" >            this.ids = w4;</span>
<span class="cstat-no" title="statement not covered" >            this.rebuild();</span>
        },
        remove: <span class="fstat-no" title="function not covered" >function (spec, rm, src) {</span>
<span class="cstat-no" title="statement not covered" >            var w1 = [], w4 = [];</span>
<span class="cstat-no" title="statement not covered" >            var v = spec.version();</span>
<span class="cstat-no" title="statement not covered" >            for (var i = 0; i &lt; this.weave.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >                w1.push(this.weave.charAt(i));</span>
<span class="cstat-no" title="statement not covered" >                w4.push(this.ids[i]);</span>
<span class="cstat-no" title="statement not covered" >                if (this.ids[i] in rm) {</span>
<span class="cstat-no" title="statement not covered" >                    w1.push('\u0008');</span>
<span class="cstat-no" title="statement not covered" >                    w4.push(v);</span>
                }
            }
<span class="cstat-no" title="statement not covered" >            this.weave = w1.join('');</span>
<span class="cstat-no" title="statement not covered" >            this.ids = w4;</span>
<span class="cstat-no" title="statement not covered" >            this.rebuild();</span>
        }
    },
    rebuild: <span class="fstat-no" title="function not covered" >function () {</span>
        /*var re = /([^\u0008][\u0008]+)|([^\u0008])/g, m=[];
         var text = [], tids = [], pos = 0;
         while (m=re.exec(this.weave)) {
         if (m[2]) {
         text.push(m[2]);
         tids.push(this.ids[pos]);
         }
         pos += m[0].length;
         }
&nbsp;
         this.tids = tids;*/
<span class="cstat-no" title="statement not covered" >        this.text = this.weave.replace(/[^\u0008][\u0008]+/mg, '').substr(1);</span>
    },
    set: <span class="fstat-no" title="function not covered" >function (newText) {</span>
<span class="cstat-no" title="statement not covered" >        var patch = Text.diff(this.text, newText);</span>
<span class="cstat-no" title="statement not covered" >        var rm = null, ins = null, weave = this.weave;</span>
<span class="cstat-no" title="statement not covered" >        var re_atom = /[^\u0008]([^\u0008][\u0008]+)*/mg;</span>
<span class="cstat-no" title="statement not covered" >        var atom;</span>
&nbsp;
<span class="fstat-no" title="function not covered" >        function skip(n) {</span>
<span class="cstat-no" title="statement not covered" >            for (n = n || 1; n &gt; 0; n--) {</span>
<span class="cstat-no" title="statement not covered" >                atom = re_atom.exec(weave);</span>
            }
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        skip(1); </span>// \n #00000+swarm
&nbsp;
<span class="cstat-no" title="statement not covered" >        for (var i = 0; i &lt; patch.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >            var op = patch[i][0], val = patch[i][1];</span>
<span class="cstat-no" title="statement not covered" >            switch (op) {</span>
            case '+':
<span class="cstat-no" title="statement not covered" >                ins || (ins = {});</span>
<span class="cstat-no" title="statement not covered" >                ins[this.ids[atom.index]] = val;</span>
<span class="cstat-no" title="statement not covered" >                break;</span>
            case '-':
<span class="cstat-no" title="statement not covered" >                rm || (rm = {});</span>
<span class="cstat-no" title="statement not covered" >                for (var r = 0; r &lt; val.length; r++) {</span>
<span class="cstat-no" title="statement not covered" >                    rm[this.ids[atom.index + atom[0].length]] = true;</span>
<span class="cstat-no" title="statement not covered" >                    skip();</span>
                }
<span class="cstat-no" title="statement not covered" >                break;</span>
            case '=':
<span class="cstat-no" title="statement not covered" >                skip(val.length);</span>
            }
        }
<span class="cstat-no" title="statement not covered" >        rm &amp;&amp; this.remove(rm);</span>
<span class="cstat-no" title="statement not covered" >        ins &amp;&amp; this.insert(ins);</span>
    }
});
&nbsp;
Text.diff = <span class="fstat-no" title="function not covered" >function diff(was, is) {</span>
<span class="cstat-no" title="statement not covered" >    var ret = [];</span>
    // prefix suffix the rest is change
<span class="cstat-no" title="statement not covered" >    var pre = 0;</span>
<span class="cstat-no" title="statement not covered" >    while (pre &lt; was.length &amp;&amp; pre &lt; is.length &amp;&amp; was.charAt(pre) === is.charAt(pre)) {</span>
<span class="cstat-no" title="statement not covered" >        pre++;</span>
    }
<span class="cstat-no" title="statement not covered" >    var post = 0;</span>
<span class="cstat-no" title="statement not covered" >    while (post &lt; was.length - pre &amp;&amp; post &lt; is.length - pre &amp;&amp;</span>
    was.charAt(was.length - post - 1) === is.charAt(is.length - post - 1)) {
<span class="cstat-no" title="statement not covered" >        post++;</span>
    }
<span class="cstat-no" title="statement not covered" >    if (pre) {</span>
<span class="cstat-no" title="statement not covered" >        ret.push(['=', was.substr(0, pre)]);</span>
    }
<span class="cstat-no" title="statement not covered" >    var ins = is.length - pre - post;</span>
<span class="cstat-no" title="statement not covered" >    if (ins) {</span>
<span class="cstat-no" title="statement not covered" >        ret.push(['+', is.substr(pre, ins)]);</span>
    }
<span class="cstat-no" title="statement not covered" >    var rm = was.length - pre - post;</span>
<span class="cstat-no" title="statement not covered" >    if (rm) {</span>
<span class="cstat-no" title="statement not covered" >        ret.push(['-', was.substr(pre, rm)]);</span>
    }
<span class="cstat-no" title="statement not covered" >    if (post) {</span>
<span class="cstat-no" title="statement not covered" >        ret.push(['=', was.substr(pre + rm)]);</span>
    }
<span class="cstat-no" title="statement not covered" >    return ret;</span>
&nbsp;
};
&nbsp;
module.exports = Text;
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/Vector.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/Vector.js</span></h1>
    <h2>
        
        Statements: <span class="metric">4.58% <small>(6 / 131)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 72)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 29)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">4.62% <small>(6 / 130)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/node_modules/swarm/lib/</a> &#187; Vector.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
&nbsp;
var Spec = require('./Spec');
var LongSpec = require('./LongSpec');
var Syncable = require('./Syncable');
var ProxyListener = require('./ProxyListener');
var CollectionMethodsMixin = require('./CollectionMethodsMixin');
&nbsp;
/** In distributed environments, linear structures are tricky. It is always
 *  recommended to use (sorted) Set as your default collection type. Still, in
 *  some cases we need precisely a Vector, so here it is. Note that a vector can
 *  not prune its mutation history for quite a while, so it is better not to
 *  sort (reorder) it repeatedly. The perfect usage pattern is a growing vector+
 *  insert sort or no sort at all. If you need to re-shuffle a vector
 *  differently or replace its contents, you'd better create a new vector.
 *  So, you've been warned.
 *  Vector is implemented on top of a LongSpec, so the API is very much alike.
 *  The replication/convergence/correctness algorithm is Causal Trees.
 *
 *  TODO support JSON types (as a part of ref-gen-refac)
 */
module.exports = Syncable.extend('Vector', {
&nbsp;
    defaults: {
        _oplog: Object,
        _objects: Array,
        _order: LongSpec,
        _proxy: ProxyListener
    },
&nbsp;
    mixins: [
        CollectionMethodsMixin
    ],
&nbsp;
    ops: {  // operations is our assembly language
&nbsp;
        // insert an object
        in: <span class="fstat-no" title="function not covered" >function (spec, value, src) {</span>
            // we misuse specifiers to express the operation in
            // a compact non-ambiguous way
<span class="cstat-no" title="statement not covered" >            value = new Spec(value);</span>
<span class="cstat-no" title="statement not covered" >            var opid = spec.tok('!');</span>
<span class="cstat-no" title="statement not covered" >            var at = value.tok('!');</span>
<span class="cstat-no" title="statement not covered" >            if (opid&lt;=at) {</span>
<span class="cstat-no" title="statement not covered" >                throw new Error('timestamps are messed up');</span>
            }
<span class="cstat-no" title="statement not covered" >            var what = value.tok('#');</span>
<span class="cstat-no" title="statement not covered" >            if (!what) { <span class="cstat-no" title="statement not covered" >throw new Error('object #id not specified'); </span>}</span>
<span class="cstat-no" title="statement not covered" >            var type = value.get('/');</span>
<span class="cstat-no" title="statement not covered" >            if (!type &amp;&amp; this.objectType) {</span>
<span class="cstat-no" title="statement not covered" >                type = this.objectType.prototype._type;</span>
            }
<span class="cstat-no" title="statement not covered" >            if (!type) {</span>
<span class="cstat-no" title="statement not covered" >                throw new Error('object /type not specified');</span>
            }
<span class="cstat-no" title="statement not covered" >            type = '/' + type;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >            var pos = this.findPositionFor(opid, at?at:'!0');</span>
<span class="cstat-no" title="statement not covered" >            var obj = this._host.get(type+what);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >            this._objects.splice(pos.index,0,obj);</span>
<span class="cstat-no" title="statement not covered" >            this._order.insert(opid,pos);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >            obj.on(this._proxy);</span>
        },
&nbsp;
        // remove an object
        rm: <span class="fstat-no" title="function not covered" >function (spec, value, src) {</span>
<span class="cstat-no" title="statement not covered" >            value = Spec.as(value);</span>
<span class="cstat-no" title="statement not covered" >            var target = value.tok('!');</span>
<span class="cstat-no" title="statement not covered" >            var hint = value.has('.') ? Spec.base2int(value.get('.')) : 0;</span>
<span class="cstat-no" title="statement not covered" >            var at = this._order.find(target, Math.max(0,hint-5));</span>
<span class="cstat-no" title="statement not covered" >            if (at.end()) {</span>
<span class="cstat-no" title="statement not covered" >                at = this._order.find(target, 0);</span>
            }
<span class="cstat-no" title="statement not covered" >            if (at.end()) {</span>
                // this can only be explained by concurrent deletion
                // partial order can't break cause-and-effect ordering
<span class="cstat-no" title="statement not covered" >                return;</span>
            }
<span class="cstat-no" title="statement not covered" >            var obj = this._objects[at.index];</span>
<span class="cstat-no" title="statement not covered" >            this._objects.splice(at.index,1);</span>
<span class="cstat-no" title="statement not covered" >            at.erase(1);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >            obj.off(this._proxy);</span>
        }
&nbsp;
        /** Either thombstones or log  before HORIZON
        patch: function (spec, value, src) {
&nbsp;
        }*/
&nbsp;
    },
&nbsp;
    distillLog: <span class="fstat-no" title="function not covered" >function () {</span>
        // TODO HORIZON
    },
&nbsp;
    reactions: {
&nbsp;
        'init': <span class="fstat-no" title="function not covered" >function fillAll (spec,val,src) {</span> // TODO: reactions, state init tests
<span class="cstat-no" title="statement not covered" >            for(var i=this._order.iterator(); !i.end(); i.next()) {</span>
<span class="cstat-no" title="statement not covered" >                var op = i.token() + '.in';</span>
<span class="cstat-no" title="statement not covered" >                var value = this._oplog[op];</span>
<span class="cstat-no" title="statement not covered" >                var obj = this.getObject(value);</span>
<span class="cstat-no" title="statement not covered" >                this._objects[i.index] = obj;</span>
<span class="cstat-no" title="statement not covered" >                obj.on(this._proxy);</span>
            }
        }
&nbsp;
    },
&nbsp;
    pojo: <span class="fstat-no" title="function not covered" >function () {</span>
        // invoke super.pojo()
<span class="cstat-no" title="statement not covered" >        var result = Syncable._pt.pojo.apply(this, arguments);</span>
<span class="cstat-no" title="statement not covered" >        result.entries = Object.keys(this._objects);</span>
<span class="cstat-no" title="statement not covered" >        return result;</span>
    },
&nbsp;
    getObject: <span class="fstat-no" title="function not covered" >function (spec) {</span>
<span class="cstat-no" title="statement not covered" >        spec = new Spec(spec,'#');</span>
<span class="cstat-no" title="statement not covered" >        if (!spec.has('/')) {</span>
<span class="cstat-no" title="statement not covered" >            if (this.objectType) {</span>
<span class="cstat-no" title="statement not covered" >                spec = spec.add(this.objectType.prototype._type,'/').sort();</span>
            } else {
<span class="cstat-no" title="statement not covered" >                throw new Error("type not specified"); </span>// TODO is it necessary at all?
            }
        }
<span class="cstat-no" title="statement not covered" >        var obj = this._host.get(spec);</span>
<span class="cstat-no" title="statement not covered" >        return obj;</span>
    },
&nbsp;
    length: <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >        return this._objects.length;</span>
    },
&nbsp;
    //  C A U S A L  T R E E S  M A G I C
&nbsp;
    findPositionFor: <span class="fstat-no" title="function not covered" >function (id, parentId) {</span> // FIXME protected methods &amp;&amp; statics (entryType)
<span class="cstat-no" title="statement not covered" >        if (!parentId) {</span>
<span class="cstat-no" title="statement not covered" >            parentId = this.getParentOf(id);</span>
        }
<span class="cstat-no" title="statement not covered" >        var next;</span>
<span class="cstat-no" title="statement not covered" >        if (parentId!=='!0') {</span>
<span class="cstat-no" title="statement not covered" >            next = this._order.find(parentId);</span>
<span class="cstat-no" title="statement not covered" >            if (next.end()) {</span>
<span class="cstat-no" title="statement not covered" >                next = this.findPositionFor(parentId);</span>
            }
<span class="cstat-no" title="statement not covered" >            next.next();</span>
        } else {
<span class="cstat-no" title="statement not covered" >            next = this._order.iterator();</span>
        }
        // skip "younger" concurrent siblings
<span class="cstat-no" title="statement not covered" >        while (!next.end()) {</span>
<span class="cstat-no" title="statement not covered" >            var nextId = next.token();</span>
<span class="cstat-no" title="statement not covered" >            if (nextId&lt;id) {</span>
<span class="cstat-no" title="statement not covered" >                break;</span>
            }
<span class="cstat-no" title="statement not covered" >            var subtreeId = this.inSubtreeOf(nextId,parentId);</span>
<span class="cstat-no" title="statement not covered" >            if (!subtreeId || subtreeId&lt;id) {</span>
<span class="cstat-no" title="statement not covered" >                break;</span>
            }
<span class="cstat-no" title="statement not covered" >            this.skipSubtree(next,subtreeId);</span>
        }
<span class="cstat-no" title="statement not covered" >        return next; </span>// insert before
    },
&nbsp;
    getParentOf: <span class="fstat-no" title="function not covered" >function (id) {</span>
<span class="cstat-no" title="statement not covered" >        var spec = this._oplog[id+'.in'];</span>
<span class="cstat-no" title="statement not covered" >        if (!spec) {</span>
<span class="cstat-no" title="statement not covered" >            throw new Error('operation unknown: '+id);</span>
        }
<span class="cstat-no" title="statement not covered" >        var parentId = Spec.as(spec).tok('!') || '!0';</span>
<span class="cstat-no" title="statement not covered" >        return parentId;</span>
    },
&nbsp;
    /** returns the immediate child of the root node that is an ancestor
      * of the given node. */
    inSubtreeOf: <span class="fstat-no" title="function not covered" >function (nodeId, rootId) {</span>
<span class="cstat-no" title="statement not covered" >        var id=nodeId, p=id;</span>
<span class="cstat-no" title="statement not covered" >        while (id&gt;rootId) {</span>
<span class="cstat-no" title="statement not covered" >            p=id;</span>
<span class="cstat-no" title="statement not covered" >            id=this.getParentOf(id);</span>
        }
<span class="cstat-no" title="statement not covered" >        return id===rootId &amp;&amp; p;</span>
    },
&nbsp;
    isDescendantOf: <span class="fstat-no" title="function not covered" >function (nodeId, rootId) {</span>
<span class="cstat-no" title="statement not covered" >        var i=nodeId;</span>
<span class="cstat-no" title="statement not covered" >        while (i&gt;rootId) {</span>
<span class="cstat-no" title="statement not covered" >            i=this.getParentOf(i);</span>
        }
<span class="cstat-no" title="statement not covered" >        return i===rootId;</span>
    },
&nbsp;
    skipSubtree: <span class="fstat-no" title="function not covered" >function (iter, root) {</span>
<span class="cstat-no" title="statement not covered" >        root = root || iter.token();</span>
<span class="cstat-no" title="statement not covered" >        do {</span>
<span class="cstat-no" title="statement not covered" >            iter.next();</span>
        } while (!iter.end() &amp;&amp; this.isDescendantOf(iter.token(),root));
<span class="cstat-no" title="statement not covered" >        return iter;</span>
    },
&nbsp;
    validate: <span class="fstat-no" title="function not covered" >function (spec, val, source) {</span>
        // ref op is known
    },
&nbsp;
    //  A R R A Y - L I K E  A P I
    //  wrapper methods that convert into op calls above
&nbsp;
    indexOf: <span class="fstat-no" title="function not covered" >function (obj, startAt) {</span>
<span class="cstat-no" title="statement not covered" >        if (!obj._id) {</span>
<span class="cstat-no" title="statement not covered" >            obj = this.getObject(obj);</span>
        }
<span class="cstat-no" title="statement not covered" >        return this._objects.indexOf(obj,startAt);</span>
    },
&nbsp;
    /*splice: function (offset, removeCount, insert) {
        var ref = offset===-1 ? '' : this._objects[offset];
        var del = [];
        var hint;
        for (var rm=1; rm&lt;=removeCount; rm++) {
            del.push(this._order.entryAt(offset+rm));
        }
        for(var a=3; a&lt;this.arguments.length; a++) {
            var arg = this.arguments[a];
            arg = _id in arg ? arg._id : arg;
            if (!Spec.isId(arg)) { throw new Error('malformed id: '+arg); }
            ins.push(arg);
        }
        while (rmid=del.pop()) {
            this.del(rmid+hint);
        }
        while (insid=ins.pop()) {
            this.ins(ref+insid+hint);
        }
    },*/
&nbsp;
    normalizePos: <span class="fstat-no" title="function not covered" >function (pos) {</span>
<span class="cstat-no" title="statement not covered" >        if (pos &amp;&amp; pos._id) {</span>
<span class="cstat-no" title="statement not covered" >            pos=pos._id;</span>
        }
<span class="cstat-no" title="statement not covered" >        var spec = new Spec(pos,'#');</span>
<span class="cstat-no" title="statement not covered" >        var type = spec.type();</span>
<span class="cstat-no" title="statement not covered" >        var id = spec.id();</span>
<span class="cstat-no" title="statement not covered" >        for(var i=0; i&lt;this._objects.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >            var obj = this._objects[i];</span>
<span class="cstat-no" title="statement not covered" >            if (obj &amp;&amp; obj._id===id &amp;&amp; (!type || obj._type===type)) {</span>
<span class="cstat-no" title="statement not covered" >                break;</span>
            }
        }
<span class="cstat-no" title="statement not covered" >        return i;</span>
    },
&nbsp;
    /** Assuming position 0 on the "left" and left-to-right writing, the
      * logic of causal tree insertion is
      * insert(newEntry, parentWhichIsOnTheLeftSide). */
    insert: <span class="fstat-no" title="function not covered" >function (spec, pos) {</span>
        // TODO bulk insert: make'em siblings
<span class="cstat-no" title="statement not covered" >        if (pos===undefined) {</span>
<span class="cstat-no" title="statement not covered" >            pos = -1; </span>// TODO ? this._order.length()
        }
<span class="cstat-no" title="statement not covered" >        if (pos.constructor!==Number) {</span>
<span class="cstat-no" title="statement not covered" >            pos = this.normalizePos(pos);</span>
        }
<span class="cstat-no" title="statement not covered" >        if (spec &amp;&amp; spec._id) {</span>
<span class="cstat-no" title="statement not covered" >            spec = spec.spec();</span>
        } else /*if (spec.constructor===String)*/ {
<span class="cstat-no" title="statement not covered" >            spec = new Spec(spec,'#');</span>
        }
        // TODO new object
<span class="cstat-no" title="statement not covered" >        var opid = pos===-1 ? '!0' : this._order.tokenAt(pos);</span>
        // TODO hint pos
<span class="cstat-no" title="statement not covered" >        return this.in(spec+opid);</span>
    },
&nbsp;
    insertAfter: <span class="fstat-no" title="function not covered" >function (obj, pos) {</span>
<span class="cstat-no" title="statement not covered" >        this.insert (obj,pos);</span>
    },
&nbsp;
    insertBefore: <span class="fstat-no" title="function not covered" >function (spec, pos) {</span>
<span class="cstat-no" title="statement not covered" >        if (pos===undefined) {</span>
<span class="cstat-no" title="statement not covered" >            pos = this._order.length();</span>
        }
<span class="cstat-no" title="statement not covered" >        if (pos.constructor!==Number) {</span>
<span class="cstat-no" title="statement not covered" >            pos = this.normalizePos(pos);</span>
        }
<span class="cstat-no" title="statement not covered" >        this.insert(spec,pos-1);</span>
    },
&nbsp;
    append: <span class="fstat-no" title="function not covered" >function append (spec) {</span>
<span class="cstat-no" title="statement not covered" >        this.insert(spec,this._order.length()-1);</span>
    },
&nbsp;
    remove: <span class="fstat-no" title="function not covered" >function remove (pos) {</span>
<span class="cstat-no" title="statement not covered" >        if (pos.constructor!==Number) {</span>
<span class="cstat-no" title="statement not covered" >            pos = this.normalizePos(pos);</span>
        }
<span class="cstat-no" title="statement not covered" >        var hint = Spec.int2base(pos,0);</span>
<span class="cstat-no" title="statement not covered" >        var op = this._order.tokenAt(pos);</span>
<span class="cstat-no" title="statement not covered" >        this.rm(op+'.'+hint); </span>// TODO generic spec quants
    },
&nbsp;
    // Set-compatible, in a sense
    addObject: <span class="fstat-no" title="function not covered" >function (obj) {</span>
<span class="cstat-no" title="statement not covered" >        this.append(obj);</span>
    },
&nbsp;
    removeObject: <span class="fstat-no" title="function not covered" >function (pos) {</span>
<span class="cstat-no" title="statement not covered" >        this.remove(pos);</span>
    },
&nbsp;
    objectAt: <span class="fstat-no" title="function not covered" >function (i) {</span>
<span class="cstat-no" title="statement not covered" >        return this._objects[i];</span>
    },
&nbsp;
    insertSorted: <span class="fstat-no" title="function not covered" >function (obj, cmp) {</span>
    },
&nbsp;
    setOrder: <span class="fstat-no" title="function not covered" >function (fn) {</span>
    },
&nbsp;
    forEach: <span class="fstat-no" title="function not covered" >function (cb, thisArg) {</span>
<span class="cstat-no" title="statement not covered" >        this._objects.forEach(cb, thisArg);</span>
    },
&nbsp;
    every: <span class="fstat-no" title="function not covered" >function (cb, thisArg) {</span>
<span class="cstat-no" title="statement not covered" >        return this._objects.every(cb, thisArg);</span>
    },
&nbsp;
    filter: <span class="fstat-no" title="function not covered" >function (cb, thisArg) {</span>
<span class="cstat-no" title="statement not covered" >        return this._objects.filter(cb, thisArg);</span>
    },
&nbsp;
    map: <span class="fstat-no" title="function not covered" >function (cb, thisArg) {</span>
<span class="cstat-no" title="statement not covered" >        return this._objects.map(cb, thisArg);</span>
    }
&nbsp;
});
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/WebSocketStream.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/WebSocketStream.js</span></h1>
    <h2>
        
        Statements: <span class="metric">19.35% <small>(6 / 31)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 10)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 8)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">20.69% <small>(6 / 29)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/node_modules/swarm/lib/</a> &#187; WebSocketStream.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
&nbsp;
var env = require('./env');
&nbsp;
<span class="fstat-no" title="function not covered" >function WebSocketStream(url) {</span>
<span class="cstat-no" title="statement not covered" >    var self = this;</span>
<span class="cstat-no" title="statement not covered" >    var ln = this.lstn = {};</span>
<span class="cstat-no" title="statement not covered" >    this.url = url;</span>
<span class="cstat-no" title="statement not covered" >    var ws = this.ws = new WebSocket(url);</span>
<span class="cstat-no" title="statement not covered" >    var buf = this.buf = [];</span>
<span class="cstat-no" title="statement not covered" >    ws.onopen = <span class="fstat-no" title="function not covered" >function () {</span></span>
<span class="cstat-no" title="statement not covered" >        buf.reverse();</span>
<span class="cstat-no" title="statement not covered" >        self.buf = null;</span>
<span class="cstat-no" title="statement not covered" >        while (buf.length) {</span>
<span class="cstat-no" title="statement not covered" >            self.write(buf.pop());</span>
        }
&nbsp;
    };
<span class="cstat-no" title="statement not covered" >    ws.onclose = <span class="fstat-no" title="function not covered" >function () {</span> <span class="cstat-no" title="statement not covered" >ln.close &amp;&amp; ln.close(); </span>};</span>
<span class="cstat-no" title="statement not covered" >    ws.onmessage = <span class="fstat-no" title="function not covered" >function (msg) {</span></span>
<span class="cstat-no" title="statement not covered" >        ln.data &amp;&amp; ln.data(msg.data);</span>
    };
<span class="cstat-no" title="statement not covered" >    ws.onerror = <span class="fstat-no" title="function not covered" >function (err) {</span> <span class="cstat-no" title="statement not covered" >ln.error &amp;&amp; ln.error(err); </span>};</span>
}
&nbsp;
WebSocketStream.prototype.on = <span class="fstat-no" title="function not covered" >function (evname, fn) {</span>
<span class="cstat-no" title="statement not covered" >    if (evname in this.lstn) {</span>
<span class="cstat-no" title="statement not covered" >        var self = this,</span>
            prev_fn = this.lstn[evname];
<span class="cstat-no" title="statement not covered" >        this.lstn[evname] = <span class="fstat-no" title="function not covered" >function () {</span></span>
<span class="cstat-no" title="statement not covered" >            prev_fn.apply(self, arguments);</span>
<span class="cstat-no" title="statement not covered" >            fn.apply(self, arguments);</span>
        };
    } else {
<span class="cstat-no" title="statement not covered" >        this.lstn[evname] = fn;</span>
    }
};
&nbsp;
WebSocketStream.prototype.write = <span class="fstat-no" title="function not covered" >function (data) {</span>
<span class="cstat-no" title="statement not covered" >    if (this.buf) {</span>
<span class="cstat-no" title="statement not covered" >        this.buf.push(data);</span>
    } else {
<span class="cstat-no" title="statement not covered" >        this.ws.send(data);</span>
    }
};
&nbsp;
env.streams.ws = env.streams.wss = WebSocketStream;
module.exports = WebSocketStream;
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/ce.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/ce.js</span></h1>
    <h2>
        
        Statements: <span class="metric">9.6% <small>(12 / 125)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 70)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 13)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">10.08% <small>(12 / 119)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/node_modules/swarm/lib/</a> &#187; ce.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/* jshint ignore: start */
// FIXME UPDATE cherrypick
&nbsp;
<span class="fstat-no" title="function not covered" >function format2str (format) {</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function htmlesc (text) {</span>
<span class="cstat-no" title="statement not covered" >    return text;</span>
}
&nbsp;
/// range/ids -???  first, all   then...
&nbsp;
<span class="fstat-no" title="function not covered" >function rtf2txt (rtf) {</span>
<span class="cstat-no" title="statement not covered" >    var txt = rtf.filter(<span class="fstat-no" title="function not covered" >function(o){</span> <span class="cstat-no" title="statement not covered" >return o &amp;&amp; o.constructor===String }</span>);</span>
<span class="cstat-no" title="statement not covered" >    return txt.join('');</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function meta2attstr (meta) {</span>
<span class="cstat-no" title="statement not covered" >    var ret = [], styles={}, classes={}, atts={}, structs={};</span>
<span class="cstat-no" title="statement not covered" >    var kv = {':':styles,'_':classes,'=':atts,'s':structs};</span>
<span class="cstat-no" title="statement not covered" >    var re_meta = /^(\w[\w_\-]*)([:_=]?)$/, m;</span>
<span class="cstat-no" title="statement not covered" >    for(key in meta)</span>
<span class="cstat-no" title="statement not covered" >        if (m=re_meta.exec(key))</span>
<span class="cstat-no" title="statement not covered" >            kv [m[2]||'s'] [m[1]] = meta[key];</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    ret.push(' class="');</span>
<span class="cstat-no" title="statement not covered" >    for (var c in classes)</span>
<span class="cstat-no" title="statement not covered" >        ret.push(c, '_', classes[c], ' ');</span>
<span class="cstat-no" title="statement not covered" >    ret.pop()===' ' &amp;&amp; ret.push('"');</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    ret.push(' style="');</span>
<span class="cstat-no" title="statement not covered" >    for (var s in styles)</span>
<span class="cstat-no" title="statement not covered" >        ret.push(s, ':', styles[s], ';');</span>
<span class="cstat-no" title="statement not covered" >    ret.pop() === ';' &amp;&amp; ret.push('"');</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    for (var a in atts)</span>
<span class="cstat-no" title="statement not covered" >        ret.push(' ', a, '="', atts[a], '"'); </span>// TODO esc "
&nbsp;
<span class="cstat-no" title="statement not covered" >    return ret.join('');</span>
};
&nbsp;
&nbsp;
<span class="fstat-no" title="function not covered" >function rtf2html (origRTF) {</span> // TODO meta_in, indent
<span class="cstat-no" title="statement not covered" >    !origRTF &amp;&amp; (origRTF='');</span>
<span class="cstat-no" title="statement not covered" >    origRTF.constructor===String &amp;&amp; (origRTF=[origRTF]);</span>
<span class="cstat-no" title="statement not covered" >    var html = [], openTag = null, rtf=origRTF.slice(0).reverse();</span>
<span class="cstat-no" title="statement not covered" >    var frg, format={};</span>
<span class="cstat-no" title="statement not covered" >    while (frg=rtf.pop()) {</span>
<span class="cstat-no" title="statement not covered" >        if (frg.constructor===Object) {</span>
<span class="cstat-no" title="statement not covered" >            format = frg;</span>
<span class="cstat-no" title="statement not covered" >            continue;</span>
        } else <span class="cstat-no" title="statement not covered" >if (frg.constructor!==String)</span>
<span class="cstat-no" title="statement not covered" >            throw new Error('format violation: ',frg);</span>
<span class="cstat-no" title="statement not covered" >        var head = frg.charAt(0);</span>
<span class="cstat-no" title="statement not covered" >        if (head==='\n') {</span>
            // plant open/close // use struct markers
<span class="cstat-no" title="statement not covered" >            if (openTag) {</span>
<span class="cstat-no" title="statement not covered" >                html.push('&lt;/',openTag,'&gt;\n');</span>
<span class="cstat-no" title="statement not covered" >                openTag = null;</span>
            }
            // TODO check structf for indent/nesting
<span class="cstat-no" title="statement not covered" >            if (format.head)</span>
<span class="cstat-no" title="statement not covered" >                openTag = 'h'+format.head;</span>
            else
<span class="cstat-no" title="statement not covered" >                openTag = 'p';</span>
<span class="cstat-no" title="statement not covered" >            html.push('&lt;',openTag,'&gt;'); </span>// TODO pid
<span class="cstat-no" title="statement not covered" >            frg = frg.substr(1);</span>
        }
        //find next struct (lookahead; had \n =&gt; check for \t)
<span class="cstat-no" title="statement not covered" >        var n = frg.indexOf('\n',1);</span>
<span class="cstat-no" title="statement not covered" >        if (n!==-1) { // repair</span>
<span class="cstat-no" title="statement not covered" >            rtf.push(frg.substr(n));</span>
<span class="cstat-no" title="statement not covered" >            frg = frg.substr(0,n);</span>
        }
<span class="cstat-no" title="statement not covered" >        var atts = meta2attstr(format);</span>
<span class="cstat-no" title="statement not covered" >        html.push('&lt;span',atts,'&gt;',htmlesc(frg),'&lt;/span&gt;');</span>
    }
<span class="cstat-no" title="statement not covered" >    openTag &amp;&amp; html.push('&lt;/',openTag,'&gt;\n');</span>
<span class="cstat-no" title="statement not covered" >    return html.join('');</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function DOMEditor (root) {</span>
}
&nbsp;
DOMEditor.prototype.setRTF = <span class="fstat-no" title="function not covered" >function (range, rtf) {</span>
<span class="cstat-no" title="statement not covered" >    var html = rtf2html(rtf);</span>
    // staging element
<span class="cstat-no" title="statement not covered" >    body.innerHTML = html;</span>
    /*
    var from=range.get('#'), till=range.get('#',from);
    // clean DOM range
    for(var pid=from; pid &amp;&amp; pid!==till; pid=???)
        body.removeChild(pid);
    // install
    while ()
        body.insertBefore(newp,till); // TODO batch?
    // recover selection
    // */
};
&nbsp;
&nbsp;
//DOMEditor.prototype.getRTF = function (from, till, format, rtf) {
<span class="fstat-no" title="function not covered" >function dom2rtf (from, till, format, rtf) {</span>
<span class="cstat-no" title="statement not covered" >    rtf = rtf || [];</span>
<span class="cstat-no" title="statement not covered" >    format = format || {};</span>
<span class="cstat-no" title="statement not covered" >    if (till &amp;&amp; from.parentNode!==till.parentNode) <span class="cstat-no" title="statement not covered" >throw 'not siblings';</span></span>
<span class="cstat-no" title="statement not covered" >    for(var i=from; i &amp;&amp; i!==till; i=i.nextSibling)</span>
<span class="cstat-no" title="statement not covered" >        if (i.nodeType===Document.ELEMENT_NODE) {</span>
<span class="cstat-no" title="statement not covered" >            var child_format = {};</span>
<span class="cstat-no" title="statement not covered" >            for(var key in format)</span>
<span class="cstat-no" title="statement not covered" >                child_format[key] = format[key];</span>
<span class="cstat-no" title="statement not covered" >            switch (i.nodeName.toUpperCase()) {</span>
                case 'B':  <span class="cstat-no" title="statement not covered" >child_format['font-weight:'] = 'bold'; <span class="cstat-no" title="statement not covered" ></span>break;</span>
                case 'BR': // rtf.push(struct);
<span class="cstat-no" title="statement not covered" >                           rtf.push('\n');</span>
<span class="cstat-no" title="statement not covered" >                           break;</span>
                case 'UL': <span class="cstat-no" title="statement not covered" >child_format['list'] = 'o'; <span class="cstat-no" title="statement not covered" ></span>break;</span>
                case 'LI': <span class="cstat-no" title="statement not covered" >rtf.push('\n'); <span class="cstat-no" title="statement not covered" ></span>break;</span>
                case 'P':  <span class="cstat-no" title="statement not covered" >rtf.push(child_format,'\n'); <span class="cstat-no" title="statement not covered" ></span>break;</span>
                case 'H1': <span class="cstat-no" title="statement not covered" >child_format['head'] = 1;</span>
<span class="cstat-no" title="statement not covered" >                           rtf.push(child_format,'\n');</span>
<span class="cstat-no" title="statement not covered" >                           break;</span>
            }
<span class="cstat-no" title="statement not covered" >            dom2rtf(i.firstChild,null,child_format,rtf);</span>
        } else <span class="cstat-no" title="statement not covered" >if (i.nodeType===Document.TEXT_NODE) {</span>
<span class="cstat-no" title="statement not covered" >            rtf.push(format);</span>
<span class="cstat-no" title="statement not covered" >            rtf.push(i.nodeValue.replace(/\n/g,'')); </span>// TODO \n spaces
        } else {
        }
<span class="cstat-no" title="statement not covered" >    return rtf;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function normalizeRTF (rtf) {</span>
<span class="cstat-no" title="statement not covered" >    var ret = [], format = {}, prev = undefined;</span>
<span class="cstat-no" title="statement not covered" >    for(var i=0; i&lt;rtf.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >        var n = rtf[i];</span>
<span class="cstat-no" title="statement not covered" >        if (!n)</span>
<span class="cstat-no" title="statement not covered" >            continue;</span>
<span class="cstat-no" title="statement not covered" >        if (n.constructor===String) {</span>
<span class="cstat-no" title="statement not covered" >            if (prev &amp;&amp; prev.constructor===String)</span>
<span class="cstat-no" title="statement not covered" >                ret.push(ret.pop()+n);</span>
            else
<span class="cstat-no" title="statement not covered" >                ret.push(n);</span>
        } else <span class="cstat-no" title="statement not covered" >if (n.constructor===Object) {</span>
<span class="cstat-no" title="statement not covered" >            var match = true;</span>
<span class="cstat-no" title="statement not covered" >            for(var key in n)</span>
<span class="cstat-no" title="statement not covered" >                if (n[key]!==format[key]) {</span>
<span class="cstat-no" title="statement not covered" >                    match = false;</span>
<span class="cstat-no" title="statement not covered" >                    break;</span>
                }
<span class="cstat-no" title="statement not covered" >            if (match)</span>
<span class="cstat-no" title="statement not covered" >                for(var key in format)</span>
<span class="cstat-no" title="statement not covered" >                    if (n[key]!==format[key]) {</span>
<span class="cstat-no" title="statement not covered" >                        match = false;</span>
<span class="cstat-no" title="statement not covered" >                        break;</span>
                    }
<span class="cstat-no" title="statement not covered" >            format = n;</span>
<span class="cstat-no" title="statement not covered" >            if (match)</span>
<span class="cstat-no" title="statement not covered" >                continue;</span>
<span class="cstat-no" title="statement not covered" >            if (prev &amp;&amp; prev.constructor===Object)</span>
<span class="cstat-no" title="statement not covered" >                ret.pop();</span>
<span class="cstat-no" title="statement not covered" >            ret.push(n);</span>
        } else
<span class="cstat-no" title="statement not covered" >            continue;</span>
<span class="cstat-no" title="statement not covered" >        prev = n;</span>
    }
<span class="cstat-no" title="statement not covered" >    return ret;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function Weave (chain) {</span>
<span class="cstat-no" title="statement not covered" >    this.rtf = []; </span>// TODO this.weave :)
}
&nbsp;
Weave.prototype.setRTF = <span class="fstat-no" title="function not covered" >function (range, rtf) {</span>
    // SHORTCUT: equalize
<span class="cstat-no" title="statement not covered" >    var preex = this.getRTF(range);</span>
    // diff
<span class="cstat-no" title="statement not covered" >    var basic = dmp.diff_main(preexText,givenText);</span>
    // make ops
    // pass to compare formattings
    // (SEE NOTEBOOK 22feb Kiev)
    // just effective formatting on new/remaining parts
<span class="cstat-no" title="statement not covered" >    this.text = '';</span>
    // apply
};
&nbsp;
Weave.prototype.getRTF = <span class="fstat-no" title="function not covered" >function (range,spec) {</span>
    // find paragraph
&nbsp;
    // render according to the mode, base, version
    // cumul formattings
&nbsp;
<span class="cstat-no" title="statement not covered" >    return this.rtf;</span>
};
/* jshint ignore: end  */
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/env.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/env.js</span></h1>
    <h2>
        
        Statements: <span class="metric">21.05% <small>(4 / 19)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">10% <small>(1 / 10)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 2)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">21.05% <small>(4 / 19)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/node_modules/swarm/lib/</a> &#187; env.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
&nbsp;
/** a really simplistic default hash function */
<span class="fstat-no" title="function not covered" >function djb2Hash(str) {</span>
<span class="cstat-no" title="statement not covered" >    var hash = 5381;</span>
<span class="cstat-no" title="statement not covered" >    for (var i = 0; i &lt; str.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >        hash = ((hash &lt;&lt; 5) + hash) + str.charCodeAt(i);</span>
    }
<span class="cstat-no" title="statement not covered" >    return hash;</span>
}
&nbsp;
var env = module.exports = {
    // maps URI schemes to stream implementations
    streams: {},
    // the default host
    localhost: undefined,
    // whether multiple hosts are allowed in one process
    // (that is mostly useful for testing)
    multihost: false,
    // hash function used for consistent hashing
    hashfn: djb2Hash,
&nbsp;
    log: plain_log,
    debug: false,
    trace: false,
&nbsp;
    isServer: typeof(navigator) === 'undefined',
    isBrowser: typeof(navigator) === 'object',
    isWebKit: false,
    isGecko: false,
    isIE: false,
    clockType: undefined // default
};
&nbsp;
<span class="missing-if-branch" title="if path not taken" >I</span>if (typeof(navigator) === 'object') {
<span class="cstat-no" title="statement not covered" >    var agent = navigator.userAgent;</span>
<span class="cstat-no" title="statement not covered" >    env.isWebKit = /AppleWebKit\/(\S+)/.test(agent);</span>
<span class="cstat-no" title="statement not covered" >    env.isIE = /MSIE ([^;]+)/.test(agent);</span>
<span class="cstat-no" title="statement not covered" >    env.isGecko = /rv:.* Gecko\/\d{8}/.test(agent);</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function plain_log(spec, val, object) {</span>
<span class="cstat-no" title="statement not covered" >    var method = 'log';</span>
<span class="cstat-no" title="statement not covered" >    switch (spec.op()) {</span>
    case 'error':
<span class="cstat-no" title="statement not covered" >        method = 'error';</span>
<span class="cstat-no" title="statement not covered" >        break;</span>
    case 'warn':
<span class="cstat-no" title="statement not covered" >        method = 'warn';</span>
<span class="cstat-no" title="statement not covered" >        break;</span>
    }
<span class="cstat-no" title="statement not covered" >    console[method](spec.toString(), val, object &amp;&amp; object._id,</span>
            '@' + ((object &amp;&amp; object._host &amp;&amp; object._host._id) || ''));
}
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-swarm/node_modules/swarm/lib/swarm3-murmur.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-swarm">npmtest-swarm (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-swarm/node_modules/swarm/lib/swarm3-murmur.js</span></h1>
    <h2>
        
        Statements: <span class="metric">5.71% <small>(2 / 35)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 3)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 1)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">5.71% <small>(2 / 35)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-swarm/node_modules/swarm/lib/</a> &#187; swarm3-murmur.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
&nbsp;
/**
 * JS Implementation of MurmurHash3 (r136) (as of May 20, 2011)
 *
 * @author &lt;a href="mailto:gary.court@gmail.com"&gt;Gary Court&lt;/a&gt;
 * @see http://github.com/garycourt/murmurhash-js
 * @author &lt;a href="mailto:aappleby@gmail.com"&gt;Austin Appleby&lt;/a&gt;
 * @see http://sites.google.com/site/murmurhash/
 *
 * @param {string} key ASCII only
 * @param {number} seed Positive integer only
 * @return {number} 32-bit positive integer hash
 */
&nbsp;
var env = require('./env.js');
&nbsp;
env.hashfn = <span class="fstat-no" title="function not covered" >function murmurhash3_32_gc(key, seed) {</span>
<span class="cstat-no" title="statement not covered" >    var remainder, bytes, h1, h1b, c1, c2, k1, i;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    remainder = key.length &amp; 3; </span>// key.length % 4
<span class="cstat-no" title="statement not covered" >    bytes = key.length - remainder;</span>
<span class="cstat-no" title="statement not covered" >    h1 = seed;</span>
<span class="cstat-no" title="statement not covered" >    c1 = 0xcc9e2d51;</span>
<span class="cstat-no" title="statement not covered" >    c2 = 0x1b873593;</span>
<span class="cstat-no" title="statement not covered" >    i = 0;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    while (i &lt; bytes) {</span>
<span class="cstat-no" title="statement not covered" >        k1 =</span>
                ((key.charCodeAt(i) &amp; 0xff)) |
                ((key.charCodeAt(++i) &amp; 0xff) &lt;&lt; 8) |
                ((key.charCodeAt(++i) &amp; 0xff) &lt;&lt; 16) |
                ((key.charCodeAt(++i) &amp; 0xff) &lt;&lt; 24);
<span class="cstat-no" title="statement not covered" >        ++i;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        k1 = ((((k1 &amp; 0xffff) * c1) + ((((k1 &gt;&gt;&gt; 16) * c1) &amp; 0xffff) &lt;&lt; 16))) &amp; 0xffffffff;</span>
<span class="cstat-no" title="statement not covered" >        k1 = (k1 &lt;&lt; 15) | (k1 &gt;&gt;&gt; 17);</span>
<span class="cstat-no" title="statement not covered" >        k1 = ((((k1 &amp; 0xffff) * c2) + ((((k1 &gt;&gt;&gt; 16) * c2) &amp; 0xffff) &lt;&lt; 16))) &amp; 0xffffffff;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        h1 ^= k1;</span>
<span class="cstat-no" title="statement not covered" >        h1 = (h1 &lt;&lt; 13) | (h1 &gt;&gt;&gt; 19);</span>
<span class="cstat-no" title="statement not covered" >        h1b = ((((h1 &amp; 0xffff) * 5) + ((((h1 &gt;&gt;&gt; 16) * 5) &amp; 0xffff) &lt;&lt; 16))) &amp; 0xffffffff;</span>
<span class="cstat-no" title="statement not covered" >        h1 = (((h1b &amp; 0xffff) + 0x6b64) + ((((h1b &gt;&gt;&gt; 16) + 0xe654) &amp; 0xffff) &lt;&lt; 16));</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    k1 = 0;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    switch (remainder) {</span>
    case 3:
<span class="cstat-no" title="statement not covered" >        k1 ^= (key.charCodeAt(i + 2) &amp; 0xff) &lt;&lt; 16;</span>
        /* falls through */
    case 2:
<span class="cstat-no" title="statement not covered" >        k1 ^= (key.charCodeAt(i + 1) &amp; 0xff) &lt;&lt; 8;</span>
        /* falls through */
    case 1:
<span class="cstat-no" title="statement not covered" >        k1 ^= (key.charCodeAt(i) &amp; 0xff);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        k1 = (((k1 &amp; 0xffff) * c1) + ((((k1 &gt;&gt;&gt; 16) * c1) &amp; 0xffff) &lt;&lt; 16)) &amp; 0xffffffff;</span>
<span class="cstat-no" title="statement not covered" >        k1 = (k1 &lt;&lt; 15) | (k1 &gt;&gt;&gt; 17);</span>
<span class="cstat-no" title="statement not covered" >        k1 = (((k1 &amp; 0xffff) * c2) + ((((k1 &gt;&gt;&gt; 16) * c2) &amp; 0xffff) &lt;&lt; 16)) &amp; 0xffffffff;</span>
<span class="cstat-no" title="statement not covered" >        h1 ^= k1;</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    h1 ^= key.length;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    h1 ^= h1 &gt;&gt;&gt; 16;</span>
<span class="cstat-no" title="statement not covered" >    h1 = (((h1 &amp; 0xffff) * 0x85ebca6b) + ((((h1 &gt;&gt;&gt; 16) * 0x85ebca6b) &amp; 0xffff) &lt;&lt; 16)) &amp; 0xffffffff;</span>
<span class="cstat-no" title="statement not covered" >    h1 ^= h1 &gt;&gt;&gt; 13;</span>
<span class="cstat-no" title="statement not covered" >    h1 = ((((h1 &amp; 0xffff) * 0xc2b2ae35) + ((((h1 &gt;&gt;&gt; 16) * 0xc2b2ae35) &amp; 0xffff) &lt;&lt; 16))) &amp; 0xffffffff;</span>
<span class="cstat-no" title="statement not covered" >    h1 ^= h1 &gt;&gt;&gt; 16;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    return h1 &gt;&gt;&gt; 0;</span>
};
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 21:36:02 GMT+0000 (UTC)</div>
</div>
</body>
</html>


</div>
</div>
